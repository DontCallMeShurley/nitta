<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_IzE4rFs4IL9JqnTFAAZcYr"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE QuasiQuotes #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-comment">{- |
Module      : NITTA.Model.ProcessorUnits.Types
Description : Set of types for process unit description
Copyright   : (c) Aleksandr Penskoi, 2021
License     : BSD3
Maintainer  : aleksandr.penskoi@gmail.com
Stability   : experimental
-}</span><span>
</span><span id="line-23"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">NITTA.Model.ProcessorUnits.Types</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><span class="hs-comment">-- *Processor unit</span></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#UnitTag"><span class="hs-identifier">UnitTag</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#ProcessorUnit"><span class="hs-identifier">ProcessorUnit</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#bind"><span class="hs-identifier">bind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#allowToProcess"><span class="hs-identifier">allowToProcess</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#NextTick"><span class="hs-identifier">NextTick</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- *Process description</span></span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Process"><span class="hs-identifier">Process</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#ProcessStepID"><span class="hs-identifier">ProcessStepID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Step"><span class="hs-identifier">Step</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier">StepInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Relation"><span class="hs-identifier">Relation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#isVertical"><span class="hs-identifier">isVertical</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#isHorizontal"><span class="hs-identifier">isHorizontal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#descent"><span class="hs-identifier">descent</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#whatsHappen"><span class="hs-identifier">whatsHappen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#extractInstructionAt"><span class="hs-identifier">extractInstructionAt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#withShift"><span class="hs-identifier">withShift</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#isRefactorStep"><span class="hs-identifier">isRefactorStep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-comment">-- *Control</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Controllable"><span class="hs-identifier">Controllable</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#SignalTag"><span class="hs-identifier">SignalTag</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#UnambiguouslyDecode"><span class="hs-identifier">UnambiguouslyDecode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Connected"><span class="hs-identifier">Connected</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#ByTime"><span class="hs-identifier">ByTime</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#SignalValue"><span class="hs-identifier">SignalValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#%2B%2B%2B"><span class="hs-operator">(+++)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="hs-comment">-- *IO</span></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#IOConnected"><span class="hs-identifier">IOConnected</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#InputPortTag"><span class="hs-identifier">InputPortTag</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#OutputPortTag"><span class="hs-identifier">OutputPortTag</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#InoutPortTag"><span class="hs-identifier">InoutPortTag</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String.Interpolate</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String.ToString</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html"><span class="hs-identifier">NITTA.Intermediate.Types</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Problems.Endpoint.html"><span class="hs-identifier">NITTA.Model.Problems.Endpoint</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Time.html"><span class="hs-identifier">NITTA.Model.Time</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.Interval.NonEmpty</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.Interval.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">I</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prettyprinter</span></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- |Typeclass alias for processor unit tag or &quot;name.&quot;</span><span>
</span><span id="line-82"></span><span class="hs-keyword">type</span><span> </span><span id="UnitTag"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#UnitTag"><span class="hs-identifier hs-var">UnitTag</span></a></span></span><span> </span><span id="local-6989586621680039400"><span class="annot"><a href="#local-6989586621680039400"><span class="hs-identifier hs-type">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621680039400"><span class="hs-identifier hs-type">tag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680039400"><span class="hs-identifier hs-type">tag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToString</span></span><span> </span><span class="annot"><a href="#local-6989586621680039400"><span class="hs-identifier hs-type">tag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span> </span><span class="annot"><a href="#local-6989586621680039400"><span class="hs-identifier hs-type">tag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">{- |Process unit - part of NITTA process with can execute a function from
intermediate representation:

1. get function for execution ('tryBind');

2. store computational process description ('process');

3. other features implemented by different type classes (see above and in
   &quot;NITTA.Model.Problems&quot;).
-}</span><span>
</span><span id="line-94"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.Time.html#VarValTime"><span class="hs-identifier hs-type">VarValTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039628"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039627"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039626"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ProcessorUnit"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#ProcessorUnit"><span class="hs-identifier hs-var">ProcessorUnit</span></a></span></span><span> </span><span id="local-6989586621680039629"><span class="annot"><a href="#local-6989586621680039629"><span class="hs-identifier hs-type">u</span></a></span></span><span> </span><span id="local-6989586621680039628"><span class="annot"><a href="#local-6989586621680039628"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680039627"><span class="annot"><a href="#local-6989586621680039627"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621680039626"><span class="annot"><a href="#local-6989586621680039626"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621680039629"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680039628"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039627"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039626"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-comment">-- If the processor unit can execute a function, then it will return the PU</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-comment">-- model with already bound function (only registeration, actual scheduling</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-comment">-- will be happening later). If not, it will return @Left@ value with a</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">-- specific reason (e.g., not support or all internal resources is over).</span><span>
</span><span id="line-99"></span><span>    </span><span id="tryBind"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#tryBind"><span class="hs-identifier hs-type">tryBind</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039628"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039627"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680039629"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621680039629"><span class="hs-identifier hs-type">u</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-comment">-- Get a computational process description. If the processor unit embedded</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-comment">-- another PUs (like &quot;NITTA.Model.Networks.Bus&quot;), the description should</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-comment">-- contain process steps for all PUs.</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-comment">-- 'ProcessStepID' may change from one call to another.</span><span>
</span><span id="line-106"></span><span>    </span><span id="process"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#process"><span class="hs-identifier hs-type">process</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680039629"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Process"><span class="hs-identifier hs-type">Process</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039626"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier hs-type">StepInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039628"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039627"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039626"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span id="bind"><span class="annot"><span class="annottext">bind :: F v x -&gt; p -&gt; p
</span><a href="NITTA.Model.ProcessorUnits.Types.html#bind"><span class="hs-identifier hs-var hs-var">bind</span></a></span></span><span> </span><span id="local-6989586621680039396"><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680039396"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680039395"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680039395"><span class="hs-identifier hs-var">pu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">F v x -&gt; p -&gt; Either String p
forall u v x t.
ProcessorUnit u v x t =&gt;
F v x -&gt; u -&gt; Either String u
</span><a href="NITTA.Model.ProcessorUnits.Types.html#tryBind"><span class="hs-identifier hs-var">tryBind</span></a></span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680039396"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680039395"><span class="hs-identifier hs-var">pu</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621680039394"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680039394"><span class="hs-identifier hs-var">pu'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680039394"><span class="hs-identifier hs-var">pu'</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621680039393"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680039393"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; p
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; p) -&gt; String -&gt; p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;can't bind function: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680039393"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span id="allowToProcess"><span class="annot"><span class="annottext">allowToProcess :: F v x -&gt; b -&gt; Bool
</span><a href="NITTA.Model.ProcessorUnits.Types.html#allowToProcess"><span class="hs-identifier hs-var hs-var">allowToProcess</span></a></span></span><span> </span><span id="local-6989586621680039391"><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680039391"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680039390"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680039390"><span class="hs-identifier hs-var">pu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either String b -&gt; Bool
forall a b. Either a b -&gt; Bool
</span><span class="hs-identifier hs-var">isRight</span></span><span> </span><span class="annot"><span class="annottext">(Either String b -&gt; Bool) -&gt; Either String b -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">F v x -&gt; b -&gt; Either String b
forall u v x t.
ProcessorUnit u v x t =&gt;
F v x -&gt; u -&gt; Either String u
</span><a href="NITTA.Model.ProcessorUnits.Types.html#tryBind"><span class="hs-identifier hs-var">tryBind</span></a></span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680039391"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680039390"><span class="hs-identifier hs-var">pu</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-keyword">class</span><span> </span><span id="NextTick"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#NextTick"><span class="hs-identifier hs-var">NextTick</span></a></span></span><span> </span><span id="local-6989586621680039609"><span class="annot"><a href="#local-6989586621680039609"><span class="hs-identifier hs-type">u</span></a></span></span><span> </span><span id="local-6989586621680039608"><span class="annot"><a href="#local-6989586621680039608"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621680039609"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680039608"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>    </span><span id="nextTick"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#nextTick"><span class="hs-identifier hs-type">nextTick</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680039609"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680039608"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span id="local-6989586621680039384"><span id="local-6989586621680039385"><span id="local-6989586621680039386"><span id="local-6989586621680039387"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#ProcessorUnit"><span class="hs-identifier hs-type">ProcessorUnit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039387"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039386"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039385"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039384"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#NextTick"><span class="hs-identifier hs-type">NextTick</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039387"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039384"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621680039381"><span class="annot"><span class="annottext">nextTick :: u -&gt; t
</span><a href="#local-6989586621680039381"><span class="hs-identifier hs-var hs-var hs-var hs-var">nextTick</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Process t (StepInfo v x t) -&gt; t
forall u t. NextTick u t =&gt; u -&gt; t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#nextTick"><span class="hs-identifier hs-var">nextTick</span></a></span><span> </span><span class="annot"><span class="annottext">(Process t (StepInfo v x t) -&gt; t)
-&gt; (u -&gt; Process t (StepInfo v x t)) -&gt; u -&gt; t
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">u -&gt; Process t (StepInfo v x t)
forall u v x t.
ProcessorUnit u v x t =&gt;
u -&gt; Process t (StepInfo v x t)
</span><a href="NITTA.Model.ProcessorUnits.Types.html#process"><span class="hs-identifier hs-var">process</span></a></span></span></span></span></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">---------------------------------------------------------------------</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">{- |Computational process description. It was designed in ISO 15926 style, with
separated data and relations storage.
-}</span><span>
</span><span id="line-125"></span><span id="local-6989586621680039378"><span id="local-6989586621680039379"></span></span><span class="hs-keyword">data</span><span> </span><span id="Process"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Process"><span class="hs-identifier hs-var">Process</span></a></span></span><span> </span><span id="local-6989586621680039557"><span class="annot"><a href="#local-6989586621680039557"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680039556"><span class="annot"><a href="#local-6989586621680039556"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Process"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Process"><span class="hs-identifier hs-var">Process</span></a></span></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- |All process steps desctiption.</span><span>
</span><span id="line-127"></span><span>      </span><span id="steps"><span class="annot"><span class="annottext">Process t i -&gt; [Step t i]
</span><a href="NITTA.Model.ProcessorUnits.Types.html#steps"><span class="hs-identifier hs-var hs-var">steps</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039557"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039556"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- |List of relationships between process steps (see 'Relation').</span><span>
</span><span id="line-129"></span><span>      </span><span id="relations"><span class="annot"><span class="annottext">Process t i -&gt; [Relation]
</span><a href="NITTA.Model.ProcessorUnits.Types.html#relations"><span class="hs-identifier hs-var hs-var">relations</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Relation"><span class="hs-identifier hs-type">Relation</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- |Next tick for instruction. Note: instruction /= endpoint.</span><span>
</span><span id="line-131"></span><span>      </span><span id="nextTick_"><span class="annot"><span class="annottext">Process t i -&gt; t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#nextTick_"><span class="hs-identifier hs-var hs-var">nextTick_</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680039557"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- |Next process step ID</span><span>
</span><span id="line-133"></span><span>      </span><span id="nextUid"><span class="annot"><span class="annottext">Process t i -&gt; ProcessStepID
</span><a href="NITTA.Model.ProcessorUnits.Types.html#nextUid"><span class="hs-identifier hs-var hs-var">nextUid</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#ProcessStepID"><span class="hs-identifier hs-type">ProcessStepID</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. Process t i -&gt; Rep (Process t i) x)
-&gt; (forall x. Rep (Process t i) x -&gt; Process t i)
-&gt; Generic (Process t i)
forall x. Rep (Process t i) x -&gt; Process t i
forall x. Process t i -&gt; Rep (Process t i) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall t i x. Rep (Process t i) x -&gt; Process t i
forall t i x. Process t i -&gt; Rep (Process t i) x
$cto :: forall t i x. Rep (Process t i) x -&gt; Process t i
$cfrom :: forall t i x. Process t i -&gt; Rep (Process t i) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621680039368"><span id="local-6989586621680039369"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680039365"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.Time.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039369"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680039368"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Process"><span class="hs-identifier hs-type">Process</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039369"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039368"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-138"></span><span>    </span><span id="local-6989586621680039363"><span class="annot"><span class="annottext">pretty :: Process t i -&gt; Doc ann
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></span></span><span> </span><span id="local-6989586621680039361"><span class="annot"><span class="annottext">Process t i
</span><a href="#local-6989586621680039361"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><span class="">[__i|
            Process:
                steps: #{ showList' $ reverse $ steps p }
                relations: #{ showList' $ relations p }
                nextTick: #{ nextTick p }
                nextUid: #{ nextUid p }
        |]</span></span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>            </span><span id="local-6989586621680039360"><span class="annot"><span class="annottext">showList' :: [src] -&gt; Doc ann
</span><a href="#local-6989586621680039360"><span class="hs-identifier hs-var hs-var">showList'</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-148"></span><span>            </span><span class="annot"><a href="#local-6989586621680039360"><span class="hs-identifier hs-var">showList'</span></a></span><span> </span><span id="local-6989586621680039353"><span class="annot"><span class="annottext">[src]
</span><a href="#local-6989586621680039353"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ProcessStepID -&gt; Doc ann -&gt; Doc ann
forall ann. ProcessStepID -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">ProcessStepID
</span><span class="hs-number">8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann]
</span><a href="#local-6989586621680039349"><span class="hs-identifier hs-var">lst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>                </span><span class="hs-keyword">where</span><span>
</span><span id="line-150"></span><span>                    </span><span id="local-6989586621680039349"><span class="annot"><span class="annottext">lst :: [Doc ann]
</span><a href="#local-6989586621680039349"><span class="hs-identifier hs-var hs-var">lst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-151"></span><span>                        </span><span class="annot"><span class="annottext">((ProcessStepID, src) -&gt; Doc ann)
-&gt; [(ProcessStepID, src)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Doc ann)
-&gt; ((ProcessStepID, src) -&gt; Text)
-&gt; (ProcessStepID, src)
-&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680039348"><span class="annot"><span class="annottext">ProcessStepID
</span><a href="#local-6989586621680039348"><span class="hs-identifier hs-var">ix</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680039347"><span class="annot"><span class="annottext">src
</span><a href="#local-6989586621680039347"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="">[i|#{ ix }) #{ value }|]</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(ProcessStepID, src)] -&gt; [Doc ann])
-&gt; [(ProcessStepID, src)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-152"></span><span>                            </span><span class="annot"><span class="annottext">[ProcessStepID] -&gt; [src] -&gt; [(ProcessStepID, src)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProcessStepID
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[src]
</span><a href="#local-6989586621680039353"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span id="local-6989586621680039345"><span id="local-6989586621680039346"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680039337"><span id="local-6989586621680039339"><span id="local-6989586621680039341"><span id="local-6989586621680039343"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680039346"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680039345"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Process"><span class="hs-identifier hs-type">Process</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039346"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039345"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span id="local-6989586621680039334"><span id="local-6989586621680039335"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="#local-6989586621680039335"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Process"><span class="hs-identifier hs-type">Process</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039335"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039334"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621680039331"><span class="annot"><span class="annottext">def :: Process t i
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Process :: forall t i.
[Step t i] -&gt; [Relation] -&gt; t -&gt; ProcessStepID -&gt; Process t i
</span><a href="NITTA.Model.ProcessorUnits.Types.html#Process"><span class="hs-identifier hs-type">Process</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">steps :: [Step t i]
</span><a href="NITTA.Model.ProcessorUnits.Types.html#steps"><span class="hs-identifier hs-var">steps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">relations :: [Relation]
</span><a href="NITTA.Model.ProcessorUnits.Types.html#relations"><span class="hs-identifier hs-var">relations</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nextTick_ :: t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#nextTick_"><span class="hs-identifier hs-var">nextTick_</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nextUid :: ProcessStepID
</span><a href="NITTA.Model.ProcessorUnits.Types.html#nextUid"><span class="hs-identifier hs-var">nextUid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProcessStepID
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">}</span></span></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span id="local-6989586621680039328"><span id="local-6989586621680039329"><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPS</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#NextTick"><span class="hs-identifier hs-type">NextTick</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Process"><span class="hs-identifier hs-type">Process</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039329"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039328"><span class="hs-identifier hs-type">si</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680039329"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621680039326"><span class="annot"><span class="annottext">nextTick :: Process t si -&gt; t
</span><a href="#local-6989586621680039326"><span class="hs-identifier hs-var hs-var hs-var hs-var">nextTick</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Process t si -&gt; t
forall t si. Process t si -&gt; t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#nextTick_"><span class="hs-identifier hs-var hs-var">nextTick_</span></a></span></span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span id="local-6989586621680039323"><span id="local-6989586621680039324"><span id="local-6989586621680039325"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680039325"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#WithFunctions"><span class="hs-identifier hs-type">WithFunctions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Process"><span class="hs-identifier hs-type">Process</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039325"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier hs-type">StepInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039324"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039323"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039325"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039324"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039323"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>    </span><span id="local-6989586621680039320"><span class="annot"><span class="annottext">functions :: Process t (StepInfo v x t) -&gt; [F v x]
</span><a href="NITTA.Intermediate.Types.html#functions"><span class="hs-identifier hs-var hs-var hs-var hs-var">functions</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Process"><span class="hs-identifier hs-type">Process</span></a></span><span class="hs-special">{</span><span id="local-6989586621680039318"><span class="annot"><span class="annottext">[Step t (StepInfo v x t)]
steps :: [Step t (StepInfo v x t)]
steps :: forall t i. Process t i -&gt; [Step t i]
</span><a href="#local-6989586621680039318"><span class="hs-identifier hs-var hs-var">steps</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Step t (StepInfo v x t) -&gt; Maybe (F v x))
-&gt; [Step t (StepInfo v x t)] -&gt; [F v x]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">Step t (StepInfo v x t) -&gt; Maybe (F v x)
forall t v x t. Step t (StepInfo v x t) -&gt; Maybe (F v x)
</span><a href="#local-6989586621680039316"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">([Step t (StepInfo v x t)] -&gt; [F v x])
-&gt; [Step t (StepInfo v x t)] -&gt; [F v x]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Step t (StepInfo v x t) -&gt; t)
-&gt; [Step t (StepInfo v x t)] -&gt; [Step t (StepInfo v x t)]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">L.sortOn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Interval t -&gt; t
forall a. Interval a -&gt; a
</span><span class="hs-identifier hs-var">I.inf</span></span><span> </span><span class="annot"><span class="annottext">(Interval t -&gt; t)
-&gt; (Step t (StepInfo v x t) -&gt; Interval t)
-&gt; Step t (StepInfo v x t)
-&gt; t
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Step t (StepInfo v x t) -&gt; Interval t
forall t i. Step t i -&gt; Interval t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#pInterval"><span class="hs-identifier hs-var hs-var">pInterval</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Step t (StepInfo v x t)]
</span><a href="#local-6989586621680039318"><span class="hs-identifier hs-var">steps</span></a></span><span>
</span><span id="line-164"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-165"></span><span>            </span><span id="local-6989586621680039316"><span class="annot"><span class="annottext">get :: Step t (StepInfo v x t) -&gt; Maybe (F v x)
</span><a href="#local-6989586621680039316"><span class="hs-identifier hs-var hs-var">get</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span class="hs-special">{</span><span id="local-6989586621680039311"><span class="annot"><span class="annottext">StepInfo v x t
pDesc :: forall t i. Step t i -&gt; i
pDesc :: StepInfo v x t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#pDesc"><span class="hs-identifier hs-var hs-var">pDesc</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#IntermediateStep"><span class="hs-identifier hs-type">IntermediateStep</span></a></span><span> </span><span id="local-6989586621680039308"><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680039308"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StepInfo v x t -&gt; StepInfo v x t
forall v x t. StepInfo v x t -&gt; StepInfo v x t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#descent"><span class="hs-identifier hs-var">descent</span></a></span><span> </span><span class="annot"><span class="annottext">StepInfo v x t
</span><a href="#local-6989586621680039311"><span class="hs-identifier hs-var">pDesc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">F v x -&gt; Maybe (F v x)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680039308"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-166"></span><span>            </span><span class="annot"><a href="#local-6989586621680039316"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">Step t (StepInfo v x t)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (F v x)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span></span></span></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- |Unique ID of a process step. Uniquity presented only inside PU.</span><span>
</span><span id="line-169"></span><span class="hs-keyword">type</span><span> </span><span id="ProcessStepID"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#ProcessStepID"><span class="hs-identifier hs-var">ProcessStepID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- |Process step representation</span><span>
</span><span id="line-172"></span><span id="local-6989586621680039306"><span id="local-6989586621680039307"></span></span><span class="hs-keyword">data</span><span> </span><span id="Step"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Step"><span class="hs-identifier hs-var">Step</span></a></span></span><span> </span><span id="local-6989586621680039519"><span class="annot"><a href="#local-6989586621680039519"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680039518"><span class="annot"><a href="#local-6989586621680039518"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Step"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Step"><span class="hs-identifier hs-var">Step</span></a></span></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- |uniq (inside single the process unit) step ID</span><span>
</span><span id="line-174"></span><span>      </span><span id="pID"><span class="annot"><span class="annottext">Step t i -&gt; ProcessStepID
</span><a href="NITTA.Model.ProcessorUnits.Types.html#pID"><span class="hs-identifier hs-var hs-var">pID</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#ProcessStepID"><span class="hs-identifier hs-type">ProcessStepID</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- |step time</span><span>
</span><span id="line-176"></span><span>      </span><span id="pInterval"><span class="annot"><span class="annottext">Step t i -&gt; Interval t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#pInterval"><span class="hs-identifier hs-var hs-var">pInterval</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Interval</span></span><span> </span><span class="annot"><a href="#local-6989586621680039519"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- |step description</span><span>
</span><span id="line-178"></span><span>      </span><span id="pDesc"><span class="annot"><span class="annottext">Step t i -&gt; i
</span><a href="NITTA.Model.ProcessorUnits.Types.html#pDesc"><span class="hs-identifier hs-var hs-var">pDesc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680039518"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680039299"><span id="local-6989586621680039301"><span id="local-6989586621680039303"><span class="annot"><span class="annottext">ProcessStepID -&gt; Step t i -&gt; String -&gt; String
[Step t i] -&gt; String -&gt; String
Step t i -&gt; String
(ProcessStepID -&gt; Step t i -&gt; String -&gt; String)
-&gt; (Step t i -&gt; String)
-&gt; ([Step t i] -&gt; String -&gt; String)
-&gt; Show (Step t i)
forall a.
(ProcessStepID -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
forall t i.
(Show t, Show i) =&gt;
ProcessStepID -&gt; Step t i -&gt; String -&gt; String
forall t i. (Show t, Show i) =&gt; [Step t i] -&gt; String -&gt; String
forall t i. (Show t, Show i) =&gt; Step t i -&gt; String
showList :: [Step t i] -&gt; String -&gt; String
$cshowList :: forall t i. (Show t, Show i) =&gt; [Step t i] -&gt; String -&gt; String
show :: Step t i -&gt; String
$cshow :: forall t i. (Show t, Show i) =&gt; Step t i -&gt; String
showsPrec :: ProcessStepID -&gt; Step t i -&gt; String -&gt; String
$cshowsPrec :: forall t i.
(Show t, Show i) =&gt;
ProcessStepID -&gt; Step t i -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. Step t i -&gt; Rep (Step t i) x)
-&gt; (forall x. Rep (Step t i) x -&gt; Step t i) -&gt; Generic (Step t i)
forall x. Rep (Step t i) x -&gt; Step t i
forall x. Step t i -&gt; Rep (Step t i) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall t i x. Rep (Step t i) x -&gt; Step t i
forall t i x. Step t i -&gt; Rep (Step t i) x
$cto :: forall t i x. Rep (Step t i) x -&gt; Step t i
$cfrom :: forall t i x. Step t i -&gt; Rep (Step t i) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span id="local-6989586621680039294"><span id="local-6989586621680039295"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680039286"><span id="local-6989586621680039288"><span id="local-6989586621680039290"><span id="local-6989586621680039292"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680039295"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680039294"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039295"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039294"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span id="local-6989586621680039283"><span id="local-6989586621680039284"><span id="local-6989586621680039285"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680039285"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Patch"><span class="hs-identifier hs-type">Patch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039284"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier hs-type">StepInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039285"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039283"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039284"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#Changeset"><span class="hs-identifier hs-type">Changeset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039285"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621680039280"><span class="annot"><span class="annottext">patch :: Changeset v -&gt; Step t (StepInfo v x t) -&gt; Step t (StepInfo v x t)
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var hs-var hs-var hs-var">patch</span></a></span></span><span> </span><span id="local-6989586621680039278"><span class="annot"><span class="annottext">Changeset v
</span><a href="#local-6989586621680039278"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span id="local-6989586621680039277"><span class="annot"><span class="annottext">step :: Step t (StepInfo v x t)
</span><a href="#local-6989586621680039277"><span class="hs-identifier hs-var">step</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span class="hs-special">{</span><span id="local-6989586621680039276"><span class="annot"><span class="annottext">StepInfo v x t
pDesc :: StepInfo v x t
pDesc :: forall t i. Step t i -&gt; i
</span><a href="#local-6989586621680039276"><span class="hs-identifier hs-var hs-var">pDesc</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Step t (StepInfo v x t)
</span><a href="#local-6989586621680039277"><span class="hs-identifier hs-var">step</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">pDesc :: StepInfo v x t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#pDesc"><span class="hs-identifier hs-var">pDesc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Changeset v -&gt; StepInfo v x t -&gt; StepInfo v x t
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">Changeset v
</span><a href="#local-6989586621680039278"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">StepInfo v x t
</span><a href="#local-6989586621680039276"><span class="hs-identifier hs-var">pDesc</span></a></span><span class="hs-special">}</span></span></span></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- |Informative process step description at a specific process level.</span><span>
</span><span id="line-188"></span><span class="hs-keyword">data</span><span> </span><span id="StepInfo"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier hs-var">StepInfo</span></a></span></span><span> </span><span id="local-6989586621680039275"><span class="annot"><a href="#local-6989586621680039275"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680039274"><span class="annot"><a href="#local-6989586621680039274"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621680039273"><span class="annot"><a href="#local-6989586621680039273"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-comment">-- |CAD level step</span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621680039270"><span id="local-6989586621680039271"><span id="local-6989586621680039272"><span id="CADStep"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#CADStep"><span class="hs-identifier hs-var">CADStep</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier hs-type">StepInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039272"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039271"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039270"><span class="hs-identifier hs-type">t</span></a></span></span></span></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-comment">-- |Apply refactoring</span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621680039265"><span id="local-6989586621680039266"><span id="local-6989586621680039267"><span id="local-6989586621680039268"><span id="RefactorStep"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#RefactorStep"><span class="hs-identifier hs-var">RefactorStep</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621680039268"><span class="hs-identifier hs-type">ref</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680039268"><span class="hs-identifier hs-type">ref</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621680039268"><span class="hs-identifier hs-type">ref</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680039268"><span class="hs-identifier hs-type">ref</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier hs-type">StepInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039267"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039266"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039265"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-comment">-- |intermidiate level step (function execution)</span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621680039465"><span id="local-6989586621680039466"><span id="local-6989586621680039467"><span id="IntermediateStep"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#IntermediateStep"><span class="hs-identifier hs-var">IntermediateStep</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039467"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039466"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier hs-type">StepInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039467"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039466"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039465"><span class="hs-identifier hs-type">t</span></a></span></span></span></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-comment">-- |endpoint level step (source or target)</span><span>
</span><span id="line-196"></span><span>    </span><span id="local-6989586621680039462"><span id="local-6989586621680039463"><span id="local-6989586621680039464"><span id="EndpointRoleStep"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#EndpointRoleStep"><span class="hs-identifier hs-var">EndpointRoleStep</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Model.Problems.Endpoint.html#EndpointRole"><span class="hs-identifier hs-type">EndpointRole</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039464"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier hs-type">StepInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039464"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039463"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039462"><span class="hs-identifier hs-type">t</span></a></span></span></span></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-comment">-- |process unit instruction (depends on process unit type)</span><span>
</span><span id="line-198"></span><span>    </span><span id="local-6989586621680039259"><span id="local-6989586621680039260"><span id="local-6989586621680039261"><span id="local-6989586621680039262"><span id="InstructionStep"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#InstructionStep"><span class="hs-identifier hs-var">InstructionStep</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039262"><span class="hs-identifier hs-type">pu</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039262"><span class="hs-identifier hs-type">pu</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039262"><span class="hs-identifier hs-type">pu</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-201"></span><span>        </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier hs-type">StepInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039261"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039260"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039259"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-comment">-- |wrapper for nested process unit step (used for networks)</span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621680039257"><span id="local-6989586621680039473"><span id="local-6989586621680039474"><span id="local-6989586621680039475"><span id="NestedStep"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#NestedStep"><span class="hs-identifier hs-var">NestedStep</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#UnitTag"><span class="hs-identifier hs-type">UnitTag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039257"><span class="hs-identifier hs-type">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">{</span><span id="nTitle"><span class="annot"><span class="annottext">()
</span><a href="NITTA.Model.ProcessorUnits.Types.html#nTitle"><span class="hs-identifier hs-var hs-var">nTitle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680039257"><span class="hs-identifier hs-type">tag</span></a></span><span class="hs-special">,</span><span> </span><span id="nStep"><span class="annot"><span class="annottext">StepInfo v x t -&gt; Step t (StepInfo v x t)
</span><a href="NITTA.Model.ProcessorUnits.Types.html#nStep"><span class="hs-identifier hs-var hs-var">nStep</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039473"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier hs-type">StepInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039475"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039474"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039473"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier hs-type">StepInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039475"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039474"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039473"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span id="descent"><span class="annot"><span class="annottext">descent :: StepInfo v x t -&gt; StepInfo v x t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#descent"><span class="hs-identifier hs-var hs-var">descent</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#NestedStep"><span class="hs-identifier hs-type">NestedStep</span></a></span><span> </span><span class="annot"><span class="annottext">tag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680039253"><span class="annot"><span class="annottext">Step t (StepInfo v x t)
</span><a href="#local-6989586621680039253"><span class="hs-identifier hs-var">step</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StepInfo v x t -&gt; StepInfo v x t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#descent"><span class="hs-identifier hs-var">descent</span></a></span><span> </span><span class="annot"><span class="annottext">(StepInfo v x t -&gt; StepInfo v x t)
-&gt; StepInfo v x t -&gt; StepInfo v x t
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Step t (StepInfo v x t) -&gt; StepInfo v x t
forall t i. Step t i -&gt; i
</span><a href="NITTA.Model.ProcessorUnits.Types.html#pDesc"><span class="hs-identifier hs-var hs-var">pDesc</span></a></span><span> </span><span class="annot"><span class="annottext">Step t (StepInfo v x t)
</span><a href="#local-6989586621680039253"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-206"></span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#descent"><span class="hs-identifier hs-var">descent</span></a></span><span> </span><span id="local-6989586621680039252"><span class="annot"><span class="annottext">StepInfo v x t
</span><a href="#local-6989586621680039252"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StepInfo v x t
</span><a href="#local-6989586621680039252"><span class="hs-identifier hs-var">desc</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span id="isRefactorStep"><span class="annot"><span class="annottext">isRefactorStep :: StepInfo v x t -&gt; Bool
</span><a href="NITTA.Model.ProcessorUnits.Types.html#isRefactorStep"><span class="hs-identifier hs-var hs-var">isRefactorStep</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#RefactorStep"><span class="hs-identifier hs-type">RefactorStep</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-209"></span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#isRefactorStep"><span class="hs-identifier hs-var">isRefactorStep</span></a></span><span> </span><span class="annot"><span class="annottext">StepInfo v x t
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span id="local-6989586621680039249"><span id="local-6989586621680039250"><span id="local-6989586621680039251"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680039244"><span id="local-6989586621680039247"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039251"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039250"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier hs-type">StepInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039251"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039249"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039250"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier hs-type">StepInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039251"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039249"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039250"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-212"></span><span>    </span><span id="local-6989586621680039243"><span class="annot"><span class="annottext">show :: StepInfo v x t -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#CADStep"><span class="hs-identifier hs-type">CADStep</span></a></span><span> </span><span id="local-6989586621680039241"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680039241"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CAD: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680039241"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#RefactorStep"><span class="hs-identifier hs-type">RefactorStep</span></a></span><span> </span><span id="local-6989586621680039240"><span class="annot"><span class="annottext">ref
</span><a href="#local-6989586621680039240"><span class="hs-identifier hs-var">ref</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Refactor: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ref -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ref
</span><a href="#local-6989586621680039240"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#IntermediateStep"><span class="hs-identifier hs-type">IntermediateStep</span></a></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span class="hs-special">{</span><span id="local-6989586621680039238"><span class="annot"><span class="annottext">f
fun :: ()
fun :: f
</span><a href="NITTA.Intermediate.Types.html#fun"><span class="hs-identifier hs-var hs-var">fun</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Intermediate: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">f -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680039238"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#EndpointRoleStep"><span class="hs-identifier hs-type">EndpointRoleStep</span></a></span><span> </span><span id="local-6989586621680039236"><span class="annot"><span class="annottext">EndpointRole v
</span><a href="#local-6989586621680039236"><span class="hs-identifier hs-var">eff</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Endpoint: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">EndpointRole v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">EndpointRole v
</span><a href="#local-6989586621680039236"><span class="hs-identifier hs-var">eff</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#InstructionStep"><span class="hs-identifier hs-type">InstructionStep</span></a></span><span> </span><span id="local-6989586621680039235"><span class="annot"><span class="annottext">Instruction pu
</span><a href="#local-6989586621680039235"><span class="hs-identifier hs-var">instr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Instruction: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Instruction pu -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Instruction pu
</span><a href="#local-6989586621680039235"><span class="hs-identifier hs-var">instr</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#NestedStep"><span class="hs-identifier hs-type">NestedStep</span></a></span><span class="hs-special">{</span><span id="local-6989586621680039234"><span class="annot"><span class="annottext">tag
nTitle :: tag
nTitle :: ()
</span><a href="#local-6989586621680039234"><span class="hs-identifier hs-var hs-var">nTitle</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nStep :: forall v x t. StepInfo v x t -&gt; Step t (StepInfo v x t)
</span><a href="NITTA.Model.ProcessorUnits.Types.html#nStep"><span class="hs-identifier hs-var">nStep</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span class="hs-special">{</span><span id="local-6989586621680039233"><span class="annot"><span class="annottext">StepInfo v x t
pDesc :: StepInfo v x t
pDesc :: forall t i. Step t i -&gt; i
</span><a href="#local-6989586621680039233"><span class="hs-identifier hs-var hs-var">pDesc</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;@&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">tag -&gt; String
forall a. ToString a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">toString</span></span><span> </span><span class="annot"><span class="annottext">tag
</span><a href="#local-6989586621680039234"><span class="hs-identifier hs-var">nTitle</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StepInfo v x t -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">StepInfo v x t
</span><a href="#local-6989586621680039233"><span class="hs-identifier hs-var">pDesc</span></a></span></span></span></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span id="local-6989586621680039229"><span id="local-6989586621680039230"><span id="local-6989586621680039231"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680039231"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Patch"><span class="hs-identifier hs-type">Patch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier hs-type">StepInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039231"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039230"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039229"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#Changeset"><span class="hs-identifier hs-type">Changeset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039231"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621680039227"><span class="annot"><span class="annottext">patch :: Changeset v -&gt; StepInfo v x t -&gt; StepInfo v x t
</span><a href="#local-6989586621680039227"><span class="hs-identifier hs-var hs-var hs-var hs-var">patch</span></a></span></span><span> </span><span id="local-6989586621680039226"><span class="annot"><span class="annottext">Changeset v
</span><a href="#local-6989586621680039226"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#IntermediateStep"><span class="hs-identifier hs-type">IntermediateStep</span></a></span><span> </span><span id="local-6989586621680039225"><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680039225"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">F v x -&gt; StepInfo v x t
forall v x t. F v x -&gt; StepInfo v x t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#IntermediateStep"><span class="hs-identifier hs-var">IntermediateStep</span></a></span><span> </span><span class="annot"><span class="annottext">(F v x -&gt; StepInfo v x t) -&gt; F v x -&gt; StepInfo v x t
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Changeset v -&gt; F v x -&gt; F v x
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">Changeset v
</span><a href="#local-6989586621680039226"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680039225"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span id="local-6989586621680039224"><span class="annot"><span class="annottext">Changeset v
</span><a href="#local-6989586621680039224"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#EndpointRoleStep"><span class="hs-identifier hs-type">EndpointRoleStep</span></a></span><span> </span><span id="local-6989586621680039223"><span class="annot"><span class="annottext">EndpointRole v
</span><a href="#local-6989586621680039223"><span class="hs-identifier hs-var">ep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EndpointRole v -&gt; StepInfo v x t
forall v x t. EndpointRole v -&gt; StepInfo v x t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#EndpointRoleStep"><span class="hs-identifier hs-var">EndpointRoleStep</span></a></span><span> </span><span class="annot"><span class="annottext">(EndpointRole v -&gt; StepInfo v x t)
-&gt; EndpointRole v -&gt; StepInfo v x t
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Changeset v -&gt; EndpointRole v -&gt; EndpointRole v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">Changeset v
</span><a href="#local-6989586621680039224"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointRole v
</span><a href="#local-6989586621680039223"><span class="hs-identifier hs-var">ep</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span id="local-6989586621680039222"><span class="annot"><span class="annottext">Changeset v
</span><a href="#local-6989586621680039222"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#NestedStep"><span class="hs-identifier hs-type">NestedStep</span></a></span><span> </span><span id="local-6989586621680039221"><span class="annot"><span class="annottext">tag
</span><a href="#local-6989586621680039221"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621680039220"><span class="annot"><span class="annottext">Step t (StepInfo v x t)
</span><a href="#local-6989586621680039220"><span class="hs-identifier hs-var">nStep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">tag -&gt; Step t (StepInfo v x t) -&gt; StepInfo v x t
forall tag t v x.
UnitTag tag =&gt;
tag -&gt; Step t (StepInfo v x t) -&gt; StepInfo v x t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#NestedStep"><span class="hs-identifier hs-var">NestedStep</span></a></span><span> </span><span class="annot"><span class="annottext">tag
</span><a href="#local-6989586621680039221"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">(Step t (StepInfo v x t) -&gt; StepInfo v x t)
-&gt; Step t (StepInfo v x t) -&gt; StepInfo v x t
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Changeset v -&gt; Step t (StepInfo v x t) -&gt; Step t (StepInfo v x t)
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">Changeset v
</span><a href="#local-6989586621680039222"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">Step t (StepInfo v x t)
</span><a href="#local-6989586621680039220"><span class="hs-identifier hs-var">nStep</span></a></span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">Changeset v
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680039219"><span class="annot"><span class="annottext">StepInfo v x t
</span><a href="#local-6989586621680039219"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StepInfo v x t
</span><a href="#local-6989586621680039219"><span class="hs-identifier hs-var">instr</span></a></span></span></span></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">-- |Relations between process steps.</span><span>
</span><span id="line-226"></span><span id="local-6989586621680039217"><span id="local-6989586621680039218"></span></span><span class="hs-keyword">data</span><span> </span><span id="Relation"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Relation"><span class="hs-identifier hs-var">Relation</span></a></span></span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- |Vertical relationships (up and down). For example, the intermediate</span><span>
</span><span id="line-228"></span><span>      </span><span class="hs-comment">-- step (function execution) can be translated to a sequence of endpoint</span><span>
</span><span id="line-229"></span><span>      </span><span class="hs-comment">-- steps (receiving and sending variable), and process unit instructions.</span><span>
</span><span id="line-230"></span><span>      </span><span id="Vertical"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Vertical"><span class="hs-identifier hs-var">Vertical</span></a></span></span><span> </span><span class="hs-special">{</span><span id="vUp"><span class="annot"><span class="annottext">Relation -&gt; ProcessStepID
</span><a href="NITTA.Model.ProcessorUnits.Types.html#vUp"><span class="hs-identifier hs-var hs-var">vUp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="vDown"><span class="annot"><span class="annottext">Relation -&gt; ProcessStepID
</span><a href="NITTA.Model.ProcessorUnits.Types.html#vDown"><span class="hs-identifier hs-var hs-var">vDown</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#ProcessStepID"><span class="hs-identifier hs-type">ProcessStepID</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- |Horizontal relationships (on one level). For example, we bind the</span><span>
</span><span id="line-232"></span><span>      </span><span class="hs-comment">-- function and apply the refactoring. The binding step should be</span><span>
</span><span id="line-233"></span><span>      </span><span class="hs-comment">-- connected to refactoring steps, including new binding steps.</span><span>
</span><span id="line-234"></span><span>      </span><span id="Horizontal"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Horizontal"><span class="hs-identifier hs-var">Horizontal</span></a></span></span><span> </span><span class="hs-special">{</span><span id="hPrev"><span class="annot"><span class="annottext">Relation -&gt; ProcessStepID
</span><a href="NITTA.Model.ProcessorUnits.Types.html#hPrev"><span class="hs-identifier hs-var hs-var">hPrev</span></a></span></span><span class="hs-special">,</span><span> </span><span id="hNext"><span class="annot"><span class="annottext">Relation -&gt; ProcessStepID
</span><a href="NITTA.Model.ProcessorUnits.Types.html#hNext"><span class="hs-identifier hs-var hs-var">hNext</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#ProcessStepID"><span class="hs-identifier hs-type">ProcessStepID</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680039205"><span id="local-6989586621680039207"><span id="local-6989586621680039209"><span class="annot"><span class="annottext">ProcessStepID -&gt; Relation -&gt; String -&gt; String
[Relation] -&gt; String -&gt; String
Relation -&gt; String
(ProcessStepID -&gt; Relation -&gt; String -&gt; String)
-&gt; (Relation -&gt; String)
-&gt; ([Relation] -&gt; String -&gt; String)
-&gt; Show Relation
forall a.
(ProcessStepID -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [Relation] -&gt; String -&gt; String
$cshowList :: [Relation] -&gt; String -&gt; String
show :: Relation -&gt; String
$cshow :: Relation -&gt; String
showsPrec :: ProcessStepID -&gt; Relation -&gt; String -&gt; String
$cshowsPrec :: ProcessStepID -&gt; Relation -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. Relation -&gt; Rep Relation x)
-&gt; (forall x. Rep Relation x -&gt; Relation) -&gt; Generic Relation
forall x. Rep Relation x -&gt; Relation
forall x. Relation -&gt; Rep Relation x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Relation x -&gt; Relation
$cfrom :: forall x. Relation -&gt; Rep Relation x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680039188"><span id="local-6989586621680039190"><span id="local-6989586621680039192"><span id="local-6989586621680039194"><span id="local-6989586621680039196"><span id="local-6989586621680039198"><span id="local-6989586621680039200"><span class="annot"><span class="annottext">Eq Relation
Eq Relation
-&gt; (Relation -&gt; Relation -&gt; Ordering)
-&gt; (Relation -&gt; Relation -&gt; Bool)
-&gt; (Relation -&gt; Relation -&gt; Bool)
-&gt; (Relation -&gt; Relation -&gt; Bool)
-&gt; (Relation -&gt; Relation -&gt; Bool)
-&gt; (Relation -&gt; Relation -&gt; Relation)
-&gt; (Relation -&gt; Relation -&gt; Relation)
-&gt; Ord Relation
Relation -&gt; Relation -&gt; Bool
Relation -&gt; Relation -&gt; Ordering
Relation -&gt; Relation -&gt; Relation
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Relation -&gt; Relation -&gt; Relation
$cmin :: Relation -&gt; Relation -&gt; Relation
max :: Relation -&gt; Relation -&gt; Relation
$cmax :: Relation -&gt; Relation -&gt; Relation
&gt;= :: Relation -&gt; Relation -&gt; Bool
$c&gt;= :: Relation -&gt; Relation -&gt; Bool
&gt; :: Relation -&gt; Relation -&gt; Bool
$c&gt; :: Relation -&gt; Relation -&gt; Bool
&lt;= :: Relation -&gt; Relation -&gt; Bool
$c&lt;= :: Relation -&gt; Relation -&gt; Bool
&lt; :: Relation -&gt; Relation -&gt; Bool
$c&lt; :: Relation -&gt; Relation -&gt; Bool
compare :: Relation -&gt; Relation -&gt; Ordering
$ccompare :: Relation -&gt; Relation -&gt; Ordering
$cp1Ord :: Eq Relation
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680039183"><span id="local-6989586621680039185"><span class="annot"><span class="annottext">Relation -&gt; Relation -&gt; Bool
(Relation -&gt; Relation -&gt; Bool)
-&gt; (Relation -&gt; Relation -&gt; Bool) -&gt; Eq Relation
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Relation -&gt; Relation -&gt; Bool
$c/= :: Relation -&gt; Relation -&gt; Bool
== :: Relation -&gt; Relation -&gt; Bool
$c== :: Relation -&gt; Relation -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span id="isVertical"><span class="annot"><span class="annottext">isVertical :: Relation -&gt; Bool
</span><a href="NITTA.Model.ProcessorUnits.Types.html#isVertical"><span class="hs-identifier hs-var hs-var">isVertical</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Vertical"><span class="hs-identifier hs-type">Vertical</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-238"></span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#isVertical"><span class="hs-identifier hs-var">isVertical</span></a></span><span> </span><span class="annot"><span class="annottext">Relation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span id="isHorizontal"><span class="annot"><span class="annottext">isHorizontal :: Relation -&gt; Bool
</span><a href="NITTA.Model.ProcessorUnits.Types.html#isHorizontal"><span class="hs-identifier hs-var hs-var">isHorizontal</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Horizontal"><span class="hs-identifier hs-type">Horizontal</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-241"></span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#isHorizontal"><span class="hs-identifier hs-var">isHorizontal</span></a></span><span> </span><span class="annot"><span class="annottext">Relation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680039174"><span id="local-6989586621680039176"><span id="local-6989586621680039178"><span id="local-6989586621680039180"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Relation"><span class="hs-identifier hs-type">Relation</span></a></span></span></span></span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span id="whatsHappen"><span class="annot"><span class="annottext">whatsHappen :: a -&gt; Process a i -&gt; [Step a i]
</span><a href="NITTA.Model.ProcessorUnits.Types.html#whatsHappen"><span class="hs-identifier hs-var hs-var">whatsHappen</span></a></span></span><span> </span><span id="local-6989586621680039173"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680039173"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Process"><span class="hs-identifier hs-type">Process</span></a></span><span class="hs-special">{</span><span id="local-6989586621680039172"><span class="annot"><span class="annottext">[Step a i]
steps :: [Step a i]
steps :: forall t i. Process t i -&gt; [Step t i]
</span><a href="#local-6989586621680039172"><span class="hs-identifier hs-var hs-var">steps</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Step a i -&gt; Bool) -&gt; [Step a i] -&gt; [Step a i]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Interval a -&gt; Bool
forall a. Ord a =&gt; a -&gt; Interval a -&gt; Bool
</span><a href="#local-6989586621680039171"><span class="hs-identifier hs-var">atSameTime</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680039173"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Interval a -&gt; Bool)
-&gt; (Step a i -&gt; Interval a) -&gt; Step a i -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Step a i -&gt; Interval a
forall t i. Step t i -&gt; Interval t
</span><a href="NITTA.Model.ProcessorUnits.Types.html#pInterval"><span class="hs-identifier hs-var hs-var">pInterval</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Step a i]
</span><a href="#local-6989586621680039172"><span class="hs-identifier hs-var">steps</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-247"></span><span>        </span><span id="local-6989586621680039171"><span class="annot"><span class="annottext">atSameTime :: a -&gt; Interval a -&gt; Bool
</span><a href="#local-6989586621680039171"><span class="hs-identifier hs-var hs-var">atSameTime</span></a></span></span><span> </span><span id="local-6989586621680039170"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680039170"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680039169"><span class="annot"><span class="annottext">Interval a
</span><a href="#local-6989586621680039169"><span class="hs-identifier hs-var">ti</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680039170"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Interval a -&gt; Bool
forall a. Ord a =&gt; a -&gt; Interval a -&gt; Bool
</span><span class="hs-operator hs-var">`member`</span></span><span> </span><span class="annot"><span class="annottext">Interval a
</span><a href="#local-6989586621680039169"><span class="hs-identifier hs-var">ti</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span id="extractInstructionAt"><span class="annot"><span class="annottext">extractInstructionAt :: u -&gt; t -&gt; [Instruction u]
</span><a href="NITTA.Model.ProcessorUnits.Types.html#extractInstructionAt"><span class="hs-identifier hs-var hs-var">extractInstructionAt</span></a></span></span><span> </span><span id="local-6989586621680039167"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621680039167"><span class="hs-identifier hs-var">pu</span></a></span></span><span> </span><span id="local-6989586621680039166"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680039166"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Step t (StepInfo v x t) -&gt; Maybe (Instruction u))
-&gt; [Step t (StepInfo v x t)] -&gt; [Instruction u]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">u -&gt; Step t (StepInfo v x t) -&gt; Maybe (Instruction u)
forall pu t v x.
Typeable (Instruction pu) =&gt;
pu -&gt; Step t (StepInfo v x t) -&gt; Maybe (Instruction pu)
</span><a href="#local-6989586621680039165"><span class="hs-identifier hs-var">inst</span></a></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621680039167"><span class="hs-identifier hs-var">pu</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Step t (StepInfo v x t)] -&gt; [Instruction u])
-&gt; [Step t (StepInfo v x t)] -&gt; [Instruction u]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Process t (StepInfo v x t) -&gt; [Step t (StepInfo v x t)]
forall a i. Ord a =&gt; a -&gt; Process a i -&gt; [Step a i]
</span><a href="NITTA.Model.ProcessorUnits.Types.html#whatsHappen"><span class="hs-identifier hs-var">whatsHappen</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680039166"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Process t (StepInfo v x t) -&gt; [Step t (StepInfo v x t)])
-&gt; Process t (StepInfo v x t) -&gt; [Step t (StepInfo v x t)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">u -&gt; Process t (StepInfo v x t)
forall u v x t.
ProcessorUnit u v x t =&gt;
u -&gt; Process t (StepInfo v x t)
</span><a href="NITTA.Model.ProcessorUnits.Types.html#process"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621680039167"><span class="hs-identifier hs-var">pu</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-251"></span><span>        </span><span id="local-6989586621680039443"><span id="local-6989586621680039444"><span id="local-6989586621680039445"><span id="local-6989586621680039446"><span class="annot"><a href="#local-6989586621680039165"><span class="hs-identifier hs-type">inst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039446"><span class="hs-identifier hs-type">pu</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680039446"><span class="hs-identifier hs-type">pu</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039445"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#StepInfo"><span class="hs-identifier hs-type">StepInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039444"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039443"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039445"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039446"><span class="hs-identifier hs-type">pu</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-252"></span><span>        </span><span id="local-6989586621680039165"><span class="annot"><span class="annottext">inst :: pu -&gt; Step t (StepInfo v x t) -&gt; Maybe (Instruction pu)
</span><a href="#local-6989586621680039165"><span class="hs-identifier hs-var hs-var">inst</span></a></span></span><span> </span><span class="annot"><span class="annottext">pu
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Step"><span class="hs-identifier hs-type">Step</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">pDesc :: forall t i. Step t i -&gt; i
</span><a href="NITTA.Model.ProcessorUnits.Types.html#pDesc"><span class="hs-identifier hs-var">pDesc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#InstructionStep"><span class="hs-identifier hs-type">InstructionStep</span></a></span><span> </span><span id="local-6989586621680039164"><span class="annot"><span class="annottext">Instruction pu
</span><a href="#local-6989586621680039164"><span class="hs-identifier hs-var">instr</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instruction pu -&gt; Maybe (Instruction pu)
forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b
</span><span class="hs-identifier hs-var">cast</span></span><span> </span><span class="annot"><span class="annottext">Instruction pu
</span><a href="#local-6989586621680039164"><span class="hs-identifier hs-var">instr</span></a></span><span>
</span><span id="line-253"></span><span>        </span><span class="annot"><a href="#local-6989586621680039165"><span class="hs-identifier hs-var">inst</span></a></span><span> </span><span class="annot"><span class="annottext">pu
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Step t (StepInfo v x t)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Instruction pu)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-comment">{- |Shift @nextTick@ value if it is not zero on a specific offset. Use case: The
processor unit has buffered output, so we should provide @oe@ signal for one
tick before data actually send to the bus. That raises the following cases:

1. First usage. We can receive value immediately on nextTick

    @
    tick | Endpoint     | Instruction |
     0   | Target &quot;c&quot;   | WR          | &lt;- nextTick
    @

2. Not first usage. We need to wait for one tick from the last instruction due to the offset between instruction and data transfers.

    @
    tick | Endpoint     | Instruction |
      8  |              | OE          |
      9  | Source [&quot;b&quot;] |             | &lt;- nextTick
     10  | Target &quot;c&quot;   | WR          |
    @
-}</span><span>
</span><span id="line-275"></span><span class="annot"><span class="annottext">p
</span><span class="hs-number">0</span></span><span> </span><span id="withShift"><span class="annot"><span class="annottext">withShift :: p -&gt; p -&gt; p
</span><a href="NITTA.Model.ProcessorUnits.Types.html#withShift"><span class="hs-operator hs-var hs-var">`withShift`</span></a></span></span><span> </span><span id="local-6989586621680039162"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680039162"><span class="hs-identifier hs-var">_offset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">0</span></span><span>
</span><span id="line-276"></span><span id="local-6989586621680039161"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680039161"><span class="hs-identifier hs-var">tick</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#withShift"><span class="hs-operator hs-var">`withShift`</span></a></span><span> </span><span id="local-6989586621680039160"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680039160"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680039161"><span class="hs-identifier hs-var">tick</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; p -&gt; p
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680039160"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">---------------------------------------------------------------------</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-comment">{- |Type class for controllable units. Defines two level of a unit behaviour
representation (see ahead).
-}</span><span>
</span><span id="line-283"></span><span class="hs-keyword">class</span><span> </span><span id="Controllable"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Controllable"><span class="hs-identifier hs-var">Controllable</span></a></span></span><span> </span><span id="local-6989586621680039158"><span class="annot"><a href="#local-6989586621680039158"><span class="hs-identifier hs-type">pu</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-comment">-- Instruction describe unit behaviour on each mUnit cycle. If instruction</span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-comment">-- not defined for some cycles - it should be interpreted as NOP.</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-keyword">data</span><span> </span><span id="Instruction"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Instruction"><span class="hs-identifier hs-var">Instruction</span></a></span></span><span> </span><span id="local-6989586621680039158"><span class="annot"><a href="#local-6989586621680039158"><span class="hs-identifier hs-type">pu</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-comment">-- |Microcode desctibe controll signals on each mUnit cycle (without exclusion).</span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-keyword">data</span><span> </span><span id="Microcode"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Microcode"><span class="hs-identifier hs-var">Microcode</span></a></span></span><span> </span><span id="local-6989586621680039158"><span class="annot"><a href="#local-6989586621680039158"><span class="hs-identifier hs-type">pu</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-comment">-- |Zip port signal tags and value.</span><span>
</span><span id="line-292"></span><span>    </span><span id="zipSignalTagsAndValues"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#zipSignalTagsAndValues"><span class="hs-identifier hs-type">zipSignalTagsAndValues</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Ports"><span class="hs-identifier hs-type">Ports</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039158"><span class="hs-identifier hs-type">pu</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Microcode"><span class="hs-identifier hs-type">Microcode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039158"><span class="hs-identifier hs-type">pu</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#SignalTag"><span class="hs-identifier hs-type">SignalTag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#SignalValue"><span class="hs-identifier hs-type">SignalValue</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-comment">-- |Get list of used control signal tags.</span><span>
</span><span id="line-295"></span><span>    </span><span id="usedPortTags"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#usedPortTags"><span class="hs-identifier hs-type">usedPortTags</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Ports"><span class="hs-identifier hs-type">Ports</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039158"><span class="hs-identifier hs-type">pu</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#SignalTag"><span class="hs-identifier hs-type">SignalTag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-comment">-- |Take signal tags from inifinite list of tags.</span><span>
</span><span id="line-298"></span><span>    </span><span id="takePortTags"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#takePortTags"><span class="hs-identifier hs-type">takePortTags</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#SignalTag"><span class="hs-identifier hs-type">SignalTag</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680039158"><span class="hs-identifier hs-type">pu</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Ports"><span class="hs-identifier hs-type">Ports</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039158"><span class="hs-identifier hs-type">pu</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-comment">-- |Getting microcode value at a specific time.</span><span>
</span><span id="line-301"></span><span class="hs-keyword">class</span><span> </span><span id="ByTime"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#ByTime"><span class="hs-identifier hs-var">ByTime</span></a></span></span><span> </span><span id="local-6989586621680039429"><span class="annot"><a href="#local-6989586621680039429"><span class="hs-identifier hs-type">pu</span></a></span></span><span> </span><span id="local-6989586621680039428"><span class="annot"><a href="#local-6989586621680039428"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621680039429"><span class="hs-identifier hs-type">pu</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680039428"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-302"></span><span>    </span><span id="microcodeAt"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#microcodeAt"><span class="hs-identifier hs-type">microcodeAt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680039429"><span class="hs-identifier hs-type">pu</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680039428"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Microcode"><span class="hs-identifier hs-type">Microcode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039429"><span class="hs-identifier hs-type">pu</span></a></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span id="local-6989586621680039149"><span id="local-6989586621680039150"><span id="local-6989586621680039151"><span id="local-6989586621680039152"><span class="hs-keyword">instance</span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039152"><span class="hs-identifier hs-type">pu</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Microcode"><span class="hs-identifier hs-type">Microcode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039152"><span class="hs-identifier hs-type">pu</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#ProcessorUnit"><span class="hs-identifier hs-type">ProcessorUnit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039152"><span class="hs-identifier hs-type">pu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039151"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039150"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039149"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#UnambiguouslyDecode"><span class="hs-identifier hs-type">UnambiguouslyDecode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039152"><span class="hs-identifier hs-type">pu</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Model.Time.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039149"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621680039152"><span class="hs-identifier hs-type">pu</span></a></span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#ByTime"><span class="hs-identifier hs-type">ByTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039152"><span class="hs-identifier hs-type">pu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039149"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621680039146"><span class="annot"><span class="annottext">microcodeAt :: pu -&gt; t -&gt; Microcode pu
</span><a href="#local-6989586621680039146"><span class="hs-identifier hs-var hs-var hs-var hs-var">microcodeAt</span></a></span></span><span> </span><span id="local-6989586621680039145"><span class="annot"><span class="annottext">pu
</span><a href="#local-6989586621680039145"><span class="hs-identifier hs-var">pu</span></a></span></span><span> </span><span id="local-6989586621680039144"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680039144"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">pu -&gt; t -&gt; [Instruction pu]
forall u v x t.
(ProcessorUnit u v x t, Typeable u) =&gt;
u -&gt; t -&gt; [Instruction u]
</span><a href="NITTA.Model.ProcessorUnits.Types.html#extractInstructionAt"><span class="hs-identifier hs-var">extractInstructionAt</span></a></span><span> </span><span class="annot"><span class="annottext">pu
</span><a href="#local-6989586621680039145"><span class="hs-identifier hs-var">pu</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680039144"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-315"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Microcode pu
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-316"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621680039143"><span class="annot"><span class="annottext">Instruction pu
</span><a href="#local-6989586621680039143"><span class="hs-identifier hs-var">instr</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instruction pu -&gt; Microcode pu
forall pu. UnambiguouslyDecode pu =&gt; Instruction pu -&gt; Microcode pu
</span><a href="NITTA.Model.ProcessorUnits.Types.html#decodeInstruction"><span class="hs-identifier hs-var">decodeInstruction</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction pu
</span><a href="#local-6989586621680039143"><span class="hs-identifier hs-var">instr</span></a></span><span>
</span><span id="line-317"></span><span>        </span><span id="local-6989586621680039141"><span class="annot"><span class="annottext">[Instruction pu]
</span><a href="#local-6989586621680039141"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Microcode pu
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="">[i|instruction collision at #{ t } tick: #{ is } #{ pretty $ process pu }|]</span></span></span></span></span></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-keyword">newtype</span><span> </span><span id="SignalTag"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#SignalTag"><span class="hs-identifier hs-var">SignalTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SignalTag"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#SignalTag"><span class="hs-identifier hs-var">SignalTag</span></a></span></span><span> </span><span class="hs-special">{</span><span id="signalTag"><span class="annot"><span class="annottext">SignalTag -&gt; Text
</span><a href="NITTA.Model.ProcessorUnits.Types.html#signalTag"><span class="hs-identifier hs-var hs-var">signalTag</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680039135"><span id="local-6989586621680039137"><span class="annot"><span class="annottext">SignalTag -&gt; SignalTag -&gt; Bool
(SignalTag -&gt; SignalTag -&gt; Bool)
-&gt; (SignalTag -&gt; SignalTag -&gt; Bool) -&gt; Eq SignalTag
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SignalTag -&gt; SignalTag -&gt; Bool
$c/= :: SignalTag -&gt; SignalTag -&gt; Bool
== :: SignalTag -&gt; SignalTag -&gt; Bool
$c== :: SignalTag -&gt; SignalTag -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680039120"><span id="local-6989586621680039122"><span id="local-6989586621680039124"><span id="local-6989586621680039126"><span id="local-6989586621680039128"><span id="local-6989586621680039130"><span id="local-6989586621680039132"><span class="annot"><span class="annottext">Eq SignalTag
Eq SignalTag
-&gt; (SignalTag -&gt; SignalTag -&gt; Ordering)
-&gt; (SignalTag -&gt; SignalTag -&gt; Bool)
-&gt; (SignalTag -&gt; SignalTag -&gt; Bool)
-&gt; (SignalTag -&gt; SignalTag -&gt; Bool)
-&gt; (SignalTag -&gt; SignalTag -&gt; Bool)
-&gt; (SignalTag -&gt; SignalTag -&gt; SignalTag)
-&gt; (SignalTag -&gt; SignalTag -&gt; SignalTag)
-&gt; Ord SignalTag
SignalTag -&gt; SignalTag -&gt; Bool
SignalTag -&gt; SignalTag -&gt; Ordering
SignalTag -&gt; SignalTag -&gt; SignalTag
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: SignalTag -&gt; SignalTag -&gt; SignalTag
$cmin :: SignalTag -&gt; SignalTag -&gt; SignalTag
max :: SignalTag -&gt; SignalTag -&gt; SignalTag
$cmax :: SignalTag -&gt; SignalTag -&gt; SignalTag
&gt;= :: SignalTag -&gt; SignalTag -&gt; Bool
$c&gt;= :: SignalTag -&gt; SignalTag -&gt; Bool
&gt; :: SignalTag -&gt; SignalTag -&gt; Bool
$c&gt; :: SignalTag -&gt; SignalTag -&gt; Bool
&lt;= :: SignalTag -&gt; SignalTag -&gt; Bool
$c&lt;= :: SignalTag -&gt; SignalTag -&gt; Bool
&lt; :: SignalTag -&gt; SignalTag -&gt; Bool
$c&lt; :: SignalTag -&gt; SignalTag -&gt; Bool
compare :: SignalTag -&gt; SignalTag -&gt; Ordering
$ccompare :: SignalTag -&gt; SignalTag -&gt; Ordering
$cp1Ord :: Eq SignalTag
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680039115"><span id="local-6989586621680039118"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#SignalTag"><span class="hs-identifier hs-type">SignalTag</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621680039114"><span class="annot"><span class="annottext">show :: SignalTag -&gt; String
</span><a href="#local-6989586621680039114"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. ToString a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">toString</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; (SignalTag -&gt; Text) -&gt; SignalTag -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SignalTag -&gt; Text
</span><a href="NITTA.Model.ProcessorUnits.Types.html#signalTag"><span class="hs-identifier hs-var hs-var">signalTag</span></a></span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">-- |Type class of processor units with control ports.</span><span>
</span><span id="line-325"></span><span class="hs-keyword">class</span><span> </span><span id="Connected"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Connected"><span class="hs-identifier hs-var">Connected</span></a></span></span><span> </span><span id="local-6989586621680039113"><span class="annot"><a href="#local-6989586621680039113"><span class="hs-identifier hs-type">pu</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-comment">-- |A processor unit control ports (signals, flags).</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-keyword">data</span><span> </span><span id="Ports"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Ports"><span class="hs-identifier hs-var">Ports</span></a></span></span><span> </span><span id="local-6989586621680039113"><span class="annot"><a href="#local-6989586621680039113"><span class="hs-identifier hs-type">pu</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">{- |Decoding microcode from a simple instruction (microcode don't change over
time).

TODO: Generalize that class for all process units, including networks.
-}</span><span>
</span><span id="line-334"></span><span class="hs-keyword">class</span><span> </span><span id="UnambiguouslyDecode"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#UnambiguouslyDecode"><span class="hs-identifier hs-var">UnambiguouslyDecode</span></a></span></span><span> </span><span id="local-6989586621680039424"><span class="annot"><a href="#local-6989586621680039424"><span class="hs-identifier hs-type">pu</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-335"></span><span>    </span><span id="decodeInstruction"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#decodeInstruction"><span class="hs-identifier hs-type">decodeInstruction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039424"><span class="hs-identifier hs-type">pu</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Microcode"><span class="hs-identifier hs-type">Microcode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039424"><span class="hs-identifier hs-type">pu</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="hs-comment">-- |Control line value.</span><span>
</span><span id="line-338"></span><span class="hs-keyword">data</span><span> </span><span id="SignalValue"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#SignalValue"><span class="hs-identifier hs-var">SignalValue</span></a></span></span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- |undefined by design (`x`)</span><span>
</span><span id="line-340"></span><span>      </span><span id="Undef"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Undef"><span class="hs-identifier hs-var">Undef</span></a></span></span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- |boolean (`0` or `1`)</span><span>
</span><span id="line-342"></span><span>      </span><span id="Bool"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Bool"><span class="hs-identifier hs-var">Bool</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- |broken value (`x`) by data colision</span><span>
</span><span id="line-344"></span><span>      </span><span id="BrokenSignal"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#BrokenSignal"><span class="hs-identifier hs-var">BrokenSignal</span></a></span></span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680039106"><span id="local-6989586621680039108"><span class="annot"><span class="annottext">SignalValue -&gt; SignalValue -&gt; Bool
(SignalValue -&gt; SignalValue -&gt; Bool)
-&gt; (SignalValue -&gt; SignalValue -&gt; Bool) -&gt; Eq SignalValue
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SignalValue -&gt; SignalValue -&gt; Bool
$c/= :: SignalValue -&gt; SignalValue -&gt; Bool
== :: SignalValue -&gt; SignalValue -&gt; Bool
$c== :: SignalValue -&gt; SignalValue -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#SignalValue"><span class="hs-identifier hs-type">SignalValue</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-348"></span><span>    </span><span id="local-6989586621680039104"><span class="annot"><span class="annottext">def :: SignalValue
</span><a href="#local-6989586621680039104"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SignalValue
</span><a href="NITTA.Model.ProcessorUnits.Types.html#Undef"><span class="hs-identifier hs-var">Undef</span></a></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680039099"><span id="local-6989586621680039102"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#SignalValue"><span class="hs-identifier hs-type">SignalValue</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-351"></span><span>    </span><span id="local-6989586621680039098"><span class="annot"><span class="annottext">show :: SignalValue -&gt; String
</span><a href="#local-6989586621680039098"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="annot"><span class="annottext">SignalValue
</span><a href="NITTA.Model.ProcessorUnits.Types.html#Undef"><span class="hs-identifier hs-var">Undef</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x&quot;</span></span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span>
</span><span id="line-354"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SignalValue
</span><a href="NITTA.Model.ProcessorUnits.Types.html#BrokenSignal"><span class="hs-identifier hs-var">BrokenSignal</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;B&quot;</span></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="annot"><span class="annottext">SignalValue
</span><a href="NITTA.Model.ProcessorUnits.Types.html#Undef"><span class="hs-identifier hs-var">Undef</span></a></span><span> </span><span id="%2B%2B%2B"><span class="annot"><span class="annottext">+++ :: SignalValue -&gt; SignalValue -&gt; SignalValue
</span><a href="NITTA.Model.ProcessorUnits.Types.html#%2B%2B%2B"><span class="hs-operator hs-var hs-var">+++</span></a></span></span><span> </span><span id="local-6989586621680039097"><span class="annot"><span class="annottext">SignalValue
</span><a href="#local-6989586621680039097"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SignalValue
</span><a href="#local-6989586621680039097"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-357"></span><span id="local-6989586621680039096"><span class="annot"><span class="annottext">SignalValue
</span><a href="#local-6989586621680039096"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a></span><span> </span><span class="annot"><span class="annottext">SignalValue
</span><a href="NITTA.Model.ProcessorUnits.Types.html#Undef"><span class="hs-identifier hs-var">Undef</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SignalValue
</span><a href="#local-6989586621680039096"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-358"></span><span class="annot"><span class="annottext">SignalValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a></span><span> </span><span class="annot"><span class="annottext">SignalValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SignalValue
</span><a href="NITTA.Model.ProcessorUnits.Types.html#BrokenSignal"><span class="hs-identifier hs-var">BrokenSignal</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-comment">-- |Type class of processor units with IO ports.</span><span>
</span><span id="line-363"></span><span class="hs-keyword">class</span><span> </span><span id="IOConnected"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#IOConnected"><span class="hs-identifier hs-var">IOConnected</span></a></span></span><span> </span><span id="local-6989586621680039421"><span class="annot"><a href="#local-6989586621680039421"><span class="hs-identifier hs-type">pu</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-keyword">data</span><span> </span><span id="IOPorts"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#IOPorts"><span class="hs-identifier hs-var">IOPorts</span></a></span></span><span> </span><span id="local-6989586621680039421"><span class="annot"><a href="#local-6989586621680039421"><span class="hs-identifier hs-type">pu</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span>    </span><span class="hs-comment">-- |External input ports, which go outside of NITTA mUnit.</span><span>
</span><span id="line-367"></span><span>    </span><span id="inputPorts"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#inputPorts"><span class="hs-identifier hs-type">inputPorts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#IOPorts"><span class="hs-identifier hs-type">IOPorts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039421"><span class="hs-identifier hs-type">pu</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#InputPortTag"><span class="hs-identifier hs-type">InputPortTag</span></a></span><span>
</span><span id="line-368"></span><span>    </span><span id="local-6989586621680039094"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#inputPorts"><span class="hs-identifier hs-var hs-var">inputPorts</span></a></span><span> </span><span class="annot"><span class="annottext">IOPorts pu
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set InputPortTag
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-comment">-- |External output ports, which go outside of NITTA mUnit.</span></span><span>
</span><span id="line-371"></span><span>    </span><span id="outputPorts"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#outputPorts"><span class="hs-identifier hs-type">outputPorts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#IOPorts"><span class="hs-identifier hs-type">IOPorts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039421"><span class="hs-identifier hs-type">pu</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#OutputPortTag"><span class="hs-identifier hs-type">OutputPortTag</span></a></span><span>
</span><span id="line-372"></span><span>    </span><span id="local-6989586621680039091"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#outputPorts"><span class="hs-identifier hs-var hs-var">outputPorts</span></a></span><span> </span><span class="annot"><span class="annottext">IOPorts pu
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set OutputPortTag
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-comment">-- |External output ports, which go outside of NITTA mUnit.</span></span><span>
</span><span id="line-375"></span><span>    </span><span id="inoutPorts"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#inoutPorts"><span class="hs-identifier hs-type">inoutPorts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#IOPorts"><span class="hs-identifier hs-type">IOPorts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680039421"><span class="hs-identifier hs-type">pu</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#InoutPortTag"><span class="hs-identifier hs-type">InoutPortTag</span></a></span><span>
</span><span id="line-376"></span><span>    </span><span id="local-6989586621680039089"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#inoutPorts"><span class="hs-identifier hs-var hs-var">inoutPorts</span></a></span><span> </span><span class="annot"><span class="annottext">IOPorts pu
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set InoutPortTag
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-keyword">newtype</span><span> </span><span id="InputPortTag"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#InputPortTag"><span class="hs-identifier hs-var">InputPortTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="InputPortTag"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#InputPortTag"><span class="hs-identifier hs-var">InputPortTag</span></a></span></span><span> </span><span class="hs-special">{</span><span id="inputPortTag"><span class="annot"><span class="annottext">InputPortTag -&gt; Text
</span><a href="NITTA.Model.ProcessorUnits.Types.html#inputPortTag"><span class="hs-identifier hs-var hs-var">inputPortTag</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680039083"><span id="local-6989586621680039085"><span class="annot"><span class="annottext">InputPortTag -&gt; InputPortTag -&gt; Bool
(InputPortTag -&gt; InputPortTag -&gt; Bool)
-&gt; (InputPortTag -&gt; InputPortTag -&gt; Bool) -&gt; Eq InputPortTag
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: InputPortTag -&gt; InputPortTag -&gt; Bool
$c/= :: InputPortTag -&gt; InputPortTag -&gt; Bool
== :: InputPortTag -&gt; InputPortTag -&gt; Bool
$c== :: InputPortTag -&gt; InputPortTag -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680039068"><span id="local-6989586621680039070"><span id="local-6989586621680039072"><span id="local-6989586621680039074"><span id="local-6989586621680039076"><span id="local-6989586621680039078"><span id="local-6989586621680039080"><span class="annot"><span class="annottext">Eq InputPortTag
Eq InputPortTag
-&gt; (InputPortTag -&gt; InputPortTag -&gt; Ordering)
-&gt; (InputPortTag -&gt; InputPortTag -&gt; Bool)
-&gt; (InputPortTag -&gt; InputPortTag -&gt; Bool)
-&gt; (InputPortTag -&gt; InputPortTag -&gt; Bool)
-&gt; (InputPortTag -&gt; InputPortTag -&gt; Bool)
-&gt; (InputPortTag -&gt; InputPortTag -&gt; InputPortTag)
-&gt; (InputPortTag -&gt; InputPortTag -&gt; InputPortTag)
-&gt; Ord InputPortTag
InputPortTag -&gt; InputPortTag -&gt; Bool
InputPortTag -&gt; InputPortTag -&gt; Ordering
InputPortTag -&gt; InputPortTag -&gt; InputPortTag
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: InputPortTag -&gt; InputPortTag -&gt; InputPortTag
$cmin :: InputPortTag -&gt; InputPortTag -&gt; InputPortTag
max :: InputPortTag -&gt; InputPortTag -&gt; InputPortTag
$cmax :: InputPortTag -&gt; InputPortTag -&gt; InputPortTag
&gt;= :: InputPortTag -&gt; InputPortTag -&gt; Bool
$c&gt;= :: InputPortTag -&gt; InputPortTag -&gt; Bool
&gt; :: InputPortTag -&gt; InputPortTag -&gt; Bool
$c&gt; :: InputPortTag -&gt; InputPortTag -&gt; Bool
&lt;= :: InputPortTag -&gt; InputPortTag -&gt; Bool
$c&lt;= :: InputPortTag -&gt; InputPortTag -&gt; Bool
&lt; :: InputPortTag -&gt; InputPortTag -&gt; Bool
$c&lt; :: InputPortTag -&gt; InputPortTag -&gt; Bool
compare :: InputPortTag -&gt; InputPortTag -&gt; Ordering
$ccompare :: InputPortTag -&gt; InputPortTag -&gt; Ordering
$cp1Ord :: Eq InputPortTag
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680039063"><span id="local-6989586621680039066"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#InputPortTag"><span class="hs-identifier hs-type">InputPortTag</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680039062"><span class="annot"><span class="annottext">show :: InputPortTag -&gt; String
</span><a href="#local-6989586621680039062"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. ToString a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">toString</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String)
-&gt; (InputPortTag -&gt; Text) -&gt; InputPortTag -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">InputPortTag -&gt; Text
</span><a href="NITTA.Model.ProcessorUnits.Types.html#inputPortTag"><span class="hs-identifier hs-var hs-var">inputPortTag</span></a></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-keyword">newtype</span><span> </span><span id="OutputPortTag"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#OutputPortTag"><span class="hs-identifier hs-var">OutputPortTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OutputPortTag"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#OutputPortTag"><span class="hs-identifier hs-var">OutputPortTag</span></a></span></span><span> </span><span class="hs-special">{</span><span id="outputPortTag"><span class="annot"><span class="annottext">OutputPortTag -&gt; Text
</span><a href="NITTA.Model.ProcessorUnits.Types.html#outputPortTag"><span class="hs-identifier hs-var hs-var">outputPortTag</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680039056"><span id="local-6989586621680039058"><span class="annot"><span class="annottext">OutputPortTag -&gt; OutputPortTag -&gt; Bool
(OutputPortTag -&gt; OutputPortTag -&gt; Bool)
-&gt; (OutputPortTag -&gt; OutputPortTag -&gt; Bool) -&gt; Eq OutputPortTag
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: OutputPortTag -&gt; OutputPortTag -&gt; Bool
$c/= :: OutputPortTag -&gt; OutputPortTag -&gt; Bool
== :: OutputPortTag -&gt; OutputPortTag -&gt; Bool
$c== :: OutputPortTag -&gt; OutputPortTag -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680039041"><span id="local-6989586621680039043"><span id="local-6989586621680039045"><span id="local-6989586621680039047"><span id="local-6989586621680039049"><span id="local-6989586621680039051"><span id="local-6989586621680039053"><span class="annot"><span class="annottext">Eq OutputPortTag
Eq OutputPortTag
-&gt; (OutputPortTag -&gt; OutputPortTag -&gt; Ordering)
-&gt; (OutputPortTag -&gt; OutputPortTag -&gt; Bool)
-&gt; (OutputPortTag -&gt; OutputPortTag -&gt; Bool)
-&gt; (OutputPortTag -&gt; OutputPortTag -&gt; Bool)
-&gt; (OutputPortTag -&gt; OutputPortTag -&gt; Bool)
-&gt; (OutputPortTag -&gt; OutputPortTag -&gt; OutputPortTag)
-&gt; (OutputPortTag -&gt; OutputPortTag -&gt; OutputPortTag)
-&gt; Ord OutputPortTag
OutputPortTag -&gt; OutputPortTag -&gt; Bool
OutputPortTag -&gt; OutputPortTag -&gt; Ordering
OutputPortTag -&gt; OutputPortTag -&gt; OutputPortTag
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: OutputPortTag -&gt; OutputPortTag -&gt; OutputPortTag
$cmin :: OutputPortTag -&gt; OutputPortTag -&gt; OutputPortTag
max :: OutputPortTag -&gt; OutputPortTag -&gt; OutputPortTag
$cmax :: OutputPortTag -&gt; OutputPortTag -&gt; OutputPortTag
&gt;= :: OutputPortTag -&gt; OutputPortTag -&gt; Bool
$c&gt;= :: OutputPortTag -&gt; OutputPortTag -&gt; Bool
&gt; :: OutputPortTag -&gt; OutputPortTag -&gt; Bool
$c&gt; :: OutputPortTag -&gt; OutputPortTag -&gt; Bool
&lt;= :: OutputPortTag -&gt; OutputPortTag -&gt; Bool
$c&lt;= :: OutputPortTag -&gt; OutputPortTag -&gt; Bool
&lt; :: OutputPortTag -&gt; OutputPortTag -&gt; Bool
$c&lt; :: OutputPortTag -&gt; OutputPortTag -&gt; Bool
compare :: OutputPortTag -&gt; OutputPortTag -&gt; Ordering
$ccompare :: OutputPortTag -&gt; OutputPortTag -&gt; Ordering
$cp1Ord :: Eq OutputPortTag
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680039036"><span id="local-6989586621680039039"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#OutputPortTag"><span class="hs-identifier hs-type">OutputPortTag</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680039035"><span class="annot"><span class="annottext">show :: OutputPortTag -&gt; String
</span><a href="#local-6989586621680039035"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. ToString a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">toString</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String)
-&gt; (OutputPortTag -&gt; Text) -&gt; OutputPortTag -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OutputPortTag -&gt; Text
</span><a href="NITTA.Model.ProcessorUnits.Types.html#outputPortTag"><span class="hs-identifier hs-var hs-var">outputPortTag</span></a></span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="hs-keyword">newtype</span><span> </span><span id="InoutPortTag"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#InoutPortTag"><span class="hs-identifier hs-var">InoutPortTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="InoutPortTag"><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#InoutPortTag"><span class="hs-identifier hs-var">InoutPortTag</span></a></span></span><span> </span><span class="hs-special">{</span><span id="inoutPortTag"><span class="annot"><span class="annottext">InoutPortTag -&gt; Text
</span><a href="NITTA.Model.ProcessorUnits.Types.html#inoutPortTag"><span class="hs-identifier hs-var hs-var">inoutPortTag</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680039029"><span id="local-6989586621680039031"><span class="annot"><span class="annottext">InoutPortTag -&gt; InoutPortTag -&gt; Bool
(InoutPortTag -&gt; InoutPortTag -&gt; Bool)
-&gt; (InoutPortTag -&gt; InoutPortTag -&gt; Bool) -&gt; Eq InoutPortTag
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: InoutPortTag -&gt; InoutPortTag -&gt; Bool
$c/= :: InoutPortTag -&gt; InoutPortTag -&gt; Bool
== :: InoutPortTag -&gt; InoutPortTag -&gt; Bool
$c== :: InoutPortTag -&gt; InoutPortTag -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680039014"><span id="local-6989586621680039016"><span id="local-6989586621680039018"><span id="local-6989586621680039020"><span id="local-6989586621680039022"><span id="local-6989586621680039024"><span id="local-6989586621680039026"><span class="annot"><span class="annottext">Eq InoutPortTag
Eq InoutPortTag
-&gt; (InoutPortTag -&gt; InoutPortTag -&gt; Ordering)
-&gt; (InoutPortTag -&gt; InoutPortTag -&gt; Bool)
-&gt; (InoutPortTag -&gt; InoutPortTag -&gt; Bool)
-&gt; (InoutPortTag -&gt; InoutPortTag -&gt; Bool)
-&gt; (InoutPortTag -&gt; InoutPortTag -&gt; Bool)
-&gt; (InoutPortTag -&gt; InoutPortTag -&gt; InoutPortTag)
-&gt; (InoutPortTag -&gt; InoutPortTag -&gt; InoutPortTag)
-&gt; Ord InoutPortTag
InoutPortTag -&gt; InoutPortTag -&gt; Bool
InoutPortTag -&gt; InoutPortTag -&gt; Ordering
InoutPortTag -&gt; InoutPortTag -&gt; InoutPortTag
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: InoutPortTag -&gt; InoutPortTag -&gt; InoutPortTag
$cmin :: InoutPortTag -&gt; InoutPortTag -&gt; InoutPortTag
max :: InoutPortTag -&gt; InoutPortTag -&gt; InoutPortTag
$cmax :: InoutPortTag -&gt; InoutPortTag -&gt; InoutPortTag
&gt;= :: InoutPortTag -&gt; InoutPortTag -&gt; Bool
$c&gt;= :: InoutPortTag -&gt; InoutPortTag -&gt; Bool
&gt; :: InoutPortTag -&gt; InoutPortTag -&gt; Bool
$c&gt; :: InoutPortTag -&gt; InoutPortTag -&gt; Bool
&lt;= :: InoutPortTag -&gt; InoutPortTag -&gt; Bool
$c&lt;= :: InoutPortTag -&gt; InoutPortTag -&gt; Bool
&lt; :: InoutPortTag -&gt; InoutPortTag -&gt; Bool
$c&lt; :: InoutPortTag -&gt; InoutPortTag -&gt; Bool
compare :: InoutPortTag -&gt; InoutPortTag -&gt; Ordering
$ccompare :: InoutPortTag -&gt; InoutPortTag -&gt; Ordering
$cp1Ord :: Eq InoutPortTag
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680039009"><span id="local-6989586621680039012"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html#InoutPortTag"><span class="hs-identifier hs-type">InoutPortTag</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680039008"><span class="annot"><span class="annottext">show :: InoutPortTag -&gt; String
</span><a href="#local-6989586621680039008"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
forall a. ToString a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">toString</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String)
-&gt; (InoutPortTag -&gt; Text) -&gt; InoutPortTag -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">InoutPortTag -&gt; Text
</span><a href="NITTA.Model.ProcessorUnits.Types.html#inoutPortTag"><span class="hs-identifier hs-var hs-var">inoutPortTag</span></a></span><span>
</span><span id="line-386"></span></pre></body></html>