<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE QuasiQuotes #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-comment">{- |
Module      : NITTA.Project
Description :
Copyright   : (c) Aleksandr Penskoi, 2021
License     : BSD3
Maintainer  : aleksandr.penskoi@gmail.com
Stability   : experimental
-}</span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">NITTA.Project</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="NITTA.Project.Template.html"><span class="hs-identifier">NITTA.Project.Template</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="NITTA.Project.TestBench.html"><span class="hs-identifier">NITTA.Project.TestBench</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="NITTA.Project.Types.html"><span class="hs-identifier">NITTA.Project.Types</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="NITTA.Project.VerilogSnippets.html"><span class="hs-identifier">NITTA.Project.VerilogSnippets</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="NITTA.Project.html#writeProject"><span class="hs-identifier">writeProject</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="NITTA.Project.html#runTestbench"><span class="hs-identifier">runTestbench</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Identity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runIdentity</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HM</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String.Interpolate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">__i</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String.ToString</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.IO</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html"><span class="hs-identifier">NITTA.Intermediate.Types</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.ProcessorUnits.Types.html"><span class="hs-identifier">NITTA.Model.ProcessorUnits.Types</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Project.Context.html"><span class="hs-identifier">NITTA.Project.Context</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Project.Template.html"><span class="hs-identifier">NITTA.Project.Template</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Project.TestBench.html"><span class="hs-identifier">NITTA.Project.TestBench</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Project.Types.html"><span class="hs-identifier">NITTA.Project.Types</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Project.VerilogSnippets.html"><span class="hs-identifier">NITTA.Project.VerilogSnippets</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Utils.Base.html"><span class="hs-identifier">NITTA.Utils.Base</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Exit</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath.Posix</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Log.Logger</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Process.ListLike</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CreateProcess</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">proc</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Process.Text</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Ginger</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">length</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Regex</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- |Write project with all available parts.</span><span>
</span><span id="line-54"></span><span id="writeProject"><span class="annot"><span class="annottext">writeProject :: Project m v x -&gt; IO ()
</span><a href="NITTA.Project.html#writeProject"><span class="hs-identifier hs-var hs-var">writeProject</span></a></span></span><span> </span><span id="local-6989586621680033919"><span class="annot"><span class="annottext">prj :: Project m v x
</span><a href="#local-6989586621680033919"><span class="hs-identifier hs-var">prj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Project.Types.html#Project"><span class="hs-identifier hs-type">Project</span></a></span><span class="hs-special">{</span><span id="local-6989586621680033917"><span class="annot"><span class="annottext">FilePath
pTargetProjectPath :: forall m v x. Project m v x -&gt; FilePath
pTargetProjectPath :: FilePath
</span><a href="NITTA.Project.Types.html#pTargetProjectPath"><span class="hs-identifier hs-var hs-var">pTargetProjectPath</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">infoM</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;NITTA&quot;</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;write target project to: \&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033917"><span class="hs-identifier hs-var">pTargetProjectPath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\&quot;...&quot;</span></span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="annottext">Project m v x -&gt; IO ()
forall pu v x.
(TargetSystemComponent pu, Testable pu v x) =&gt;
Project pu v x -&gt; IO ()
</span><a href="NITTA.Project.html#writeTargetSystem"><span class="hs-identifier hs-var">writeTargetSystem</span></a></span><span> </span><span class="annot"><span class="annottext">Project m v x
</span><a href="#local-6989586621680033919"><span class="hs-identifier hs-var">prj</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><span class="annottext">Project m v x -&gt; IO ()
forall pu v x.
(TargetSystemComponent pu, Testable pu v x) =&gt;
Project pu v x -&gt; IO ()
</span><a href="NITTA.Project.html#writeTestBench"><span class="hs-identifier hs-var">writeTestBench</span></a></span><span> </span><span class="annot"><span class="annottext">Project m v x
</span><a href="#local-6989586621680033919"><span class="hs-identifier hs-var">prj</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="annottext">Project m v x -&gt; IO ()
forall pu v x.
(TargetSystemComponent pu, Testable pu v x) =&gt;
Project pu v x -&gt; IO ()
</span><a href="NITTA.Project.Template.html#writeRenderedTemplates"><span class="hs-identifier hs-var">writeRenderedTemplates</span></a></span><span> </span><span class="annot"><span class="annottext">Project m v x
</span><a href="#local-6989586621680033919"><span class="hs-identifier hs-var">prj</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">noticeM</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;NITTA&quot;</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;write target project to: \&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033917"><span class="hs-identifier hs-var">pTargetProjectPath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\&quot;...ok&quot;</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span id="writeTargetSystem"><span class="annot"><span class="annottext">writeTargetSystem :: Project pu v x -&gt; IO ()
</span><a href="NITTA.Project.html#writeTargetSystem"><span class="hs-identifier hs-var hs-var">writeTargetSystem</span></a></span></span><span> </span><span id="local-6989586621680033910"><span class="annot"><span class="annottext">prj :: Project pu v x
</span><a href="#local-6989586621680033910"><span class="hs-identifier hs-var">prj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Project.Types.html#Project"><span class="hs-identifier hs-type">Project</span></a></span><span class="hs-special">{</span><span id="local-6989586621680033909"><span class="annot"><span class="annottext">Text
pName :: forall m v x. Project m v x -&gt; Text
pName :: Text
</span><a href="NITTA.Project.Types.html#pName"><span class="hs-identifier hs-var hs-var">pName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033907"><span class="annot"><span class="annottext">FilePath
pTargetProjectPath :: FilePath
pTargetProjectPath :: forall m v x. Project m v x -&gt; FilePath
</span><a href="#local-6989586621680033907"><span class="hs-identifier hs-var hs-var">pTargetProjectPath</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033906"><span class="annot"><span class="annottext">FilePath
pInProjectNittaPath :: forall m v x. Project m v x -&gt; FilePath
pInProjectNittaPath :: FilePath
</span><a href="NITTA.Project.Types.html#pInProjectNittaPath"><span class="hs-identifier hs-var hs-var">pInProjectNittaPath</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033904"><span class="annot"><span class="annottext">pu
pUnit :: forall m v x. Project m v x -&gt; m
pUnit :: pu
</span><a href="NITTA.Project.Types.html#pUnit"><span class="hs-identifier hs-var hs-var">pUnit</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">createDirectoryIfMissing</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033907"><span class="hs-identifier hs-var">pTargetProjectPath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033906"><span class="hs-identifier hs-var">pInProjectNittaPath</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><span class="annottext">Project pu v x -&gt; Implementation -&gt; IO ()
forall m v x.
(TargetSystemComponent m, Testable m v x) =&gt;
Project m v x -&gt; Implementation -&gt; IO ()
</span><a href="NITTA.Project.html#writeImplementation"><span class="hs-identifier hs-var">writeImplementation</span></a></span><span> </span><span class="annot"><span class="annottext">Project pu v x
</span><a href="#local-6989586621680033910"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">(Implementation -&gt; IO ()) -&gt; Implementation -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; pu -&gt; Implementation
forall pu. TargetSystemComponent pu =&gt; Text -&gt; pu -&gt; Implementation
</span><a href="NITTA.Project.Types.html#hardware"><span class="hs-identifier hs-var">hardware</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033909"><span class="hs-identifier hs-var">pName</span></a></span><span> </span><span class="annot"><span class="annottext">pu
</span><a href="#local-6989586621680033904"><span class="hs-identifier hs-var">pUnit</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="annottext">Project pu v x -&gt; Implementation -&gt; IO ()
forall m v x.
(TargetSystemComponent m, Testable m v x) =&gt;
Project m v x -&gt; Implementation -&gt; IO ()
</span><a href="NITTA.Project.html#writeImplementation"><span class="hs-identifier hs-var">writeImplementation</span></a></span><span> </span><span class="annot"><span class="annottext">Project pu v x
</span><a href="#local-6989586621680033910"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">(Implementation -&gt; IO ()) -&gt; Implementation -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; pu -&gt; Implementation
forall pu. TargetSystemComponent pu =&gt; Text -&gt; pu -&gt; Implementation
</span><a href="NITTA.Project.Types.html#software"><span class="hs-identifier hs-var">software</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033909"><span class="hs-identifier hs-var">pName</span></a></span><span> </span><span class="annot"><span class="annottext">pu
</span><a href="#local-6989586621680033904"><span class="hs-identifier hs-var">pUnit</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><span class="annottext">Project pu v x -&gt; IO ()
forall pu v x. TargetSystemComponent pu =&gt; Project pu v x -&gt; IO ()
</span><a href="NITTA.Project.html#copyLibraryFiles"><span class="hs-identifier hs-var">copyLibraryFiles</span></a></span><span> </span><span class="annot"><span class="annottext">Project pu v x
</span><a href="#local-6989586621680033910"><span class="hs-identifier hs-var">prj</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span id="writeTestBench"><span class="annot"><span class="annottext">writeTestBench :: Project m v x -&gt; IO ()
</span><a href="NITTA.Project.html#writeTestBench"><span class="hs-identifier hs-var hs-var">writeTestBench</span></a></span></span><span> </span><span id="local-6989586621680033896"><span class="annot"><span class="annottext">prj :: Project m v x
</span><a href="#local-6989586621680033896"><span class="hs-identifier hs-var">prj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Project.Types.html#Project"><span class="hs-identifier hs-type">Project</span></a></span><span class="hs-special">{</span><span id="local-6989586621680033895"><span class="annot"><span class="annottext">FilePath
pTargetProjectPath :: FilePath
pTargetProjectPath :: forall m v x. Project m v x -&gt; FilePath
</span><a href="#local-6989586621680033895"><span class="hs-identifier hs-var hs-var">pTargetProjectPath</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033894"><span class="annot"><span class="annottext">FilePath
pInProjectNittaPath :: FilePath
pInProjectNittaPath :: forall m v x. Project m v x -&gt; FilePath
</span><a href="#local-6989586621680033894"><span class="hs-identifier hs-var hs-var">pInProjectNittaPath</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">createDirectoryIfMissing</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033895"><span class="hs-identifier hs-var">pTargetProjectPath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033894"><span class="hs-identifier hs-var">pInProjectNittaPath</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><span class="annottext">Project m v x -&gt; Implementation -&gt; IO ()
forall m v x.
(TargetSystemComponent m, Testable m v x) =&gt;
Project m v x -&gt; Implementation -&gt; IO ()
</span><a href="NITTA.Project.html#writeImplementation"><span class="hs-identifier hs-var">writeImplementation</span></a></span><span> </span><span class="annot"><span class="annottext">Project m v x
</span><a href="#local-6989586621680033896"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">(Implementation -&gt; IO ()) -&gt; Implementation -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Project m v x -&gt; Implementation
forall m v x. Testable m v x =&gt; Project m v x -&gt; Implementation
</span><a href="NITTA.Project.TestBench.html#testBenchImplementation"><span class="hs-identifier hs-var">testBenchImplementation</span></a></span><span> </span><span class="annot"><span class="annottext">Project m v x
</span><a href="#local-6989586621680033896"><span class="hs-identifier hs-var">prj</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span id="runTestbench"><span class="annot"><span class="annottext">runTestbench :: Project u v x -&gt; IO (TestbenchReport v x)
</span><a href="NITTA.Project.html#runTestbench"><span class="hs-identifier hs-var hs-var">runTestbench</span></a></span></span><span> </span><span id="local-6989586621680033892"><span class="annot"><span class="annottext">prj :: Project u v x
</span><a href="#local-6989586621680033892"><span class="hs-identifier hs-var">prj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Project.Types.html#Project"><span class="hs-identifier hs-type">Project</span></a></span><span class="hs-special">{</span><span id="local-6989586621680033891"><span class="annot"><span class="annottext">FilePath
pTargetProjectPath :: FilePath
pTargetProjectPath :: forall m v x. Project m v x -&gt; FilePath
</span><a href="#local-6989586621680033891"><span class="hs-identifier hs-var hs-var">pTargetProjectPath</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033890"><span class="annot"><span class="annottext">u
pUnit :: u
pUnit :: forall m v x. Project m v x -&gt; m
</span><a href="#local-6989586621680033890"><span class="hs-identifier hs-var hs-var">pUnit</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pTestCntx :: forall m v x. Project m v x -&gt; Cntx v x
</span><a href="NITTA.Project.Types.html#pTestCntx"><span class="hs-identifier hs-var">pTestCntx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Cntx"><span class="hs-identifier hs-type">Cntx</span></a></span><span class="hs-special">{</span><span id="local-6989586621680033887"><span class="annot"><span class="annottext">[CycleCntx v x]
cntxProcess :: forall v x. Cntx v x -&gt; [CycleCntx v x]
cntxProcess :: [CycleCntx v x]
</span><a href="NITTA.Intermediate.Types.html#cntxProcess"><span class="hs-identifier hs-var hs-var">cntxProcess</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033885"><span class="annot"><span class="annottext">Int
cntxCycleNumber :: forall v x. Cntx v x -&gt; Int
cntxCycleNumber :: Int
</span><a href="NITTA.Intermediate.Types.html#cntxCycleNumber"><span class="hs-identifier hs-var hs-var">cntxCycleNumber</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">infoM</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;NITTA&quot;</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;run logical synthesis(&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033891"><span class="hs-identifier hs-var">pTargetProjectPath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;)...&quot;</span></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680033883"><span class="annot"><span class="annottext">files :: [FilePath]
</span><a href="#local-6989586621680033883"><span class="hs-identifier hs-var hs-var">files</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Project u v x -&gt; [FilePath]
forall m v x.
(TargetSystemComponent m, Testable m v x) =&gt;
Project m v x -&gt; [FilePath]
</span><a href="NITTA.Project.TestBench.html#verilogProjectFiles"><span class="hs-identifier hs-var">verilogProjectFiles</span></a></span><span> </span><span class="annot"><span class="annottext">Project u v x
</span><a href="#local-6989586621680033892"><span class="hs-identifier hs-var">prj</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span id="local-6989586621680033881"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033881"><span class="hs-identifier hs-var">wd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><span class="hs-identifier hs-var">getCurrentDirectory</span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680033879"><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621680033879"><span class="hs-identifier hs-var">compileExitCode</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033878"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033878"><span class="hs-identifier hs-var">compileOut</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033877"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033877"><span class="hs-identifier hs-var">compileErr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-77"></span><span>        </span><span id="local-6989586621680033876"><span class="annot"><span class="annottext">Either IOException (ExitCode, Text, Text)
</span><a href="#local-6989586621680033876"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (ExitCode, Text, Text)
-&gt; IO (Either IOException (ExitCode, Text, Text))
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(IO (ExitCode, Text, Text)
 -&gt; IO (Either IOException (ExitCode, Text, Text)))
-&gt; IO (ExitCode, Text, Text)
-&gt; IO (Either IOException (ExitCode, Text, Text))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CreateProcess -&gt; Text -&gt; IO (ExitCode, Text, Text)
</span><span class="hs-identifier hs-var">readCreateProcessWithExitCode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; CreateProcess
</span><a href="#local-6989586621680033873"><span class="hs-identifier hs-var">createIVerilogProcess</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033891"><span class="hs-identifier hs-var">pTargetProjectPath</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621680033883"><span class="hs-identifier hs-var">files</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-78"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either IOException (ExitCode, Text, Text)
</span><a href="#local-6989586621680033876"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-79"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOException</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-80"></span><span>                </span><span class="annot"><span class="annottext">FilePath -&gt; IO (ExitCode, Text, Text)
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span>
</span><span id="line-81"></span><span>                    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="">[__i|iverilog is not available on your system
                           try to install it:
                                MacOS: $ brew install icarus-verilog
                                Ubuntu: $ sudo apt-get install iverilog 
                        |]</span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-86"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-87"></span><span>                    </span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621680033866"><span class="annot"><span class="annottext">(ExitCode, Text, Text)
</span><a href="#local-6989586621680033866"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ExitCode, Text, Text) -&gt; IO (ExitCode, Text, Text)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ExitCode, Text, Text)
</span><a href="#local-6989586621680033866"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680033865"><span class="annot"><span class="annottext">isCompileOk :: Bool
</span><a href="#local-6989586621680033865"><span class="hs-identifier hs-var hs-var">isCompileOk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621680033879"><span class="hs-identifier hs-var">compileExitCode</span></a></span><span> </span><span class="annot"><span class="annottext">ExitCode -&gt; ExitCode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ExitCode
</span><span class="hs-identifier hs-var">ExitSuccess</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033877"><span class="hs-identifier hs-var">compileErr</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680033861"><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621680033861"><span class="hs-identifier hs-var">simExitCode</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033860"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033860"><span class="hs-identifier hs-var">simOut</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033859"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033859"><span class="hs-identifier hs-var">simErr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-93"></span><span>        </span><span class="annot"><span class="annottext">CreateProcess -&gt; Text -&gt; IO (ExitCode, Text, Text)
</span><span class="hs-identifier hs-var">readCreateProcessWithExitCode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; CreateProcess
</span><span class="hs-identifier hs-var">proc</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;vvp&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;a.out&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">{</span><span class="annot"><span class="annottext">cwd :: Maybe FilePath
</span><span class="hs-identifier hs-var">cwd</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033891"><span class="hs-identifier hs-var">pTargetProjectPath</span></a></span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680033857"><span class="annot"><span class="annottext">isSimOk :: Bool
</span><a href="#local-6989586621680033857"><span class="hs-identifier hs-var hs-var">isSimOk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621680033861"><span class="hs-identifier hs-var">simExitCode</span></a></span><span> </span><span class="annot"><span class="annottext">ExitCode -&gt; ExitCode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ExitCode
</span><span class="hs-identifier hs-var">ExitSuccess</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;FAIL&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isInfixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033860"><span class="hs-identifier hs-var">simOut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680033854"><span class="annot"><span class="annottext">tbStatus :: Bool
</span><a href="#local-6989586621680033854"><span class="hs-identifier hs-var hs-var">tbStatus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680033865"><span class="hs-identifier hs-var">isCompileOk</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680033857"><span class="hs-identifier hs-var">isSimOk</span></a></span><span>
</span><span id="line-97"></span><span>        </span><span id="local-6989586621680033853"><span class="annot"><span class="annottext">tbCompilerDump :: Text
</span><a href="#local-6989586621680033853"><span class="hs-identifier hs-var hs-var">tbCompilerDump</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall p. (Eq p, IsString p, Semigroup p) =&gt; p -&gt; p -&gt; p
</span><a href="#local-6989586621680033852"><span class="hs-identifier hs-var">dump</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033878"><span class="hs-identifier hs-var">compileOut</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033877"><span class="hs-identifier hs-var">compileErr</span></a></span><span>
</span><span id="line-98"></span><span>        </span><span id="local-6989586621680033851"><span class="annot"><span class="annottext">tbSimulationDump :: Text
</span><a href="#local-6989586621680033851"><span class="hs-identifier hs-var hs-var">tbSimulationDump</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall p. (Eq p, IsString p, Semigroup p) =&gt; p -&gt; p -&gt; p
</span><a href="#local-6989586621680033852"><span class="hs-identifier hs-var">dump</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033860"><span class="hs-identifier hs-var">simOut</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033859"><span class="hs-identifier hs-var">simErr</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680033854"><span class="hs-identifier hs-var">tbStatus</span></a></span><span>
</span><span id="line-101"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">noticeM</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;NITTA&quot;</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;run testbench (&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033891"><span class="hs-identifier hs-var">pTargetProjectPath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;)...ok&quot;</span></span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-103"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">noticeM</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;NITTA&quot;</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;run testbench (&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033891"><span class="hs-identifier hs-var">pTargetProjectPath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;)...fail&quot;</span></span><span>
</span><span id="line-104"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">noticeM</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;NITTA&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-----------------------------------------------------------&quot;</span></span><span>
</span><span id="line-105"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">noticeM</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;NITTA&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;testbench compiler dump:&quot;</span></span><span>
</span><span id="line-106"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">noticeM</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;NITTA&quot;</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033853"><span class="hs-identifier hs-var">tbCompilerDump</span></a></span><span>
</span><span id="line-107"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">noticeM</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;NITTA&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-----------------------------------------------------------&quot;</span></span><span>
</span><span id="line-108"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">noticeM</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;NITTA&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;testbench simulation dump:&quot;</span></span><span>
</span><span id="line-109"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">noticeM</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;NITTA&quot;</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033851"><span class="hs-identifier hs-var">tbSimulationDump</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><span class="annottext">TestbenchReport v x -&gt; IO (TestbenchReport v x)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-111"></span><span>        </span><span class="annot"><span class="annottext">TestbenchReport :: forall v x.
Bool
-&gt; FilePath
-&gt; [FilePath]
-&gt; [Text]
-&gt; [Text]
-&gt; Text
-&gt; Text
-&gt; [HashMap v x]
-&gt; [HashMap v x]
-&gt; TestbenchReport v x
</span><a href="NITTA.Project.TestBench.html#TestbenchReport"><span class="hs-identifier hs-type">TestbenchReport</span></a></span><span>
</span><span id="line-112"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool
tbStatus :: Bool
tbStatus :: Bool
</span><a href="NITTA.Project.TestBench.html#tbStatus"><span class="hs-identifier hs-var hs-var">tbStatus</span></a></span><span>
</span><span id="line-113"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tbPath :: FilePath
</span><a href="NITTA.Project.TestBench.html#tbPath"><span class="hs-identifier hs-var">tbPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath
</span><span class="hs-identifier hs-var">joinPath</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033881"><span class="hs-identifier hs-var">wd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033891"><span class="hs-identifier hs-var">pTargetProjectPath</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-114"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tbFiles :: [FilePath]
</span><a href="NITTA.Project.TestBench.html#tbFiles"><span class="hs-identifier hs-var">tbFiles</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621680033883"><span class="hs-identifier hs-var">files</span></a></span><span>
</span><span id="line-115"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tbFunctions :: [Text]
</span><a href="NITTA.Project.TestBench.html#tbFunctions"><span class="hs-identifier hs-var">tbFunctions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Text) -&gt; [a] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="NITTA.Utils.Base.html#showText"><span class="hs-identifier hs-var">showText</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [Text]) -&gt; [a] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">u -&gt; [a]
forall a f. WithFunctions a f =&gt; a -&gt; [f]
</span><a href="NITTA.Intermediate.Types.html#functions"><span class="hs-identifier hs-var">functions</span></a></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621680033890"><span class="hs-identifier hs-var">pUnit</span></a></span><span>
</span><span id="line-116"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tbSynthesisSteps :: [Text]
</span><a href="NITTA.Project.TestBench.html#tbSynthesisSteps"><span class="hs-identifier hs-var">tbSynthesisSteps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Step t (StepInfo v x t) -&gt; Text)
-&gt; [Step t (StepInfo v x t)] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Step t (StepInfo v x t) -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="NITTA.Utils.Base.html#showText"><span class="hs-identifier hs-var">showText</span></a></span><span> </span><span class="annot"><span class="annottext">([Step t (StepInfo v x t)] -&gt; [Text])
-&gt; [Step t (StepInfo v x t)] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Process t (StepInfo v x t) -&gt; [Step t (StepInfo v x t)]
forall t i. Process t i -&gt; [Step t i]
</span><a href="NITTA.Model.ProcessorUnits.Types.html#steps"><span class="hs-identifier hs-var hs-var">steps</span></a></span><span> </span><span class="annot"><span class="annottext">(Process t (StepInfo v x t) -&gt; [Step t (StepInfo v x t)])
-&gt; Process t (StepInfo v x t) -&gt; [Step t (StepInfo v x t)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">u -&gt; Process t (StepInfo v x t)
forall u v x t.
ProcessorUnit u v x t =&gt;
u -&gt; Process t (StepInfo v x t)
</span><a href="NITTA.Model.ProcessorUnits.Types.html#process"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621680033890"><span class="hs-identifier hs-var">pUnit</span></a></span><span>
</span><span id="line-117"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
tbCompilerDump :: Text
tbCompilerDump :: Text
</span><a href="NITTA.Project.TestBench.html#tbCompilerDump"><span class="hs-identifier hs-var hs-var">tbCompilerDump</span></a></span><span>
</span><span id="line-118"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
tbSimulationDump :: Text
tbSimulationDump :: Text
</span><a href="NITTA.Project.TestBench.html#tbSimulationDump"><span class="hs-identifier hs-var hs-var">tbSimulationDump</span></a></span><span>
</span><span id="line-119"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tbFunctionalSimulationLog :: [HashMap v x]
</span><a href="NITTA.Project.TestBench.html#tbFunctionalSimulationLog"><span class="hs-identifier hs-var">tbFunctionalSimulationLog</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CycleCntx v x -&gt; HashMap v x) -&gt; [CycleCntx v x] -&gt; [HashMap v x]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CycleCntx v x -&gt; HashMap v x
forall v x. CycleCntx v x -&gt; HashMap v x
</span><a href="NITTA.Intermediate.Types.html#cycleCntx"><span class="hs-identifier hs-var hs-var">cycleCntx</span></a></span><span> </span><span class="annot"><span class="annottext">([CycleCntx v x] -&gt; [HashMap v x])
-&gt; [CycleCntx v x] -&gt; [HashMap v x]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [CycleCntx v x] -&gt; [CycleCntx v x]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680033885"><span class="hs-identifier hs-var">cntxCycleNumber</span></a></span><span> </span><span class="annot"><span class="annottext">[CycleCntx v x]
</span><a href="#local-6989586621680033887"><span class="hs-identifier hs-var">cntxProcess</span></a></span><span>
</span><span id="line-120"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tbLogicalSimulationLog :: [HashMap v x]
</span><a href="NITTA.Project.TestBench.html#tbLogicalSimulationLog"><span class="hs-identifier hs-var">tbLogicalSimulationLog</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int, v, x)] -&gt; [HashMap v x]
forall b c. (Eq b, Hashable b) =&gt; [(Int, b, c)] -&gt; [HashMap b c]
</span><a href="NITTA.Project.html#log2hms"><span class="hs-identifier hs-var">log2hms</span></a></span><span> </span><span class="annot"><span class="annottext">([(Int, v, x)] -&gt; [HashMap v x]) -&gt; [(Int, v, x)] -&gt; [HashMap v x]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">x -&gt; FilePath -&gt; [(Int, v, x)]
forall b a c x.
(IsString b, Read a, Read c, Val x) =&gt;
x -&gt; FilePath -&gt; [(a, b, c)]
</span><a href="NITTA.Project.html#extractLogValues"><span class="hs-identifier hs-var">extractLogValues</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">u -&gt; x
forall u x. DefaultX u x =&gt; u -&gt; x
</span><a href="NITTA.Intermediate.Value.html#defX"><span class="hs-identifier hs-var">defX</span></a></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621680033890"><span class="hs-identifier hs-var">pUnit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; [(Int, v, x)]) -&gt; FilePath -&gt; [(Int, v, x)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033860"><span class="hs-identifier hs-var">simOut</span></a></span><span>
</span><span id="line-121"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-123"></span><span>        </span><span id="local-6989586621680033873"><span class="annot"><span class="annottext">createIVerilogProcess :: FilePath -&gt; [FilePath] -&gt; CreateProcess
</span><a href="#local-6989586621680033873"><span class="hs-identifier hs-var hs-var">createIVerilogProcess</span></a></span></span><span> </span><span id="local-6989586621680033829"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033829"><span class="hs-identifier hs-var">workdir</span></a></span></span><span> </span><span id="local-6989586621680033828"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621680033828"><span class="hs-identifier hs-var">files</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; CreateProcess
</span><span class="hs-identifier hs-var">proc</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;iverilog&quot;</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621680033828"><span class="hs-identifier hs-var">files</span></a></span><span class="hs-special">)</span><span class="hs-special">{</span><span class="annot"><span class="annottext">cwd :: Maybe FilePath
</span><span class="hs-identifier hs-var">cwd</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033829"><span class="hs-identifier hs-var">workdir</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-124"></span><span>        </span><span id="local-6989586621680033852"><span class="annot"><span class="annottext">dump :: p -&gt; p -&gt; p
</span><a href="#local-6989586621680033852"><span class="hs-identifier hs-var hs-var">dump</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><a href="#local-6989586621680033852"><span class="hs-identifier hs-var">dump</span></a></span><span> </span><span id="local-6989586621680033827"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680033827"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span id="local-6989586621680033826"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680033826"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-string">&quot;stdout:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">p -&gt; p -&gt; p
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680033827"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; p -&gt; p
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-string">&quot;stderr:\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">p -&gt; p -&gt; p
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680033826"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span id="extractLogValues"><span class="annot"><span class="annottext">extractLogValues :: x -&gt; FilePath -&gt; [(a, b, c)]
</span><a href="NITTA.Project.html#extractLogValues"><span class="hs-identifier hs-var hs-var">extractLogValues</span></a></span></span><span> </span><span id="local-6989586621680033825"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680033825"><span class="hs-identifier hs-var">x0</span></a></span></span><span> </span><span id="local-6989586621680033824"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033824"><span class="hs-identifier hs-var">text</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Maybe (a, b, c)) -&gt; [FilePath] -&gt; [(a, b, c)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe (a, b, c)
forall a b a c.
(ToString a, IsString b, Read a, Read c) =&gt;
a -&gt; Maybe (a, b, c)
</span><a href="#local-6989586621680033822"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">([FilePath] -&gt; [(a, b, c)]) -&gt; [FilePath] -&gt; [(a, b, c)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath]
</span><span class="hs-identifier hs-var">lines</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033824"><span class="hs-identifier hs-var">text</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>        </span><span id="local-6989586621680033822"><span class="annot"><span class="annottext">f :: a -&gt; Maybe (a, b, c)
</span><a href="#local-6989586621680033822"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680033820"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680033820"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Regex -&gt; FilePath -&gt; Maybe [FilePath]
</span><span class="hs-identifier hs-var">matchRegex</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; Regex
forall x. Val x =&gt; x -&gt; Regex
</span><a href="NITTA.Intermediate.Value.html#verilogAssertRE"><span class="hs-identifier hs-var">verilogAssertRE</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680033825"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Maybe [FilePath]) -&gt; FilePath -&gt; Maybe [FilePath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; FilePath
forall a. ToString a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">toString</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680033820"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-130"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621680033816"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033816"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033815"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033815"><span class="hs-identifier hs-var">_t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033814"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033814"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033813"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033813"><span class="hs-identifier hs-var">_e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033812"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033812"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, c) -&gt; Maybe (a, b, c)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; a
forall a. Read a =&gt; FilePath -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033816"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; b
forall a. IsString a =&gt; FilePath -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; b) -&gt; FilePath -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
forall a. ToString a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">toString</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033812"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; c
forall a. Read a =&gt; FilePath -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033814"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>            </span><span class="annot"><span class="annottext">Maybe [FilePath]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (a, b, c)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span id="log2hms"><span class="annot"><span class="annottext">log2hms :: [(Int, b, c)] -&gt; [HashMap b c]
</span><a href="NITTA.Project.html#log2hms"><span class="hs-identifier hs-var hs-var">log2hms</span></a></span></span><span> </span><span id="local-6989586621680033810"><span class="annot"><span class="annottext">[(Int, b, c)]
</span><a href="#local-6989586621680033810"><span class="hs-identifier hs-var">lst0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HashMap b c]
</span><a href="#local-6989586621680033809"><span class="hs-identifier hs-var">cntxProcess</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>        </span><span id="local-6989586621680033809"><span class="annot"><span class="annottext">cntxProcess :: [HashMap b c]
</span><a href="#local-6989586621680033809"><span class="hs-identifier hs-var hs-var">cntxProcess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(Int, b, c)] -&gt; [HashMap b c]
forall t b c.
(Eq t, Num t, Eq b, Hashable b) =&gt;
t -&gt; [(t, b, c)] -&gt; [HashMap b c]
</span><a href="#local-6989586621680033808"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, b, c)]
</span><a href="#local-6989586621680033810"><span class="hs-identifier hs-var">lst0</span></a></span><span>
</span><span id="line-136"></span><span>        </span><span id="local-6989586621680033808"><span class="annot"><span class="annottext">inner :: t -&gt; [(t, b, c)] -&gt; [HashMap b c]
</span><a href="#local-6989586621680033808"><span class="hs-identifier hs-var hs-var">inner</span></a></span></span><span> </span><span id="local-6989586621680033807"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680033807"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680033806"><span class="annot"><span class="annottext">[(t, b, c)]
</span><a href="#local-6989586621680033806"><span class="hs-identifier hs-var">lst</span></a></span></span><span>
</span><span id="line-137"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680033805"><span class="annot"><span class="annottext">[(t, b, c)]
</span><a href="#local-6989586621680033805"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033804"><span class="annot"><span class="annottext">[(t, b, c)]
</span><a href="#local-6989586621680033804"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((t, b, c) -&gt; Bool) -&gt; [(t, b, c)] -&gt; ([(t, b, c)], [(t, b, c)])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">L.partition</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680033802"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680033802"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033801"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680033801"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033800"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680033800"><span class="hs-identifier hs-var">_x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680033802"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680033807"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(t, b, c)]
</span><a href="#local-6989586621680033806"><span class="hs-identifier hs-var">lst</span></a></span><span>
</span><span id="line-138"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(t, b, c)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(t, b, c)]
</span><a href="#local-6989586621680033805"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-139"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680033798"><span class="annot"><span class="annottext">cycleCntx :: HashMap b c
</span><a href="#local-6989586621680033798"><span class="hs-identifier hs-var hs-var">cycleCntx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(b, c)] -&gt; HashMap b c
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HM.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(b, c)] -&gt; HashMap b c) -&gt; [(b, c)] -&gt; HashMap b c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((t, b, c) -&gt; (b, c)) -&gt; [(t, b, c)] -&gt; [(b, c)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680033796"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680033796"><span class="hs-identifier hs-var">_c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033795"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680033795"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033794"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680033794"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680033795"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680033794"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(t, b, c)]
</span><a href="#local-6989586621680033805"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-140"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">HashMap b c
</span><a href="#local-6989586621680033798"><span class="hs-identifier hs-var">cycleCntx</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap b c -&gt; [HashMap b c] -&gt; [HashMap b c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; [(t, b, c)] -&gt; [HashMap b c]
</span><a href="#local-6989586621680033808"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680033807"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(t, b, c)]
</span><a href="#local-6989586621680033804"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-141"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">-- |Ginger is powerfull but slow down testing two times.</span><span>
</span><span id="line-144"></span><span id="enableGingerForImplementation"><span class="annot"><span class="annottext">enableGingerForImplementation :: Bool
</span><a href="NITTA.Project.html#enableGingerForImplementation"><span class="hs-identifier hs-var hs-var">enableGingerForImplementation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- |Write 'Implementation' to the file system.</span><span>
</span><span id="line-147"></span><span id="writeImplementation"><span class="annot"><span class="annottext">writeImplementation :: Project m v x -&gt; Implementation -&gt; IO ()
</span><a href="NITTA.Project.html#writeImplementation"><span class="hs-identifier hs-var hs-var">writeImplementation</span></a></span></span><span> </span><span id="local-6989586621680033791"><span class="annot"><span class="annottext">prj :: Project m v x
</span><a href="#local-6989586621680033791"><span class="hs-identifier hs-var">prj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Project.Types.html#Project"><span class="hs-identifier hs-type">Project</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">pTargetProjectPath :: forall m v x. Project m v x -&gt; FilePath
</span><a href="NITTA.Project.Types.html#pTargetProjectPath"><span class="hs-identifier hs-var">pTargetProjectPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680033790"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033790"><span class="hs-identifier hs-var">prjPath</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pInProjectNittaPath :: forall m v x. Project m v x -&gt; FilePath
</span><a href="NITTA.Project.Types.html#pInProjectNittaPath"><span class="hs-identifier hs-var">pInProjectNittaPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680033789"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033789"><span class="hs-identifier hs-var">nittaPath</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680033788"><span class="annot"><span class="annottext">Implementation
</span><a href="#local-6989586621680033788"><span class="hs-identifier hs-var">impl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Implementation -&gt; IO ()
</span><a href="#local-6989586621680033787"><span class="hs-identifier hs-var">writeImpl</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033789"><span class="hs-identifier hs-var">nittaPath</span></a></span><span> </span><span class="annot"><span class="annottext">Implementation
</span><a href="#local-6989586621680033788"><span class="hs-identifier hs-var">impl</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>        </span><span id="local-6989586621680033787"><span class="annot"><span class="annottext">writeImpl :: FilePath -&gt; Implementation -&gt; IO ()
</span><a href="#local-6989586621680033787"><span class="hs-identifier hs-var hs-var">writeImpl</span></a></span></span><span> </span><span id="local-6989586621680033786"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033786"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Project.Types.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span id="local-6989586621680033784"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033784"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680033783"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033783"><span class="hs-identifier hs-var">src0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="NITTA.Project.html#enableGingerForImplementation"><span class="hs-identifier hs-var">enableGingerForImplementation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-150"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680033782"><span class="annot"><span class="annottext">src :: FilePath
</span><a href="#local-6989586621680033782"><span class="hs-identifier hs-var hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033783"><span class="hs-identifier hs-var">src0</span></a></span><span>
</span><span id="line-151"></span><span>                </span><span id="local-6989586621680033781"><span class="annot"><span class="annottext">implCtx :: GingerContext SourcePos (Writer Text) Text
</span><a href="#local-6989586621680033781"><span class="hs-identifier hs-var hs-var">implCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Project m v x
-&gt; FilePath -&gt; GingerContext SourcePos (Writer Text) Text
forall m v x p a.
(TargetSystemComponent m, Testable m v x,
 ToGVal (Run p (Writer Text) Text) a) =&gt;
Project m v x -&gt; a -&gt; GingerContext p (Writer Text) Text
</span><a href="NITTA.Project.Context.html#implementationContext"><span class="hs-identifier hs-var">implementationContext</span></a></span><span> </span><span class="annot"><span class="annottext">Project m v x
</span><a href="#local-6989586621680033791"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033786"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-152"></span><span>            </span><span id="local-6989586621680033779"><span class="annot"><span class="annottext">Template SourcePos
</span><a href="#local-6989586621680033779"><span class="hs-identifier hs-var">template</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-153"></span><span>                </span><span class="annot"><span class="annottext">(ParserError -&gt; IO (Template SourcePos))
-&gt; (Template SourcePos -&gt; IO (Template SourcePos))
-&gt; Either ParserError (Template SourcePos)
-&gt; IO (Template SourcePos)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO (Template SourcePos)
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO (Template SourcePos))
-&gt; (ParserError -&gt; FilePath)
-&gt; ParserError
-&gt; IO (Template SourcePos)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; ParserError -&gt; FilePath
</span><span class="hs-identifier hs-var">formatParserError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033782"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Template SourcePos -&gt; IO (Template SourcePos)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either ParserError (Template SourcePos)
 -&gt; IO (Template SourcePos))
-&gt; (Identity (Either ParserError (Template SourcePos))
    -&gt; Either ParserError (Template SourcePos))
-&gt; Identity (Either ParserError (Template SourcePos))
-&gt; IO (Template SourcePos)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Identity (Either ParserError (Template SourcePos))
-&gt; Either ParserError (Template SourcePos)
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity (Either ParserError (Template SourcePos))
 -&gt; IO (Template SourcePos))
-&gt; Identity (Either ParserError (Template SourcePos))
-&gt; IO (Template SourcePos)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-154"></span><span>                    </span><span class="annot"><span class="annottext">IncludeResolver Identity
-&gt; Maybe FilePath
-&gt; FilePath
-&gt; Identity (Either ParserError (Template SourcePos))
forall (m :: * -&gt; *).
Monad m =&gt;
IncludeResolver m
-&gt; Maybe FilePath
-&gt; FilePath
-&gt; m (Either ParserError (Template SourcePos))
</span><span class="hs-identifier hs-var">parseGinger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Identity (Maybe FilePath) -&gt; IncludeResolver Identity
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(Identity (Maybe FilePath) -&gt; IncludeResolver Identity)
-&gt; Identity (Maybe FilePath) -&gt; IncludeResolver Identity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; Identity (Maybe FilePath)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033782"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-155"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; Text -&gt; IO ()
</span><span class="hs-identifier hs-var">T.writeFile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath
</span><span class="hs-identifier hs-var">joinPath</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033790"><span class="hs-identifier hs-var">prjPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033786"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033784"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO ()) -&gt; Text -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GingerContext SourcePos (Writer Text) Text
-&gt; Template SourcePos -&gt; Text
forall p h.
(ToGVal (Run p (Writer h) h) h, ToGVal (Run p (Writer h) h) p,
 Monoid h) =&gt;
GingerContext p (Writer h) h -&gt; Template p -&gt; h
</span><span class="hs-identifier hs-var">runGinger</span></span><span> </span><span class="annot"><span class="annottext">GingerContext SourcePos (Writer Text) Text
</span><a href="#local-6989586621680033781"><span class="hs-identifier hs-var">implCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Template SourcePos
</span><a href="#local-6989586621680033779"><span class="hs-identifier hs-var">template</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><a href="#local-6989586621680033787"><span class="hs-identifier hs-var">writeImpl</span></a></span><span> </span><span id="local-6989586621680033770"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033770"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Project.Types.html#Immediate"><span class="hs-identifier hs-type">Immediate</span></a></span><span> </span><span id="local-6989586621680033769"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033769"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680033768"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033768"><span class="hs-identifier hs-var">src0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-157"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; Text -&gt; IO ()
</span><span class="hs-identifier hs-var">T.writeFile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath
</span><span class="hs-identifier hs-var">joinPath</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033790"><span class="hs-identifier hs-var">prjPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033770"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033769"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO ()) -&gt; Text -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.replace</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;{{ nitta.paths.nest }}&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033770"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033768"><span class="hs-identifier hs-var">src0</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><a href="#local-6989586621680033787"><span class="hs-identifier hs-var">writeImpl</span></a></span><span> </span><span id="local-6989586621680033765"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033765"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Project.Types.html#Aggregate"><span class="hs-identifier hs-type">Aggregate</span></a></span><span> </span><span id="local-6989586621680033763"><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621680033763"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span id="local-6989586621680033762"><span class="annot"><span class="annottext">[Implementation]
</span><a href="#local-6989586621680033762"><span class="hs-identifier hs-var">subInstances</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-159"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680033761"><span class="annot"><span class="annottext">path :: FilePath
</span><a href="#local-6989586621680033761"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath
</span><span class="hs-identifier hs-var">joinPath</span></span><span> </span><span class="annot"><span class="annottext">([FilePath] -&gt; FilePath) -&gt; [FilePath] -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
-&gt; (FilePath -&gt; [FilePath]) -&gt; Maybe FilePath -&gt; [FilePath]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033765"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680033759"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033759"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033765"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033759"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621680033763"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-160"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">createDirectoryIfMissing</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath
</span><span class="hs-identifier hs-var">joinPath</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033790"><span class="hs-identifier hs-var">prjPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033761"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-161"></span><span>            </span><span class="annot"><span class="annottext">(Implementation -&gt; IO ()) -&gt; [Implementation] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Implementation -&gt; IO ()
</span><a href="#local-6989586621680033787"><span class="hs-identifier hs-var">writeImpl</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033761"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Implementation]
</span><a href="#local-6989586621680033762"><span class="hs-identifier hs-var">subInstances</span></a></span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><a href="#local-6989586621680033787"><span class="hs-identifier hs-var">writeImpl</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Project.Types.html#FromLibrary"><span class="hs-identifier hs-type">FromLibrary</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><a href="#local-6989586621680033787"><span class="hs-identifier hs-var">writeImpl</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Implementation
</span><a href="NITTA.Project.Types.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- |Copy library files to target path.</span><span>
</span><span id="line-166"></span><span id="copyLibraryFiles"><span class="annot"><span class="annottext">copyLibraryFiles :: Project pu v x -&gt; IO ()
</span><a href="NITTA.Project.html#copyLibraryFiles"><span class="hs-identifier hs-var hs-var">copyLibraryFiles</span></a></span></span><span> </span><span id="local-6989586621680033755"><span class="annot"><span class="annottext">Project pu v x
</span><a href="#local-6989586621680033755"><span class="hs-identifier hs-var">prj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; [FilePath] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Project pu v x -&gt; FilePath -&gt; IO ()
forall m v x. Project m v x -&gt; FilePath -&gt; IO ()
</span><a href="#local-6989586621680033754"><span class="hs-identifier hs-var">copyLibraryFile</span></a></span><span> </span><span class="annot"><span class="annottext">Project pu v x
</span><a href="#local-6989586621680033755"><span class="hs-identifier hs-var">prj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([FilePath] -&gt; IO ()) -&gt; [FilePath] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Project pu v x -&gt; [FilePath]
forall pu v x.
TargetSystemComponent pu =&gt;
Project pu v x -&gt; [FilePath]
</span><a href="#local-6989586621680033753"><span class="hs-identifier hs-var">libraryFiles</span></a></span><span> </span><span class="annot"><span class="annottext">Project pu v x
</span><a href="#local-6989586621680033755"><span class="hs-identifier hs-var">prj</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>        </span><span id="local-6989586621680033754"><span class="annot"><span class="annottext">copyLibraryFile :: Project m v x -&gt; FilePath -&gt; IO ()
</span><a href="#local-6989586621680033754"><span class="hs-identifier hs-var hs-var">copyLibraryFile</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Project.Types.html#Project"><span class="hs-identifier hs-type">Project</span></a></span><span class="hs-special">{</span><span id="local-6989586621680033752"><span class="annot"><span class="annottext">FilePath
pTargetProjectPath :: FilePath
pTargetProjectPath :: forall m v x. Project m v x -&gt; FilePath
</span><a href="#local-6989586621680033752"><span class="hs-identifier hs-var hs-var">pTargetProjectPath</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033751"><span class="annot"><span class="annottext">FilePath
pInProjectNittaPath :: FilePath
pInProjectNittaPath :: forall m v x. Project m v x -&gt; FilePath
</span><a href="#local-6989586621680033751"><span class="hs-identifier hs-var hs-var">pInProjectNittaPath</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033750"><span class="annot"><span class="annottext">FilePath
pLibPath :: forall m v x. Project m v x -&gt; FilePath
pLibPath :: FilePath
</span><a href="NITTA.Project.Types.html#pLibPath"><span class="hs-identifier hs-var hs-var">pLibPath</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680033748"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033748"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680033747"><span class="annot"><span class="annottext">fullNittaPath :: FilePath
</span><a href="#local-6989586621680033747"><span class="hs-identifier hs-var hs-var">fullNittaPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033752"><span class="hs-identifier hs-var">pTargetProjectPath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033751"><span class="hs-identifier hs-var">pInProjectNittaPath</span></a></span><span>
</span><span id="line-170"></span><span>            </span><span id="local-6989586621680033746"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033746"><span class="hs-identifier hs-var">source</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">makeAbsolute</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO FilePath) -&gt; FilePath -&gt; IO FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath
</span><span class="hs-identifier hs-var">joinPath</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033750"><span class="hs-identifier hs-var">pLibPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033748"><span class="hs-identifier hs-var">file</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-171"></span><span>            </span><span id="local-6989586621680033744"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033744"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">makeAbsolute</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO FilePath) -&gt; FilePath -&gt; IO FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath
</span><span class="hs-identifier hs-var">joinPath</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033747"><span class="hs-identifier hs-var">fullNittaPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;lib&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033748"><span class="hs-identifier hs-var">file</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-172"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">createDirectoryIfMissing</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var">takeDirectory</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033744"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-173"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">copyFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033746"><span class="hs-identifier hs-var">source</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033744"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>        </span><span id="local-6989586621680033753"><span class="annot"><span class="annottext">libraryFiles :: Project pu v x -&gt; [FilePath]
</span><a href="#local-6989586621680033753"><span class="hs-identifier hs-var hs-var">libraryFiles</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Project.Types.html#Project"><span class="hs-identifier hs-type">Project</span></a></span><span class="hs-special">{</span><span id="local-6989586621680033741"><span class="annot"><span class="annottext">Text
pName :: Text
pName :: forall m v x. Project m v x -&gt; Text
</span><a href="#local-6989586621680033741"><span class="hs-identifier hs-var hs-var">pName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680033740"><span class="annot"><span class="annottext">pu
pUnit :: pu
pUnit :: forall m v x. Project m v x -&gt; m
</span><a href="#local-6989586621680033740"><span class="hs-identifier hs-var hs-var">pUnit</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-176"></span><span>            </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">L.nub</span></span><span> </span><span class="annot"><span class="annottext">([FilePath] -&gt; [FilePath]) -&gt; [FilePath] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Implementation -&gt; [FilePath]) -&gt; [Implementation] -&gt; [FilePath]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Implementation -&gt; [FilePath]
</span><a href="#local-6989586621680033737"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; pu -&gt; Implementation
forall pu. TargetSystemComponent pu =&gt; Text -&gt; pu -&gt; Implementation
</span><a href="NITTA.Project.Types.html#hardware"><span class="hs-identifier hs-var">hardware</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680033741"><span class="hs-identifier hs-var">pName</span></a></span><span> </span><span class="annot"><span class="annottext">pu
</span><a href="#local-6989586621680033740"><span class="hs-identifier hs-var">pUnit</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-177"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>                </span><span id="local-6989586621680033737"><span class="annot"><span class="annottext">args :: FilePath -&gt; Implementation -&gt; [FilePath]
</span><a href="#local-6989586621680033737"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680033736"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033736"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Project.Types.html#Aggregate"><span class="hs-identifier hs-type">Aggregate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680033735"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033735"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680033734"><span class="annot"><span class="annottext">[Implementation]
</span><a href="#local-6989586621680033734"><span class="hs-identifier hs-var">subInstances</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Implementation -&gt; [FilePath]) -&gt; [Implementation] -&gt; [FilePath]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Implementation -&gt; [FilePath]
</span><a href="#local-6989586621680033737"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Implementation -&gt; [FilePath])
-&gt; FilePath -&gt; Implementation -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath
</span><span class="hs-identifier hs-var">joinPath</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033736"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033735"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Implementation]
</span><a href="#local-6989586621680033734"><span class="hs-identifier hs-var">subInstances</span></a></span><span>
</span><span id="line-179"></span><span>                </span><span class="annot"><a href="#local-6989586621680033737"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span id="local-6989586621680033733"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033733"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Project.Types.html#Aggregate"><span class="hs-identifier hs-type">Aggregate</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621680033732"><span class="annot"><span class="annottext">[Implementation]
</span><a href="#local-6989586621680033732"><span class="hs-identifier hs-var">subInstances</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Implementation -&gt; [FilePath]) -&gt; [Implementation] -&gt; [FilePath]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Implementation -&gt; [FilePath]
</span><a href="#local-6989586621680033737"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033733"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Implementation]
</span><a href="#local-6989586621680033732"><span class="hs-identifier hs-var">subInstances</span></a></span><span>
</span><span id="line-180"></span><span>                </span><span class="annot"><a href="#local-6989586621680033737"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Project.Types.html#FromLibrary"><span class="hs-identifier hs-type">FromLibrary</span></a></span><span> </span><span id="local-6989586621680033731"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033731"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680033731"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span>                </span><span class="annot"><a href="#local-6989586621680033737"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Implementation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-182"></span></pre></body></html>