<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE NoMonomorphismRestriction #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">{- |
Module      : NITTA.Synthesis.Explore
Description : Explore synthesis tree
Copyright   : (c) Aleksandr Penskoi, 2021
License     : BSD3
Maintainer  : aleksandr.penskoi@gmail.com
Stability   : experimental
-}</span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">NITTA.Synthesis.Explore</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Explore.html#synthesisTreeRootIO"><span class="hs-identifier">synthesisTreeRootIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Explore.html#getTreeIO"><span class="hs-identifier">getTreeIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Explore.html#getTreePathIO"><span class="hs-identifier">getTreePathIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Explore.html#subForestIO"><span class="hs-identifier">subForestIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Explore.html#positiveSubForestIO"><span class="hs-identifier">positiveSubForestIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Explore.html#isComplete"><span class="hs-identifier">isComplete</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Explore.html#isLeaf"><span class="hs-identifier">isLeaf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent.STM</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Analysis.html"><span class="hs-identifier">NITTA.Intermediate.Analysis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Analysis.html#buildProcessWaves"><span class="hs-identifier">buildProcessWaves</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Analysis.html#estimateVarWaves"><span class="hs-identifier">estimateVarWaves</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html"><span class="hs-identifier">NITTA.Intermediate.Types</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Networks.Bus.html"><span class="hs-identifier">NITTA.Model.Networks.Bus</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Problems.Allocation.html"><span class="hs-identifier">NITTA.Model.Problems.Allocation</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Problems.Bind.html"><span class="hs-identifier">NITTA.Model.Problems.Bind</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Problems.Dataflow.html"><span class="hs-identifier">NITTA.Model.Problems.Dataflow</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.Problems.Refactor.html"><span class="hs-identifier">NITTA.Model.Problems.Refactor</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Model.TargetSystem.html"><span class="hs-identifier">NITTA.Model.TargetSystem</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Steps.html"><span class="hs-identifier">NITTA.Synthesis.Steps</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html"><span class="hs-identifier">NITTA.Synthesis.Types</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Utils.html"><span class="hs-identifier">NITTA.Utils</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Log.Logger</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- | Make synthesis tree</span><span>
</span><span id="line-43"></span><span id="synthesisTreeRootIO"><span class="annot"><span class="annottext">synthesisTreeRootIO :: TargetSystem (BusNetwork tag v x t) tag v x t
-&gt; IO
     (Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
</span><a href="NITTA.Synthesis.Explore.html#synthesisTreeRootIO"><span class="hs-identifier hs-var hs-var">synthesisTreeRootIO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. STM a -&gt; IO a
</span><span class="hs-identifier hs-var">atomically</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {tag} {x} {t} {v}.
(UnitTag tag, Val x, Bounded t, Hashable v, Suffix v, Show t,
 Default t, Integral t, Typeable t, Typeable v, Ord v, ToString v,
 IsString v) =&gt;
TargetSystem (BusNetwork tag v x t) tag v x t
-&gt; STM
     (Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
</span><a href="NITTA.Synthesis.Explore.html#rootSynthesisTreeSTM"><span class="hs-identifier hs-var">rootSynthesisTreeSTM</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span id="rootSynthesisTreeSTM"><span class="annot"><span class="annottext">rootSynthesisTreeSTM :: TargetSystem (BusNetwork tag v x t) tag v x t
-&gt; STM
     (Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
</span><a href="NITTA.Synthesis.Explore.html#rootSynthesisTreeSTM"><span class="hs-identifier hs-var hs-var">rootSynthesisTreeSTM</span></a></span></span><span> </span><span id="local-6989586621680213185"><span class="annot"><span class="annottext">TargetSystem (BusNetwork tag v x t) tag v x t
</span><a href="#local-6989586621680213185"><span class="hs-identifier hs-var">model</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-46"></span><span>    </span><span id="local-6989586621680213184"><span class="annot"><span class="annottext">TMVar
  [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680213184"><span class="hs-identifier hs-var">sSubForestVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. STM (TMVar a)
</span><span class="hs-identifier hs-var">newEmptyTMVar</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-48"></span><span>        </span><span class="annot"><a href="NITTA.Synthesis.Types.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span>
</span><span id="line-49"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sID :: Sid
</span><a href="NITTA.Synthesis.Types.html#sID"><span class="hs-identifier hs-var">sID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-50"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sState :: SynthesisState
  (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="NITTA.Synthesis.Types.html#sState"><span class="hs-identifier hs-var">sState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} {x} {t} {a}.
(UnitTag k, Val x, Bounded t, Hashable a, Suffix a, Show t,
 Default t, Integral t, Ord a, Typeable t, Typeable a, ToString a,
 IsString a) =&gt;
Maybe (Tree (TargetSystem (BusNetwork k a x t) k a x t) k a x t)
-&gt; TargetSystem (BusNetwork k a x t) k a x t
-&gt; SynthesisState
     (TargetSystem (BusNetwork k a x t) k a x t) k a x t
</span><a href="NITTA.Synthesis.Explore.html#nodeCtx"><span class="hs-identifier hs-var">nodeCtx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">TargetSystem (BusNetwork tag v x t) tag v x t
</span><a href="#local-6989586621680213185"><span class="hs-identifier hs-var">model</span></a></span><span>
</span><span id="line-51"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sDecision :: SynthesisDecision
  (SynthesisState
     (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
  (TargetSystem (BusNetwork tag v x t) tag v x t)
</span><a href="NITTA.Synthesis.Types.html#sDecision"><span class="hs-identifier hs-var">sDecision</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ctx m. SynthesisDecision ctx m
</span><a href="NITTA.Synthesis.Types.html#Root"><span class="hs-identifier hs-var">Root</span></a></span><span>
</span><span id="line-52"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TMVar
  [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
sSubForestVar :: TMVar
  [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
sSubForestVar :: TMVar
  [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="NITTA.Synthesis.Types.html#sSubForestVar"><span class="hs-identifier hs-var hs-var">sSubForestVar</span></a></span><span>
</span><span id="line-53"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | Get specific by @nId@ node from a synthesis tree.</span><span>
</span><span id="line-56"></span><span id="getTreeIO"><span class="annot"><span class="annottext">getTreeIO :: Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; Sid
-&gt; IO
     (Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
</span><a href="NITTA.Synthesis.Explore.html#getTreeIO"><span class="hs-identifier hs-var hs-var">getTreeIO</span></a></span></span><span> </span><span id="local-6989586621680213136"><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680213136"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680213136"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-57"></span><span class="annot"><a href="NITTA.Synthesis.Explore.html#getTreeIO"><span class="hs-identifier hs-var">getTreeIO</span></a></span><span> </span><span id="local-6989586621680213134"><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680213134"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680213133"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680213133"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680213132"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621680213132"><span class="hs-identifier hs-var">is</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-58"></span><span>    </span><span id="local-6989586621680213131"><span class="annot"><span class="annottext">[Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680213131"><span class="hs-identifier hs-var">subForest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {tag} {x} {t} {v}.
(UnitTag tag, Val x, Bounded t, Hashable v, Suffix v, Show t,
 Default t, Integral t, Typeable t, Typeable v, Ord v, ToString v,
 IsString v) =&gt;
Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; IO
     [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="NITTA.Synthesis.Explore.html#subForestIO"><span class="hs-identifier hs-var">subForestIO</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680213134"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680213133"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680213131"><span class="hs-identifier hs-var">subForest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getTreeIO - wrong Sid&quot;</span></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; Sid
-&gt; IO
     (Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
</span><a href="NITTA.Synthesis.Explore.html#getTreeIO"><span class="hs-identifier hs-var">getTreeIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680213131"><span class="hs-identifier hs-var">subForest</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680213133"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-var">Sid</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621680213132"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- | Get list of all nodes from root to selected.</span><span>
</span><span id="line-63"></span><span id="getTreePathIO"><span class="annot"><span class="annottext">getTreePathIO :: Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; Sid
-&gt; IO
     [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="NITTA.Synthesis.Explore.html#getTreePathIO"><span class="hs-identifier hs-var hs-var">getTreePathIO</span></a></span></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-64"></span><span class="annot"><a href="NITTA.Synthesis.Explore.html#getTreePathIO"><span class="hs-identifier hs-var">getTreePathIO</span></a></span><span> </span><span id="local-6989586621680213096"><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680213096"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-type">Sid</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680213095"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680213095"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680213094"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621680213094"><span class="hs-identifier hs-var">is</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-65"></span><span>    </span><span id="local-6989586621680213093"><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680213093"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {tag} {x} {t} {v}.
(UnitTag tag, Val x, Bounded t, Hashable v, Suffix v, Show t,
 Default t, Integral t, Typeable t, Typeable v, Ord v, ToString v,
 IsString v) =&gt;
Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; Sid
-&gt; IO
     (Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
</span><a href="NITTA.Synthesis.Explore.html#getTreeIO"><span class="hs-identifier hs-var">getTreeIO</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680213096"><span class="hs-identifier hs-var">tree</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-var">Sid</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680213095"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span>    </span><span id="local-6989586621680213092"><span class="annot"><span class="annottext">[Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680213092"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; Sid
-&gt; IO
     [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="NITTA.Synthesis.Explore.html#getTreePathIO"><span class="hs-identifier hs-var">getTreePathIO</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680213093"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-var">Sid</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621680213094"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680213093"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680213092"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">{- | Get all available edges for the node. Edges calculated only for the first
call.
-}</span><span>
</span><span id="line-72"></span><span id="subForestIO"><span class="annot"><span class="annottext">subForestIO :: Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; IO
     [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="NITTA.Synthesis.Explore.html#subForestIO"><span class="hs-identifier hs-var hs-var">subForestIO</span></a></span></span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621680213041"><span class="annot"><span class="annottext">tree :: Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680213041"><span class="hs-identifier hs-var">tree</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Synthesis.Types.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span>
</span><span id="line-74"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680213040"><span class="annot"><span class="annottext">TMVar
  [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
sSubForestVar :: TMVar
  [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
sSubForestVar :: forall m tag v x t. Tree m tag v x t -&gt; TMVar [Tree m tag v x t]
</span><a href="#local-6989586621680213040"><span class="hs-identifier hs-var hs-var">sSubForestVar</span></a></span></span><span>
</span><span id="line-75"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680213039"><span class="annot"><span class="annottext">Sid
sID :: Sid
sID :: forall m tag v x t. Tree m tag v x t -&gt; Sid
</span><a href="#local-6989586621680213039"><span class="hs-identifier hs-var hs-var">sID</span></a></span></span><span>
</span><span id="line-76"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680213038"><span class="annot"><span class="annottext">SynthesisDecision
  (SynthesisState
     (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
  (TargetSystem (BusNetwork tag v x t) tag v x t)
sDecision :: SynthesisDecision
  (SynthesisState
     (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
  (TargetSystem (BusNetwork tag v x t) tag v x t)
sDecision :: forall m tag v x t.
Tree m tag v x t
-&gt; SynthesisDecision (SynthesisState m tag v x t) m
</span><a href="#local-6989586621680213038"><span class="hs-identifier hs-var hs-var">sDecision</span></a></span></span><span>
</span><span id="line-77"></span><span>        </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-78"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621680213037"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680213037"><span class="hs-identifier hs-var">firstTime</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680213036"><span class="annot"><span class="annottext">[Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680213036"><span class="hs-identifier hs-var">subForest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-79"></span><span>            </span><span class="annot"><span class="annottext">forall a. STM a -&gt; IO a
</span><span class="hs-identifier hs-var">atomically</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-80"></span><span>                </span><span class="annot"><span class="annottext">forall a. TMVar a -&gt; STM (Maybe a)
</span><span class="hs-identifier hs-var">tryReadTMVar</span></span><span> </span><span class="annot"><span class="annottext">TMVar
  [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680213040"><span class="hs-identifier hs-var">sSubForestVar</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-81"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680213034"><span class="annot"><span class="annottext">[Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680213034"><span class="hs-identifier hs-var">subForest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680213034"><span class="hs-identifier hs-var">subForest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>                    </span><span class="annot"><span class="annottext">Maybe
  [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-83"></span><span>                        </span><span id="local-6989586621680213033"><span class="annot"><span class="annottext">[Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680213033"><span class="hs-identifier hs-var">subForest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {tag} {x} {t} {v}.
(UnitTag tag, Val x, Bounded t, Hashable v, Suffix v, ToString v,
 Show t, Default t, Integral t, Typeable t, Typeable v, Ord v,
 IsString v) =&gt;
Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; STM
     [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="NITTA.Synthesis.Explore.html#exploreSubForestVar"><span class="hs-identifier hs-var">exploreSubForestVar</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680213041"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-84"></span><span>                        </span><span class="annot"><span class="annottext">forall a. TMVar a -&gt; a -&gt; STM ()
</span><span class="hs-identifier hs-var">putTMVar</span></span><span> </span><span class="annot"><span class="annottext">TMVar
  [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680213040"><span class="hs-identifier hs-var">sSubForestVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680213033"><span class="hs-identifier hs-var">subForest</span></a></span><span>
</span><span id="line-85"></span><span>                        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680213033"><span class="hs-identifier hs-var">subForest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680213037"><span class="hs-identifier hs-var">firstTime</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-87"></span><span>            </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">debugM</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;NITTA.Synthesis&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-88"></span><span>                </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;explore: &quot;</span></span><span>
</span><span id="line-89"></span><span>                    </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Sid
</span><a href="#local-6989586621680213039"><span class="hs-identifier hs-var">sID</span></a></span><span>
</span><span id="line-90"></span><span>                    </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; score: &quot;</span></span><span>
</span><span id="line-91"></span><span>                    </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SynthesisDecision
  (SynthesisState
     (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
  (TargetSystem (BusNetwork tag v x t) tag v x t)
</span><a href="#local-6989586621680213038"><span class="hs-identifier hs-var">sDecision</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-92"></span><span>                            </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisDecision"><span class="hs-identifier hs-type">SynthesisDecision</span></a></span><span class="hs-special">{</span><span id="local-6989586621680213016"><span class="annot"><span class="annottext">Map Text Float
scores :: forall ctx m. SynthesisDecision ctx m -&gt; Map Text Float
scores :: Map Text Float
</span><a href="NITTA.Synthesis.Types.html#scores"><span class="hs-identifier hs-var hs-var">scores</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Map Text Float
</span><a href="#local-6989586621680213016"><span class="hs-identifier hs-var">scores</span></a></span><span>
</span><span id="line-93"></span><span>                            </span><span class="annot"><span class="annottext">SynthesisDecision
  (SynthesisState
     (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
  (TargetSystem (BusNetwork tag v x t) tag v x t)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-&quot;</span></span><span>
</span><span id="line-94"></span><span>                       </span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>                    </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; decision: &quot;</span></span><span>
</span><span id="line-96"></span><span>                    </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SynthesisDecision
  (SynthesisState
     (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
  (TargetSystem (BusNetwork tag v x t) tag v x t)
</span><a href="#local-6989586621680213038"><span class="hs-identifier hs-var">sDecision</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-97"></span><span>                            </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisDecision"><span class="hs-identifier hs-type">SynthesisDecision</span></a></span><span class="hs-special">{</span><span id="local-6989586621680213008"><span class="annot"><span class="annottext">d
decision :: ()
decision :: d
</span><a href="NITTA.Synthesis.Types.html#decision"><span class="hs-identifier hs-var hs-var">decision</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680213008"><span class="hs-identifier hs-var">decision</span></a></span><span>
</span><span id="line-98"></span><span>                            </span><span class="annot"><span class="annottext">SynthesisDecision
  (SynthesisState
     (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
  (TargetSystem (BusNetwork tag v x t) tag v x t)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-&quot;</span></span><span>
</span><span id="line-99"></span><span>                       </span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680213036"><span class="hs-identifier hs-var">subForest</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">{- | For synthesis method is more usefull, because throw away all useless trees in
subForest (objective function value less than zero).
-}</span><span>
</span><span id="line-106"></span><span id="positiveSubForestIO"><span class="annot"><span class="annottext">positiveSubForestIO :: Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; IO
     [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="NITTA.Synthesis.Explore.html#positiveSubForestIO"><span class="hs-identifier hs-var hs-var">positiveSubForestIO</span></a></span></span><span> </span><span id="local-6989586621680212974"><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212974"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {ctx} {m}. SynthesisDecision ctx m -&gt; Float
</span><a href="NITTA.Synthesis.Types.html#defScore"><span class="hs-identifier hs-var">defScore</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t.
Tree m tag v x t
-&gt; SynthesisDecision (SynthesisState m tag v x t) m
</span><a href="NITTA.Synthesis.Types.html#sDecision"><span class="hs-identifier hs-var">sDecision</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {tag} {x} {t} {v}.
(UnitTag tag, Val x, Bounded t, Hashable v, Suffix v, Show t,
 Default t, Integral t, Typeable t, Typeable v, Ord v, ToString v,
 IsString v) =&gt;
Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; IO
     [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="NITTA.Synthesis.Explore.html#subForestIO"><span class="hs-identifier hs-var">subForestIO</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212974"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span id="isLeaf"><span class="annot"><span class="annottext">isLeaf :: Tree m tag v x t -&gt; Bool
</span><a href="NITTA.Synthesis.Explore.html#isLeaf"><span class="hs-identifier hs-var hs-var">isLeaf</span></a></span></span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><a href="NITTA.Synthesis.Types.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span>
</span><span id="line-110"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sState :: forall m tag v x t. Tree m tag v x t -&gt; SynthesisState m tag v x t
</span><a href="NITTA.Synthesis.Types.html#sState"><span class="hs-identifier hs-var">sState</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-111"></span><span>            </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisState"><span class="hs-identifier hs-type">SynthesisState</span></a></span><span>
</span><span id="line-112"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sAllocationOptions :: forall m tag v x t. SynthesisState m tag v x t -&gt; [Allocation tag]
</span><a href="NITTA.Synthesis.Types.html#sAllocationOptions"><span class="hs-identifier hs-var">sAllocationOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sBindOptions :: forall m tag v x t. SynthesisState m tag v x t -&gt; [Bind tag v x]
</span><a href="NITTA.Synthesis.Types.html#sBindOptions"><span class="hs-identifier hs-var">sBindOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-114"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sDataflowOptions :: forall m tag v x t.
SynthesisState m tag v x t -&gt; [DataflowSt tag v (TimeConstraint t)]
</span><a href="NITTA.Synthesis.Types.html#sDataflowOptions"><span class="hs-identifier hs-var">sDataflowOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-115"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sBreakLoopOptions :: forall m tag v x t. SynthesisState m tag v x t -&gt; [BreakLoop v x]
</span><a href="NITTA.Synthesis.Types.html#sBreakLoopOptions"><span class="hs-identifier hs-var">sBreakLoopOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sResolveDeadlockOptions :: forall m tag v x t.
SynthesisState m tag v x t -&gt; [ResolveDeadlock v x]
</span><a href="NITTA.Synthesis.Types.html#sResolveDeadlockOptions"><span class="hs-identifier hs-var">sResolveDeadlockOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-117"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sOptimizeAccumOptions :: forall m tag v x t.
SynthesisState m tag v x t -&gt; [OptimizeAccum v x]
</span><a href="NITTA.Synthesis.Types.html#sOptimizeAccumOptions"><span class="hs-identifier hs-var">sOptimizeAccumOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-118"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sConstantFoldingOptions :: forall m tag v x t.
SynthesisState m tag v x t -&gt; [ConstantFolding v x]
</span><a href="NITTA.Synthesis.Types.html#sConstantFoldingOptions"><span class="hs-identifier hs-var">sConstantFoldingOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-119"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-120"></span><span>        </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-121"></span><span class="annot"><a href="NITTA.Synthesis.Explore.html#isLeaf"><span class="hs-identifier hs-var">isLeaf</span></a></span><span> </span><span class="annot"><span class="annottext">Tree m tag v x t
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="isComplete"><span class="annot"><span class="annottext">isComplete :: Tree (TargetSystem u tag v x t) tag v x t -&gt; Bool
</span><a href="NITTA.Synthesis.Explore.html#isComplete"><span class="hs-identifier hs-var hs-var">isComplete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall u v x t tag.
ProcessorUnit u v x t =&gt;
TargetSystem u tag v x t -&gt; Bool
</span><a href="NITTA.Model.TargetSystem.html#isSynthesisComplete"><span class="hs-identifier hs-var">isSynthesisComplete</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; m
</span><a href="NITTA.Synthesis.Types.html#sTarget"><span class="hs-identifier hs-var">sTarget</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall m tag v x t. Tree m tag v x t -&gt; SynthesisState m tag v x t
</span><a href="NITTA.Synthesis.Types.html#sState"><span class="hs-identifier hs-var">sState</span></a></span><span>
</span><span id="line-124"></span><span class="hs-comment">-- * Internal</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span id="exploreSubForestVar"><span class="annot"><span class="annottext">exploreSubForestVar :: Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
-&gt; STM
     [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="NITTA.Synthesis.Explore.html#exploreSubForestVar"><span class="hs-identifier hs-var hs-var">exploreSubForestVar</span></a></span></span><span> </span><span id="local-6989586621680212752"><span class="annot"><span class="annottext">parent :: Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212752"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Synthesis.Types.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span class="hs-special">{</span><span id="local-6989586621680212751"><span class="annot"><span class="annottext">Sid
sID :: Sid
sID :: forall m tag v x t. Tree m tag v x t -&gt; Sid
</span><a href="#local-6989586621680212751"><span class="hs-identifier hs-var hs-var">sID</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680212750"><span class="annot"><span class="annottext">SynthesisState
  (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
sState :: SynthesisState
  (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
sState :: forall m tag v x t. Tree m tag v x t -&gt; SynthesisState m tag v x t
</span><a href="#local-6989586621680212750"><span class="hs-identifier hs-var hs-var">sState</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680212749"><span class="annot"><span class="annottext">edges :: [(SynthesisDecision
    (SynthesisState
       (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
    (TargetSystem (BusNetwork tag v x t) tag v x t),
  SynthesisState
    (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)]
</span><a href="#local-6989586621680212749"><span class="hs-identifier hs-var hs-var">edges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-128"></span><span>            </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-129"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {ctx} {m} {o} {d} {p} {k} {a} {x} {t}.
(SynthesisDecisionCls ctx m o d p,
 SynthesisDecisionCls
   (SynthesisState
      (TargetSystem (BusNetwork k a x t) k a x t) k a x t)
   (TargetSystem (BusNetwork k a x t) k a x t)
   o
   d
   p,
 ToJSON p, Viewable d DecisionView, UnitTag k, Val x, Bounded t,
 Hashable a, Suffix a, Show d, Show t, Default t, Integral t,
 Typeable p, Typeable t, Typeable a, Ord a, ToString a,
 IsString a) =&gt;
Tree (TargetSystem (BusNetwork k a x t) k a x t) k a x t
-&gt; o
-&gt; [(SynthesisDecision ctx m,
     SynthesisState
       (TargetSystem (BusNetwork k a x t) k a x t) k a x t)]
</span><a href="NITTA.Synthesis.Explore.html#decisionAndContext"><span class="hs-identifier hs-var">decisionAndContext</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212752"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; [Allocation tag]
</span><a href="NITTA.Synthesis.Types.html#sAllocationOptions"><span class="hs-identifier hs-var">sAllocationOptions</span></a></span><span> </span><span class="annot"><span class="annottext">SynthesisState
  (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212750"><span class="hs-identifier hs-var">sState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>                    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {ctx} {m} {o} {d} {p} {k} {a} {x} {t}.
(SynthesisDecisionCls ctx m o d p,
 SynthesisDecisionCls
   (SynthesisState
      (TargetSystem (BusNetwork k a x t) k a x t) k a x t)
   (TargetSystem (BusNetwork k a x t) k a x t)
   o
   d
   p,
 ToJSON p, Viewable d DecisionView, UnitTag k, Val x, Bounded t,
 Hashable a, Suffix a, Show d, Show t, Default t, Integral t,
 Typeable p, Typeable t, Typeable a, Ord a, ToString a,
 IsString a) =&gt;
Tree (TargetSystem (BusNetwork k a x t) k a x t) k a x t
-&gt; o
-&gt; [(SynthesisDecision ctx m,
     SynthesisState
       (TargetSystem (BusNetwork k a x t) k a x t) k a x t)]
</span><a href="NITTA.Synthesis.Explore.html#decisionAndContext"><span class="hs-identifier hs-var">decisionAndContext</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212752"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; [Bind tag v x]
</span><a href="NITTA.Synthesis.Types.html#sBindOptions"><span class="hs-identifier hs-var">sBindOptions</span></a></span><span> </span><span class="annot"><span class="annottext">SynthesisState
  (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212750"><span class="hs-identifier hs-var">sState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>                    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {ctx} {m} {o} {d} {p} {k} {a} {x} {t}.
(SynthesisDecisionCls ctx m o d p,
 SynthesisDecisionCls
   (SynthesisState
      (TargetSystem (BusNetwork k a x t) k a x t) k a x t)
   (TargetSystem (BusNetwork k a x t) k a x t)
   o
   d
   p,
 ToJSON p, Viewable d DecisionView, UnitTag k, Val x, Bounded t,
 Hashable a, Suffix a, Show d, Show t, Default t, Integral t,
 Typeable p, Typeable t, Typeable a, Ord a, ToString a,
 IsString a) =&gt;
Tree (TargetSystem (BusNetwork k a x t) k a x t) k a x t
-&gt; o
-&gt; [(SynthesisDecision ctx m,
     SynthesisState
       (TargetSystem (BusNetwork k a x t) k a x t) k a x t)]
</span><a href="NITTA.Synthesis.Explore.html#decisionAndContext"><span class="hs-identifier hs-var">decisionAndContext</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212752"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall m tag v x t.
SynthesisState m tag v x t -&gt; [DataflowSt tag v (TimeConstraint t)]
</span><a href="NITTA.Synthesis.Types.html#sDataflowOptions"><span class="hs-identifier hs-var">sDataflowOptions</span></a></span><span> </span><span class="annot"><span class="annottext">SynthesisState
  (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212750"><span class="hs-identifier hs-var">sState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>                    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {ctx} {m} {o} {d} {p} {k} {a} {x} {t}.
(SynthesisDecisionCls ctx m o d p,
 SynthesisDecisionCls
   (SynthesisState
      (TargetSystem (BusNetwork k a x t) k a x t) k a x t)
   (TargetSystem (BusNetwork k a x t) k a x t)
   o
   d
   p,
 ToJSON p, Viewable d DecisionView, UnitTag k, Val x, Bounded t,
 Hashable a, Suffix a, Show d, Show t, Default t, Integral t,
 Typeable p, Typeable t, Typeable a, Ord a, ToString a,
 IsString a) =&gt;
Tree (TargetSystem (BusNetwork k a x t) k a x t) k a x t
-&gt; o
-&gt; [(SynthesisDecision ctx m,
     SynthesisState
       (TargetSystem (BusNetwork k a x t) k a x t) k a x t)]
</span><a href="NITTA.Synthesis.Explore.html#decisionAndContext"><span class="hs-identifier hs-var">decisionAndContext</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212752"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall m tag v x t. SynthesisState m tag v x t -&gt; [BreakLoop v x]
</span><a href="NITTA.Synthesis.Types.html#sBreakLoopOptions"><span class="hs-identifier hs-var">sBreakLoopOptions</span></a></span><span> </span><span class="annot"><span class="annottext">SynthesisState
  (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212750"><span class="hs-identifier hs-var">sState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>                    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {ctx} {m} {o} {d} {p} {k} {a} {x} {t}.
(SynthesisDecisionCls ctx m o d p,
 SynthesisDecisionCls
   (SynthesisState
      (TargetSystem (BusNetwork k a x t) k a x t) k a x t)
   (TargetSystem (BusNetwork k a x t) k a x t)
   o
   d
   p,
 ToJSON p, Viewable d DecisionView, UnitTag k, Val x, Bounded t,
 Hashable a, Suffix a, Show d, Show t, Default t, Integral t,
 Typeable p, Typeable t, Typeable a, Ord a, ToString a,
 IsString a) =&gt;
Tree (TargetSystem (BusNetwork k a x t) k a x t) k a x t
-&gt; o
-&gt; [(SynthesisDecision ctx m,
     SynthesisState
       (TargetSystem (BusNetwork k a x t) k a x t) k a x t)]
</span><a href="NITTA.Synthesis.Explore.html#decisionAndContext"><span class="hs-identifier hs-var">decisionAndContext</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212752"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall m tag v x t.
SynthesisState m tag v x t -&gt; [ResolveDeadlock v x]
</span><a href="NITTA.Synthesis.Types.html#sResolveDeadlockOptions"><span class="hs-identifier hs-var">sResolveDeadlockOptions</span></a></span><span> </span><span class="annot"><span class="annottext">SynthesisState
  (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212750"><span class="hs-identifier hs-var">sState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>                    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {ctx} {m} {o} {d} {p} {k} {a} {x} {t}.
(SynthesisDecisionCls ctx m o d p,
 SynthesisDecisionCls
   (SynthesisState
      (TargetSystem (BusNetwork k a x t) k a x t) k a x t)
   (TargetSystem (BusNetwork k a x t) k a x t)
   o
   d
   p,
 ToJSON p, Viewable d DecisionView, UnitTag k, Val x, Bounded t,
 Hashable a, Suffix a, Show d, Show t, Default t, Integral t,
 Typeable p, Typeable t, Typeable a, Ord a, ToString a,
 IsString a) =&gt;
Tree (TargetSystem (BusNetwork k a x t) k a x t) k a x t
-&gt; o
-&gt; [(SynthesisDecision ctx m,
     SynthesisState
       (TargetSystem (BusNetwork k a x t) k a x t) k a x t)]
</span><a href="NITTA.Synthesis.Explore.html#decisionAndContext"><span class="hs-identifier hs-var">decisionAndContext</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212752"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall m tag v x t.
SynthesisState m tag v x t -&gt; [OptimizeAccum v x]
</span><a href="NITTA.Synthesis.Types.html#sOptimizeAccumOptions"><span class="hs-identifier hs-var">sOptimizeAccumOptions</span></a></span><span> </span><span class="annot"><span class="annottext">SynthesisState
  (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212750"><span class="hs-identifier hs-var">sState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>                    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {ctx} {m} {o} {d} {p} {k} {a} {x} {t}.
(SynthesisDecisionCls ctx m o d p,
 SynthesisDecisionCls
   (SynthesisState
      (TargetSystem (BusNetwork k a x t) k a x t) k a x t)
   (TargetSystem (BusNetwork k a x t) k a x t)
   o
   d
   p,
 ToJSON p, Viewable d DecisionView, UnitTag k, Val x, Bounded t,
 Hashable a, Suffix a, Show d, Show t, Default t, Integral t,
 Typeable p, Typeable t, Typeable a, Ord a, ToString a,
 IsString a) =&gt;
Tree (TargetSystem (BusNetwork k a x t) k a x t) k a x t
-&gt; o
-&gt; [(SynthesisDecision ctx m,
     SynthesisState
       (TargetSystem (BusNetwork k a x t) k a x t) k a x t)]
</span><a href="NITTA.Synthesis.Explore.html#decisionAndContext"><span class="hs-identifier hs-var">decisionAndContext</span></a></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212752"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall m tag v x t.
SynthesisState m tag v x t -&gt; [ConstantFolding v x]
</span><a href="NITTA.Synthesis.Types.html#sConstantFoldingOptions"><span class="hs-identifier hs-var">sConstantFoldingOptions</span></a></span><span> </span><span class="annot"><span class="annottext">SynthesisState
  (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212750"><span class="hs-identifier hs-var">sState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(SynthesisDecision
    (SynthesisState
       (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
    (TargetSystem (BusNetwork tag v x t) tag v x t),
  SynthesisState
    (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)]
</span><a href="#local-6989586621680212749"><span class="hs-identifier hs-var">edges</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680212746"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680212746"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680212745"><span class="annot"><span class="annottext">SynthesisDecision
  (SynthesisState
     (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
  (TargetSystem (BusNetwork tag v x t) tag v x t)
</span><a href="#local-6989586621680212745"><span class="hs-identifier hs-var">desc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680212744"><span class="annot"><span class="annottext">SynthesisState
  (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212744"><span class="hs-identifier hs-var">ctx'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-138"></span><span>            </span><span id="local-6989586621680212743"><span class="annot"><span class="annottext">TMVar
  [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680212743"><span class="hs-identifier hs-var">sSubForestVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. STM (TMVar a)
</span><span class="hs-identifier hs-var">newEmptyTMVar</span></span><span>
</span><span id="line-139"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-140"></span><span>                </span><span class="annot"><a href="NITTA.Synthesis.Types.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span>
</span><span id="line-141"></span><span>                    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sID :: Sid
</span><a href="NITTA.Synthesis.Types.html#sID"><span class="hs-identifier hs-var">sID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sid
</span><a href="#local-6989586621680212751"><span class="hs-identifier hs-var">sID</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Sid
</span><a href="NITTA.Synthesis.Types.html#Sid"><span class="hs-identifier hs-var">Sid</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680212746"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sState :: SynthesisState
  (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="NITTA.Synthesis.Types.html#sState"><span class="hs-identifier hs-var">sState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SynthesisState
  (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t
</span><a href="#local-6989586621680212744"><span class="hs-identifier hs-var">ctx'</span></a></span><span>
</span><span id="line-143"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sDecision :: SynthesisDecision
  (SynthesisState
     (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
  (TargetSystem (BusNetwork tag v x t) tag v x t)
</span><a href="NITTA.Synthesis.Types.html#sDecision"><span class="hs-identifier hs-var">sDecision</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SynthesisDecision
  (SynthesisState
     (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t)
  (TargetSystem (BusNetwork tag v x t) tag v x t)
</span><a href="#local-6989586621680212745"><span class="hs-identifier hs-var">desc</span></a></span><span>
</span><span id="line-144"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TMVar
  [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
sSubForestVar :: TMVar
  [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
sSubForestVar :: TMVar
  [Tree (TargetSystem (BusNetwork tag v x t) tag v x t) tag v x t]
</span><a href="#local-6989586621680212743"><span class="hs-identifier hs-var hs-var">sSubForestVar</span></a></span><span>
</span><span id="line-145"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span id="decisionAndContext"><span class="annot"><span class="annottext">decisionAndContext :: Tree (TargetSystem (BusNetwork k a x t) k a x t) k a x t
-&gt; o
-&gt; [(SynthesisDecision ctx m,
     SynthesisState
       (TargetSystem (BusNetwork k a x t) k a x t) k a x t)]
</span><a href="NITTA.Synthesis.Explore.html#decisionAndContext"><span class="hs-identifier hs-var hs-var">decisionAndContext</span></a></span></span><span> </span><span id="local-6989586621680212700"><span class="annot"><span class="annottext">parent :: Tree (TargetSystem (BusNetwork k a x t) k a x t) k a x t
</span><a href="#local-6989586621680212700"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="NITTA.Synthesis.Types.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">sState :: forall m tag v x t. Tree m tag v x t -&gt; SynthesisState m tag v x t
</span><a href="NITTA.Synthesis.Types.html#sState"><span class="hs-identifier hs-var">sState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680212699"><span class="annot"><span class="annottext">SynthesisState (TargetSystem (BusNetwork k a x t) k a x t) k a x t
</span><a href="#local-6989586621680212699"><span class="hs-identifier hs-var">ctx</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680212698"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621680212698"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p ctx m o d.
(Typeable p, SynthesisDecisionCls ctx m o d p, Show d, ToJSON p,
 Viewable d DecisionView) =&gt;
o -&gt; d -&gt; p -&gt; Map Text Float -&gt; SynthesisDecision ctx m
</span><a href="NITTA.Synthesis.Types.html#SynthesisDecision"><span class="hs-identifier hs-var">SynthesisDecision</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621680212698"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680212697"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680212696"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Map Text Float
</span><a href="#local-6989586621680212695"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall {k} {x} {t} {a}.
(UnitTag k, Val x, Bounded t, Hashable a, Suffix a, Show t,
 Default t, Integral t, Ord a, Typeable t, Typeable a, ToString a,
 IsString a) =&gt;
Maybe (Tree (TargetSystem (BusNetwork k a x t) k a x t) k a x t)
-&gt; TargetSystem (BusNetwork k a x t) k a x t
-&gt; SynthesisState
     (TargetSystem (BusNetwork k a x t) k a x t) k a x t
</span><a href="NITTA.Synthesis.Explore.html#nodeCtx"><span class="hs-identifier hs-var">nodeCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Tree (TargetSystem (BusNetwork k a x t) k a x t) k a x t
</span><a href="#local-6989586621680212700"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TargetSystem (BusNetwork k a x t) k a x t
</span><a href="#local-6989586621680212694"><span class="hs-identifier hs-var">model</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680212697"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680212697"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680212694"><span class="annot"><span class="annottext">TargetSystem (BusNetwork k a x t) k a x t
</span><a href="#local-6989586621680212694"><span class="hs-identifier hs-var">model</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall ctx m o d p.
SynthesisDecisionCls ctx m o d p =&gt;
ctx -&gt; o -&gt; [(d, m)]
</span><a href="NITTA.Synthesis.Types.html#decisions"><span class="hs-identifier hs-var">decisions</span></a></span><span> </span><span class="annot"><span class="annottext">SynthesisState (TargetSystem (BusNetwork k a x t) k a x t) k a x t
</span><a href="#local-6989586621680212699"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621680212698"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680212696"><span class="annot"><span class="annottext">p :: p
</span><a href="#local-6989586621680212696"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ctx m o d p.
SynthesisDecisionCls ctx m o d p =&gt;
ctx -&gt; o -&gt; d -&gt; p
</span><a href="NITTA.Synthesis.Types.html#parameters"><span class="hs-identifier hs-var">parameters</span></a></span><span> </span><span class="annot"><span class="annottext">SynthesisState (TargetSystem (BusNetwork k a x t) k a x t) k a x t
</span><a href="#local-6989586621680212699"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621680212698"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680212697"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-151"></span><span>          </span><span id="local-6989586621680212695"><span class="annot"><span class="annottext">e :: Map Text Float
</span><a href="#local-6989586621680212695"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.singleton</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;default&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall ctx m o d p.
SynthesisDecisionCls ctx m o d p =&gt;
ctx -&gt; o -&gt; d -&gt; p -&gt; Float
</span><a href="NITTA.Synthesis.Types.html#estimate"><span class="hs-identifier hs-var">estimate</span></a></span><span> </span><span class="annot"><span class="annottext">SynthesisState (TargetSystem (BusNetwork k a x t) k a x t) k a x t
</span><a href="#local-6989586621680212699"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621680212698"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680212697"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680212696"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span id="nodeCtx"><span class="annot"><span class="annottext">nodeCtx :: Maybe (Tree (TargetSystem (BusNetwork k a x t) k a x t) k a x t)
-&gt; TargetSystem (BusNetwork k a x t) k a x t
-&gt; SynthesisState
     (TargetSystem (BusNetwork k a x t) k a x t) k a x t
</span><a href="NITTA.Synthesis.Explore.html#nodeCtx"><span class="hs-identifier hs-var hs-var">nodeCtx</span></a></span></span><span> </span><span id="local-6989586621680212590"><span class="annot"><span class="annottext">Maybe (Tree (TargetSystem (BusNetwork k a x t) k a x t) k a x t)
</span><a href="#local-6989586621680212590"><span class="hs-identifier hs-var">parent</span></a></span></span><span> </span><span id="local-6989586621680212589"><span class="annot"><span class="annottext">TargetSystem (BusNetwork k a x t) k a x t
</span><a href="#local-6989586621680212589"><span class="hs-identifier hs-var">nModel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680212588"><span class="annot"><span class="annottext">sBindOptions :: [Bind k a x]
</span><a href="#local-6989586621680212588"><span class="hs-identifier hs-var hs-var">sBindOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall u tag v x. BindProblem u tag v x =&gt; u -&gt; [Bind tag v x]
</span><a href="NITTA.Model.Problems.Bind.html#bindOptions"><span class="hs-identifier hs-var">bindOptions</span></a></span><span> </span><span class="annot"><span class="annottext">TargetSystem (BusNetwork k a x t) k a x t
</span><a href="#local-6989586621680212589"><span class="hs-identifier hs-var">nModel</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span id="local-6989586621680212586"><span class="annot"><span class="annottext">sDataflowOptions :: [DataflowSt k a (TimeConstraint t)]
</span><a href="#local-6989586621680212586"><span class="hs-identifier hs-var hs-var">sDataflowOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall u tag v t.
DataflowProblem u tag v t =&gt;
u -&gt; [DataflowSt tag v (TimeConstraint t)]
</span><a href="NITTA.Model.Problems.Dataflow.html#dataflowOptions"><span class="hs-identifier hs-var">dataflowOptions</span></a></span><span> </span><span class="annot"><span class="annottext">TargetSystem (BusNetwork k a x t) k a x t
</span><a href="#local-6989586621680212589"><span class="hs-identifier hs-var">nModel</span></a></span><span>
</span><span id="line-157"></span><span>        </span><span id="local-6989586621680212584"><span class="annot"><span class="annottext">fs :: [F a x]
</span><a href="#local-6989586621680212584"><span class="hs-identifier hs-var hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a f. WithFunctions a f =&gt; a -&gt; [f]
</span><a href="NITTA.Intermediate.Types.html#functions"><span class="hs-identifier hs-var">functions</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall u tag v x t. TargetSystem u tag v x t -&gt; DataFlowGraph v x
</span><a href="NITTA.Model.TargetSystem.html#mDataFlowGraph"><span class="hs-identifier hs-var">mDataFlowGraph</span></a></span><span> </span><span class="annot"><span class="annottext">TargetSystem (BusNetwork k a x t) k a x t
</span><a href="#local-6989586621680212589"><span class="hs-identifier hs-var">nModel</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span id="local-6989586621680212581"><span class="annot"><span class="annottext">processWaves :: [ProcessWave a x]
</span><a href="#local-6989586621680212581"><span class="hs-identifier hs-var hs-var">processWaves</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v x. (Var v, Val x) =&gt; [v] -&gt; [F v x] -&gt; [ProcessWave v x]
</span><a href="NITTA.Intermediate.Analysis.html#buildProcessWaves"><span class="hs-identifier hs-var">buildProcessWaves</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[F a x]
</span><a href="#local-6989586621680212584"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-159"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><a href="NITTA.Synthesis.Types.html#SynthesisState"><span class="hs-identifier hs-type">SynthesisState</span></a></span><span>
</span><span id="line-160"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sTarget :: TargetSystem (BusNetwork k a x t) k a x t
</span><a href="NITTA.Synthesis.Types.html#sTarget"><span class="hs-identifier hs-var">sTarget</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TargetSystem (BusNetwork k a x t) k a x t
</span><a href="#local-6989586621680212589"><span class="hs-identifier hs-var">nModel</span></a></span><span>
</span><span id="line-161"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sParent :: Maybe (Tree (TargetSystem (BusNetwork k a x t) k a x t) k a x t)
</span><a href="NITTA.Synthesis.Types.html#sParent"><span class="hs-identifier hs-var">sParent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Tree (TargetSystem (BusNetwork k a x t) k a x t) k a x t)
</span><a href="#local-6989586621680212590"><span class="hs-identifier hs-var">parent</span></a></span><span>
</span><span id="line-162"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sAllocationOptions :: [Allocation k]
</span><a href="NITTA.Synthesis.Types.html#sAllocationOptions"><span class="hs-identifier hs-var">sAllocationOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall u tag. AllocationProblem u tag =&gt; u -&gt; [Allocation tag]
</span><a href="NITTA.Model.Problems.Allocation.html#allocationOptions"><span class="hs-identifier hs-var">allocationOptions</span></a></span><span> </span><span class="annot"><span class="annottext">TargetSystem (BusNetwork k a x t) k a x t
</span><a href="#local-6989586621680212589"><span class="hs-identifier hs-var">nModel</span></a></span><span>
</span><span id="line-163"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Bind k a x]
sBindOptions :: [Bind k a x]
sBindOptions :: [Bind k a x]
</span><a href="#local-6989586621680212588"><span class="hs-identifier hs-var hs-var">sBindOptions</span></a></span><span>
</span><span id="line-164"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DataflowSt k a (TimeConstraint t)]
sDataflowOptions :: [DataflowSt k a (TimeConstraint t)]
sDataflowOptions :: [DataflowSt k a (TimeConstraint t)]
</span><a href="#local-6989586621680212586"><span class="hs-identifier hs-var hs-var">sDataflowOptions</span></a></span><span>
</span><span id="line-165"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sResolveDeadlockOptions :: [ResolveDeadlock a x]
</span><a href="NITTA.Synthesis.Types.html#sResolveDeadlockOptions"><span class="hs-identifier hs-var">sResolveDeadlockOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall u v x.
ResolveDeadlockProblem u v x =&gt;
u -&gt; [ResolveDeadlock v x]
</span><a href="NITTA.Model.Problems.Refactor.ResolveDeadlock.html#resolveDeadlockOptions"><span class="hs-identifier hs-var">resolveDeadlockOptions</span></a></span><span> </span><span class="annot"><span class="annottext">TargetSystem (BusNetwork k a x t) k a x t
</span><a href="#local-6989586621680212589"><span class="hs-identifier hs-var">nModel</span></a></span><span>
</span><span id="line-166"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sBreakLoopOptions :: [BreakLoop a x]
</span><a href="NITTA.Synthesis.Types.html#sBreakLoopOptions"><span class="hs-identifier hs-var">sBreakLoopOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall u v x. BreakLoopProblem u v x =&gt; u -&gt; [BreakLoop v x]
</span><a href="NITTA.Model.Problems.Refactor.BreakLoop.html#breakLoopOptions"><span class="hs-identifier hs-var">breakLoopOptions</span></a></span><span> </span><span class="annot"><span class="annottext">TargetSystem (BusNetwork k a x t) k a x t
</span><a href="#local-6989586621680212589"><span class="hs-identifier hs-var">nModel</span></a></span><span>
</span><span id="line-167"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sConstantFoldingOptions :: [ConstantFolding a x]
</span><a href="NITTA.Synthesis.Types.html#sConstantFoldingOptions"><span class="hs-identifier hs-var">sConstantFoldingOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall u v x.
ConstantFoldingProblem u v x =&gt;
u -&gt; [ConstantFolding v x]
</span><a href="NITTA.Model.Problems.Refactor.ConstantFolding.html#constantFoldingOptions"><span class="hs-identifier hs-var">constantFoldingOptions</span></a></span><span> </span><span class="annot"><span class="annottext">TargetSystem (BusNetwork k a x t) k a x t
</span><a href="#local-6989586621680212589"><span class="hs-identifier hs-var">nModel</span></a></span><span>
</span><span id="line-168"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sOptimizeAccumOptions :: [OptimizeAccum a x]
</span><a href="NITTA.Synthesis.Types.html#sOptimizeAccumOptions"><span class="hs-identifier hs-var">sOptimizeAccumOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall u v x.
OptimizeAccumProblem u v x =&gt;
u -&gt; [OptimizeAccum v x]
</span><a href="NITTA.Model.Problems.Refactor.OptimizeAccum.html#optimizeAccumOptions"><span class="hs-identifier hs-var">optimizeAccumOptions</span></a></span><span> </span><span class="annot"><span class="annottext">TargetSystem (BusNetwork k a x t) k a x t
</span><a href="#local-6989586621680212589"><span class="hs-identifier hs-var">nModel</span></a></span><span>
</span><span id="line-169"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bindingAlternative :: Map (F a x) [k]
</span><a href="NITTA.Synthesis.Types.html#bindingAlternative"><span class="hs-identifier hs-var">bindingAlternative</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-170"></span><span>                </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span>
</span><span id="line-171"></span><span>                    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680212572"><span class="annot"><span class="annottext">Map (F a x) [k]
</span><a href="#local-6989586621680212572"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.Problems.Bind.html#Bind"><span class="hs-identifier hs-type">Bind</span></a></span><span> </span><span id="local-6989586621680212570"><span class="annot"><span class="annottext">F a x
</span><a href="#local-6989586621680212570"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680212569"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621680212569"><span class="hs-identifier hs-var">tag</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall k a.
Ord k =&gt;
(Maybe a -&gt; Maybe a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.alter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621680212569"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621680212569"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">F a x
</span><a href="#local-6989586621680212570"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Map (F a x) [k]
</span><a href="#local-6989586621680212572"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>                    </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span><span>
</span><span id="line-173"></span><span>                    </span><span class="annot"><span class="annottext">[Bind k a x]
</span><a href="#local-6989586621680212588"><span class="hs-identifier hs-var">sBindOptions</span></a></span><span>
</span><span id="line-174"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">possibleDeadlockBinds :: Set (F a x)
</span><a href="NITTA.Synthesis.Types.html#possibleDeadlockBinds"><span class="hs-identifier hs-var">possibleDeadlockBinds</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-175"></span><span>                </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span>
</span><span id="line-176"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">F a x
</span><a href="#local-6989586621680212563"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-177"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.Problems.Bind.html#Bind"><span class="hs-identifier hs-type">Bind</span></a></span><span> </span><span id="local-6989586621680212563"><span class="annot"><span class="annottext">F a x
</span><a href="#local-6989586621680212563"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680212562"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621680212562"><span class="hs-identifier hs-var">tag</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Bind k a x]
</span><a href="#local-6989586621680212588"><span class="hs-identifier hs-var">sBindOptions</span></a></span><span>
</span><span id="line-178"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Lock"><span class="hs-identifier hs-type">Lock</span></a></span><span class="hs-special">{</span><span id="local-6989586621680212560"><span class="annot"><span class="annottext">a
lockBy :: forall v. Lock v -&gt; v
lockBy :: a
</span><a href="NITTA.Intermediate.Types.html#lockBy"><span class="hs-identifier hs-var hs-var">lockBy</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall x v. Locks x v =&gt; x -&gt; [Lock v]
</span><a href="NITTA.Intermediate.Types.html#locks"><span class="hs-identifier hs-var">locks</span></a></span><span> </span><span class="annot"><span class="annottext">F a x
</span><a href="#local-6989586621680212563"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-179"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680212560"><span class="hs-identifier hs-var">lockBy</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`S.member`</span></span><span> </span><span class="annot"><span class="annottext">forall {a1} {a2}. Ord a1 =&gt; (a2 -&gt; Set a1) -&gt; [a2] -&gt; Set a1
</span><a href="NITTA.Utils.Base.html#unionsMap"><span class="hs-identifier hs-var">unionsMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} {v} {x} {t}. Ord k =&gt; k -&gt; BusNetwork k v x t -&gt; [F v x]
</span><a href="NITTA.Model.Networks.Bus.html#bindedFunctions"><span class="hs-identifier hs-var">bindedFunctions</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621680212562"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall u tag v x t. TargetSystem u tag v x t -&gt; u
</span><a href="NITTA.Model.TargetSystem.html#mUnit"><span class="hs-identifier hs-var">mUnit</span></a></span><span> </span><span class="annot"><span class="annottext">TargetSystem (BusNetwork k a x t) k a x t
</span><a href="#local-6989586621680212589"><span class="hs-identifier hs-var">nModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bindWaves :: Map a Int
</span><a href="NITTA.Synthesis.Types.html#bindWaves"><span class="hs-identifier hs-var">bindWaves</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall v x a. (Var v, Val x, Num a) =&gt; [v] -&gt; [F v x] -&gt; Map v a
</span><a href="NITTA.Intermediate.Analysis.html#estimateVarWaves"><span class="hs-identifier hs-var">estimateVarWaves</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">S.elems</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall u tag v x t. TargetSystem u tag v x t -&gt; u
</span><a href="NITTA.Model.TargetSystem.html#mUnit"><span class="hs-identifier hs-var">mUnit</span></a></span><span> </span><span class="annot"><span class="annottext">TargetSystem (BusNetwork k a x t) k a x t
</span><a href="#local-6989586621680212589"><span class="hs-identifier hs-var">nModel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">S.\\</span></span><span> </span><span class="annot"><span class="annottext">forall {a1} {a2}. Ord a1 =&gt; (a2 -&gt; Set a1) -&gt; [a2] -&gt; Set a1
</span><a href="NITTA.Utils.Base.html#unionsMap"><span class="hs-identifier hs-var">unionsMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">[Bind k a x]
</span><a href="#local-6989586621680212588"><span class="hs-identifier hs-var">sBindOptions</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[F a x]
</span><a href="#local-6989586621680212584"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-182"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ProcessWave a x]
processWaves :: [ProcessWave a x]
processWaves :: [ProcessWave a x]
</span><a href="NITTA.Synthesis.Types.html#processWaves"><span class="hs-identifier hs-var hs-var">processWaves</span></a></span><span>
</span><span id="line-183"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numberOfProcessWaves :: Int
</span><a href="NITTA.Synthesis.Types.html#numberOfProcessWaves"><span class="hs-identifier hs-var">numberOfProcessWaves</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ProcessWave a x]
</span><a href="#local-6989586621680212581"><span class="hs-identifier hs-var">processWaves</span></a></span><span>
</span><span id="line-184"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numberOfDataflowOptions :: Int
</span><a href="NITTA.Synthesis.Types.html#numberOfDataflowOptions"><span class="hs-identifier hs-var">numberOfDataflowOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[DataflowSt k a (TimeConstraint t)]
</span><a href="#local-6989586621680212586"><span class="hs-identifier hs-var">sDataflowOptions</span></a></span><span>
</span><span id="line-185"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">transferableVars :: Set a
</span><a href="NITTA.Synthesis.Types.html#transferableVars"><span class="hs-identifier hs-var">transferableVars</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-186"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">S.unions</span></span><span>
</span><span id="line-187"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointSt a (TimeConstraint t)
</span><a href="#local-6989586621680212544"><span class="hs-identifier hs-var">ep</span></a></span><span>
</span><span id="line-188"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Model.Problems.Dataflow.html#DataflowSt"><span class="hs-identifier hs-type">DataflowSt</span></a></span><span> </span><span class="annot"><span class="annottext">(k, EndpointSt a (TimeConstraint t))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680212542"><span class="annot"><span class="annottext">[(k, EndpointSt a (TimeConstraint t))]
</span><a href="#local-6989586621680212542"><span class="hs-identifier hs-var">targets</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[DataflowSt k a (TimeConstraint t)]
</span><a href="#local-6989586621680212586"><span class="hs-identifier hs-var">sDataflowOptions</span></a></span><span>
</span><span id="line-189"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680212544"><span class="annot"><span class="annottext">EndpointSt a (TimeConstraint t)
</span><a href="#local-6989586621680212544"><span class="hs-identifier hs-var">ep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(k, EndpointSt a (TimeConstraint t))]
</span><a href="#local-6989586621680212542"><span class="hs-identifier hs-var">targets</span></a></span><span>
</span><span id="line-190"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-192"></span></pre></body></html>