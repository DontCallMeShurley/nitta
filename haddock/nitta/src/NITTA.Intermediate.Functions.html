<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DuplicateRecordFields #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-comment">{- |
Module      : NITTA.Intermediate.Functions
Description : Library of functions
Copyright   : (c) Aleksandr Penskoi, 2019
License     : BSD3
Maintainer  : aleksandr.penskoi@gmail.com
Stability   : experimental

Library of functions for an intermediate algorithm representation. Execution
relations between functions and process units are many-to-many.

[@function (functional block)@] atomic operation in intermediate algorithm
representation. Function has zero or many inputs and zero or many output.
Function can contains state between process cycles.
-}</span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">NITTA.Intermediate.Functions</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Arithmetics</span></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier">Add</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#add"><span class="hs-identifier">add</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier">Division</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#division"><span class="hs-identifier">division</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier">Multiply</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#multiply"><span class="hs-identifier">multiply</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftLR"><span class="hs-identifier">ShiftLR</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#shiftL"><span class="hs-identifier">shiftL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#shiftR"><span class="hs-identifier">shiftR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier">Sub</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#sub"><span class="hs-identifier">sub</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier">Neg</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#neg"><span class="hs-identifier">neg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.Accum.html"><span class="hs-identifier">NITTA.Intermediate.Functions.Accum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Memory</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier">Constant</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#constant"><span class="hs-identifier">constant</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#isConst"><span class="hs-identifier">isConst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier">Loop</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#loop"><span class="hs-identifier">loop</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#isLoop"><span class="hs-identifier">isLoop</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopEnd"><span class="hs-identifier">LoopEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopBegin"><span class="hs-identifier">LoopBegin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier">Buffer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#buffer"><span class="hs-identifier">buffer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Input/Output</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Receive"><span class="hs-identifier">Receive</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#receive"><span class="hs-identifier">receive</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Send"><span class="hs-identifier">Send</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#send"><span class="hs-identifier">send</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Internal</span></span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier">BrokenBuffer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#brokenBuffer"><span class="hs-identifier">brokenBuffer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HM</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">elems</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">union</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.Accum.html"><span class="hs-identifier">NITTA.Intermediate.Functions.Accum</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html"><span class="hs-identifier">NITTA.Intermediate.Types</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="NITTA.Utils.Base.html"><span class="hs-identifier">NITTA.Utils.Base</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">{- | Loop -- function for transfer data between computational cycles.
Let see the simple example with the following implementation of the
Fibonacci algorithm.

Data flow graph:

@
    +---------------------------------+
    |                                 |
    v                                 |
+------+                          b2  |
| Loop |      b1_1  +-----+    +------+
+------+----+------&gt;|     |    |
            | a1    | sum +----+
+------+-----------&gt;|     |
| Loop |    |       +-----+      b1_2
+------+    +-------------------------+
    ^                                 |
    |                                 |
    +---------------------------------+
@

Lua source code:

@
function fib(a1, b1)
    b2 = a1 + b1
    fib(b1, b2)
end
fib(0, 1)
@

Data flow defines computation for a single computational cycle. But
a controller should repeat the algorithm infinite times, and
usually, it is required to transfer data between cycles. `Loop`
allows doing that. At first cycle, `Loop` function produces an
initial value (`X x`), after that on each cycle `Loop` produces a
variable value from the previous cycle, and consumes a new value at
the end of the cycle.

Computational process:

@
         ][                 Cycle 1                 ][                Cycle 2                  ]
         ][                                         ][                                         ]
initial  ][ ---+                          b2   +--- ][ ---+                          b2   +--- ]
 value   ][ op |      b1_1  +-----+    +------&gt;| Lo ][ op |      b1_1  +-----+    +------&gt;| Lo ]
 is a    ][ ---+----+------&gt;|     |    |       +--- ][ ---+----+------&gt;|     |    |       +--- ]
part of  ][         |       | sum +----+            ][         |       | sum +----+            ]
software ][ ---+-----------&gt;|     |            +--- ][ ---+-----------&gt;|     |            +--- ]
         ][ op |    |       +-----+     b1_2   | Lo ][ op |    |       +-----+      b1_2  | Lo ]
         ][ ---+    +-------------------------&gt;+--- ][ ---+    +-------------------------&gt;+--- ]
         ][                                         ][                                         ]
@

Similation data:

+--------------+----+----+----+
| Cycle number | a1 | b1 | b2 |
+==============+====+====+====+
| 1            | 0  | 1  | 1  |
+--------------+----+----+----+
| 2            | 1  | 1  | 2  |
+--------------+----+----+----+
| 3            | 1  | 2  | 3  |
+--------------+----+----+----+
| 4            | 2  | 3  | 5  |
+--------------+----+----+----+

In practice, Loop function supported by Fram processor unit in the
following way: Loop function should be prepared before execution by
automatical refactor @BreakLoop@, which replace Loop by @LoopEnd@
and @LoopBegin@.
-}</span><span>
</span><span id="line-143"></span><span class="hs-keyword">data</span><span> </span><span id="Loop"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-var">Loop</span></a></span></span><span> </span><span id="local-6989586621680150659"><span class="annot"><a href="#local-6989586621680150659"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680150660"><span class="annot"><a href="#local-6989586621680150660"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Loop"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-var">Loop</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150660"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150659"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150659"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680150027"><span id="local-6989586621680150035"><span class="annot"><span class="annottext">Loop v x -&gt; Loop v x -&gt; Bool
(Loop v x -&gt; Loop v x -&gt; Bool)
-&gt; (Loop v x -&gt; Loop v x -&gt; Bool) -&gt; Eq (Loop v x)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v x. (Eq x, Eq v) =&gt; Loop v x -&gt; Loop v x -&gt; Bool
/= :: Loop v x -&gt; Loop v x -&gt; Bool
$c/= :: forall v x. (Eq x, Eq v) =&gt; Loop v x -&gt; Loop v x -&gt; Bool
== :: Loop v x -&gt; Loop v x -&gt; Bool
$c== :: forall v x. (Eq x, Eq v) =&gt; Loop v x -&gt; Loop v x -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span id="local-6989586621680150655"><span id="local-6989586621680150656"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680150021"><span id="local-6989586621680150024"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150656"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680150655"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-type">Loop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150656"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150655"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680150017"><span class="annot"><span class="annottext">show :: Loop v x -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loop v x -&gt; String
forall a. Label a =&gt; a -&gt; String
</span><a href="NITTA.Intermediate.Types.html#label"><span class="hs-keyword hs-var">label</span></a></span></span></span><span>
</span><span id="line-146"></span><span id="local-6989586621680150652"><span id="local-6989586621680150653"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150653"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680150652"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-type">Loop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150653"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150652"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>    </span><span id="local-6989586621680149998"><span class="annot"><span class="annottext">label :: Loop v x -&gt; String
</span><a href="#local-6989586621680149998"><span class="hs-keyword hs-var hs-var hs-var hs-var">label</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-type">Loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span id="local-6989586621680149996"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149996"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680149995"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149995"><span class="hs-identifier hs-var">os</span></a></span></span><span> </span><span id="local-6989586621680149994"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149994"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;loop(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">x -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149996"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149994"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;) = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">O v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149995"><span class="hs-identifier hs-var">os</span></a></span></span></span><span>
</span><span id="line-149"></span><span id="local-6989586621680150637"><span id="local-6989586621680150638"><span class="annot"><a href="NITTA.Intermediate.Functions.html#loop"><span class="hs-identifier hs-type">loop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150638"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Value.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150637"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680150637"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680150638"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680150638"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150638"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150637"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-150"></span><span id="loop"><span class="annot"><span class="annottext">loop :: forall v x. (Var v, Val x) =&gt; x -&gt; v -&gt; [v] -&gt; F v x
</span><a href="NITTA.Intermediate.Functions.html#loop"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621680149960"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149960"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621680149959"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149959"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149958"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149958"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loop v x -&gt; F v x
forall {f} {v} {x}.
(Function f v, Patch f (v, v), Locks f v, Show f, Label f,
 FunctionSimulation f v x, Typeable f, Eq f) =&gt;
f -&gt; F v x
</span><a href="NITTA.Intermediate.Types.html#packF"><span class="hs-identifier hs-var">packF</span></a></span><span> </span><span class="annot"><span class="annottext">(Loop v x -&gt; F v x) -&gt; Loop v x -&gt; F v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">X x -&gt; O v -&gt; I v -&gt; Loop v x
forall v x. X x -&gt; O v -&gt; I v -&gt; Loop v x
</span><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-var">Loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; X x
forall x. x -&gt; X x
</span><a href="NITTA.Intermediate.Types.html#X"><span class="hs-identifier hs-var">X</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149960"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set v -&gt; O v
forall v. Set v -&gt; O v
</span><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-var">O</span></a></span><span> </span><span class="annot"><span class="annottext">(Set v -&gt; O v) -&gt; Set v -&gt; O v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[v] -&gt; Set v
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149958"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(I v -&gt; Loop v x) -&gt; I v -&gt; Loop v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; I v
forall v. v -&gt; I v
</span><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149959"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-151"></span><span id="isLoop"><span class="annot"><span class="annottext">isLoop :: F v x -&gt; Bool
</span><a href="NITTA.Intermediate.Functions.html#isLoop"><span class="hs-identifier hs-var hs-var">isLoop</span></a></span></span><span> </span><span id="local-6989586621680149949"><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680149949"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-type">Loop</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">F v x -&gt; Maybe (Loop v x)
forall (f :: * -&gt; * -&gt; *) v x.
(Typeable f, Typeable v, Typeable x) =&gt;
F v x -&gt; Maybe (f v x)
</span><a href="NITTA.Intermediate.Types.html#castF"><span class="hs-identifier hs-var">castF</span></a></span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680149949"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span id="local-6989586621680150618"><span id="local-6989586621680150619"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-type">Loop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150619"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150618"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150619"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>    </span><span id="local-6989586621680149943"><span class="annot"><span class="annottext">isInternalLockPossible :: Loop v x -&gt; Bool
</span><a href="NITTA.Intermediate.Types.html#isInternalLockPossible"><span class="hs-identifier hs-var hs-var hs-var hs-var">isInternalLockPossible</span></a></span></span><span> </span><span class="annot"><span class="annottext">Loop v x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621680149939"><span class="annot"><span class="annottext">inputs :: Loop v x -&gt; Set v
</span><a href="NITTA.Intermediate.Types.html#inputs"><span class="hs-identifier hs-var hs-var hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-type">Loop</span></a></span><span> </span><span class="annot"><span class="annottext">X x
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680149937"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149937"><span class="hs-identifier hs-var">_a</span></a></span></span><span> </span><span id="local-6989586621680149936"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149936"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149936"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621680149932"><span class="annot"><span class="annottext">outputs :: Loop v x -&gt; Set v
</span><a href="NITTA.Intermediate.Types.html#outputs"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-type">Loop</span></a></span><span> </span><span class="annot"><span class="annottext">X x
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680149930"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149930"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149929"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149929"><span class="hs-identifier hs-var">_b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149930"><span class="hs-identifier hs-var">a</span></a></span></span></span><span>
</span><span id="line-159"></span><span id="local-6989586621680150620"><span id="local-6989586621680150621"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150621"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Patch"><span class="hs-identifier hs-type">Patch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-type">Loop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150621"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150620"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680150621"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680150621"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621680149919"><span class="annot"><span class="annottext">patch :: (v, v) -&gt; Loop v x -&gt; Loop v x
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var hs-var hs-var hs-var">patch</span></a></span></span><span> </span><span id="local-6989586621680149917"><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149917"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-type">Loop</span></a></span><span> </span><span id="local-6989586621680149916"><span class="annot"><span class="annottext">X x
</span><a href="#local-6989586621680149916"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621680149915"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149915"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149914"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149914"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X x -&gt; O v -&gt; I v -&gt; Loop v x
forall v x. X x -&gt; O v -&gt; I v -&gt; Loop v x
</span><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-var">Loop</span></a></span><span> </span><span class="annot"><span class="annottext">X x
</span><a href="#local-6989586621680149916"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; O v -&gt; O v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149917"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149915"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; I v -&gt; I v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149917"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149914"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-161"></span><span id="local-6989586621680150622"><span id="local-6989586621680150623"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150623"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Locks"><span class="hs-identifier hs-type">Locks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-type">Loop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150623"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150622"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150623"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621680149908"><span class="annot"><span class="annottext">locks :: Loop v x -&gt; [Lock v]
</span><a href="NITTA.Intermediate.Types.html#locks"><span class="hs-identifier hs-var hs-var hs-var hs-var">locks</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-type">Loop</span></a></span><span> </span><span class="annot"><span class="annottext">X x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span id="local-6989586621680149906"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149906"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621680149905"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149905"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Lock :: forall v. v -&gt; v -&gt; Lock v
</span><a href="NITTA.Intermediate.Types.html#Lock"><span class="hs-identifier hs-type">Lock</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">locked :: v
</span><a href="#local-6989586621680149903"><span class="hs-identifier hs-var">locked</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149905"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">lockBy :: v
</span><a href="#local-6989586621680149902"><span class="hs-identifier hs-var">lockBy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149901"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680149901"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149901"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; [v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149906"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-163"></span><span id="local-6989586621680150624"><span id="local-6989586621680150625"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150625"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#FunctionSimulation"><span class="hs-identifier hs-type">FunctionSimulation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-type">Loop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150625"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150624"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150625"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150624"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621680149891"><span class="annot"><span class="annottext">simulate :: CycleCntx v x -&gt; Loop v x -&gt; [(v, x)]
</span><a href="NITTA.Intermediate.Types.html#simulate"><span class="hs-identifier hs-var hs-var hs-var hs-var">simulate</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#CycleCntx"><span class="hs-identifier hs-type">CycleCntx</span></a></span><span class="hs-special">{</span><span id="local-6989586621680149888"><span class="annot"><span class="annottext">HashMap v x
cycleCntx :: forall v x. CycleCntx v x -&gt; HashMap v x
cycleCntx :: HashMap v x
</span><a href="NITTA.Intermediate.Types.html#cycleCntx"><span class="hs-identifier hs-var hs-var">cycleCntx</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-type">Loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span id="local-6989586621680149886"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149886"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span id="local-6989586621680149885"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149885"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-165"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; v
forall {c}. Set c -&gt; c
</span><a href="NITTA.Utils.Base.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149885"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; HashMap v x -&gt; Maybe x
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-operator hs-var">`HM.lookup`</span></span><span> </span><span class="annot"><span class="annottext">HashMap v x
</span><a href="#local-6989586621680149888"><span class="hs-identifier hs-var">cycleCntx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-166"></span><span>            </span><span class="hs-comment">-- if output variables are defined - nothing to do (values thrown on upper level)</span><span>
</span><span id="line-167"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-168"></span><span>            </span><span class="hs-comment">-- if output variables are not defined - set initial value</span><span>
</span><span id="line-169"></span><span>            </span><span class="annot"><span class="annottext">Maybe x
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149882"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149886"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680149882"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149882"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; [v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149885"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-keyword">data</span><span> </span><span id="LoopBegin"><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopBegin"><span class="hs-identifier hs-var">LoopBegin</span></a></span></span><span> </span><span id="local-6989586621680150564"><span class="annot"><a href="#local-6989586621680150564"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680150565"><span class="annot"><a href="#local-6989586621680150565"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LoopBegin"><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopBegin"><span class="hs-identifier hs-var">LoopBegin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-type">Loop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150564"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150565"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150564"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680149875"><span id="local-6989586621680149879"><span class="annot"><span class="annottext">LoopBegin v x -&gt; LoopBegin v x -&gt; Bool
(LoopBegin v x -&gt; LoopBegin v x -&gt; Bool)
-&gt; (LoopBegin v x -&gt; LoopBegin v x -&gt; Bool) -&gt; Eq (LoopBegin v x)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v x. (Eq x, Eq v) =&gt; LoopBegin v x -&gt; LoopBegin v x -&gt; Bool
/= :: LoopBegin v x -&gt; LoopBegin v x -&gt; Bool
$c/= :: forall v x. (Eq x, Eq v) =&gt; LoopBegin v x -&gt; LoopBegin v x -&gt; Bool
== :: LoopBegin v x -&gt; LoopBegin v x -&gt; Bool
$c== :: forall v x. (Eq x, Eq v) =&gt; LoopBegin v x -&gt; LoopBegin v x -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span id="local-6989586621680150562"><span id="local-6989586621680150563"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149870"><span id="local-6989586621680149873"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150563"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680150562"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopBegin"><span class="hs-identifier hs-type">LoopBegin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150563"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150562"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680149867"><span class="annot"><span class="annottext">show :: LoopBegin v x -&gt; String
</span><a href="#local-6989586621680149867"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LoopBegin v x -&gt; String
forall a. Label a =&gt; a -&gt; String
</span><a href="NITTA.Intermediate.Types.html#label"><span class="hs-keyword hs-var">label</span></a></span></span></span><span>
</span><span id="line-173"></span><span id="local-6989586621680150560"><span id="local-6989586621680150561"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150561"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopBegin"><span class="hs-identifier hs-type">LoopBegin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150561"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150560"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-174"></span><span>    </span><span id="local-6989586621680149861"><span class="annot"><span class="annottext">label :: LoopBegin v x -&gt; String
</span><a href="#local-6989586621680149861"><span class="hs-keyword hs-var hs-var hs-var hs-var">label</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopBegin"><span class="hs-identifier hs-type">LoopBegin</span></a></span><span> </span><span class="annot"><span class="annottext">Loop v x
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680149860"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149860"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LoopBegin() = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">O v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149860"><span class="hs-identifier hs-var">os</span></a></span></span></span><span>
</span><span id="line-175"></span><span id="local-6989586621680150556"><span id="local-6989586621680150557"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149858"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150557"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopBegin"><span class="hs-identifier hs-type">LoopBegin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150557"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150556"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150557"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621680149854"><span class="annot"><span class="annottext">outputs :: LoopBegin v x -&gt; Set v
</span><a href="#local-6989586621680149854"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopBegin"><span class="hs-identifier hs-type">LoopBegin</span></a></span><span> </span><span class="annot"><span class="annottext">Loop v x
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680149853"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149853"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149853"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621680149852"><span class="annot"><span class="annottext">isInternalLockPossible :: LoopBegin v x -&gt; Bool
</span><a href="#local-6989586621680149852"><span class="hs-identifier hs-var hs-var hs-var hs-var">isInternalLockPossible</span></a></span></span><span> </span><span class="annot"><span class="annottext">LoopBegin v x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span></span></span><span>
</span><span id="line-178"></span><span id="local-6989586621680150552"><span id="local-6989586621680150553"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150553"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Patch"><span class="hs-identifier hs-type">Patch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopBegin"><span class="hs-identifier hs-type">LoopBegin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150553"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150552"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680150553"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680150553"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621680149845"><span class="annot"><span class="annottext">patch :: (v, v) -&gt; LoopBegin v x -&gt; LoopBegin v x
</span><a href="#local-6989586621680149845"><span class="hs-identifier hs-var hs-var hs-var hs-var">patch</span></a></span></span><span> </span><span id="local-6989586621680149844"><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149844"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopBegin"><span class="hs-identifier hs-type">LoopBegin</span></a></span><span> </span><span id="local-6989586621680149843"><span class="annot"><span class="annottext">Loop v x
</span><a href="#local-6989586621680149843"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621680149842"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149842"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loop v x -&gt; O v -&gt; LoopBegin v x
forall v x. Loop v x -&gt; O v -&gt; LoopBegin v x
</span><a href="NITTA.Intermediate.Functions.html#LoopBegin"><span class="hs-identifier hs-var">LoopBegin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; Loop v x -&gt; Loop v x
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149844"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">Loop v x
</span><a href="#local-6989586621680149843"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(O v -&gt; LoopBegin v x) -&gt; O v -&gt; LoopBegin v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(v, v) -&gt; O v -&gt; O v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149844"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149842"><span class="hs-identifier hs-var">a</span></a></span></span></span><span>
</span><span id="line-180"></span><span id="local-6989586621680150548"><span id="local-6989586621680150549"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150549"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Locks"><span class="hs-identifier hs-type">Locks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopBegin"><span class="hs-identifier hs-type">LoopBegin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150549"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150548"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150549"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621680149836"><span class="annot"><span class="annottext">locks :: LoopBegin v x -&gt; [Lock v]
</span><a href="#local-6989586621680149836"><span class="hs-identifier hs-var hs-var hs-var hs-var">locks</span></a></span></span><span> </span><span class="annot"><span class="annottext">LoopBegin v x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-182"></span><span id="local-6989586621680150544"><span id="local-6989586621680150545"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150545"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#FunctionSimulation"><span class="hs-identifier hs-type">FunctionSimulation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopBegin"><span class="hs-identifier hs-type">LoopBegin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150545"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150544"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150545"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150544"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621680149831"><span class="annot"><span class="annottext">simulate :: CycleCntx v x -&gt; LoopBegin v x -&gt; [(v, x)]
</span><a href="#local-6989586621680149831"><span class="hs-identifier hs-var hs-var hs-var hs-var">simulate</span></a></span></span><span> </span><span id="local-6989586621680149830"><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149830"><span class="hs-identifier hs-var">cntx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopBegin"><span class="hs-identifier hs-type">LoopBegin</span></a></span><span> </span><span id="local-6989586621680149829"><span class="annot"><span class="annottext">Loop v x
</span><a href="#local-6989586621680149829"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">O v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CycleCntx v x -&gt; Loop v x -&gt; [(v, x)]
forall f v x.
FunctionSimulation f v x =&gt;
CycleCntx v x -&gt; f -&gt; [(v, x)]
</span><a href="NITTA.Intermediate.Types.html#simulate"><span class="hs-identifier hs-var">simulate</span></a></span><span> </span><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149830"><span class="hs-identifier hs-var">cntx</span></a></span><span> </span><span class="annot"><span class="annottext">Loop v x
</span><a href="#local-6989586621680149829"><span class="hs-identifier hs-var">l</span></a></span></span></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">data</span><span> </span><span id="LoopEnd"><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopEnd"><span class="hs-identifier hs-var">LoopEnd</span></a></span></span><span> </span><span id="local-6989586621680150542"><span class="annot"><a href="#local-6989586621680150542"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680150543"><span class="annot"><a href="#local-6989586621680150543"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LoopEnd"><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopEnd"><span class="hs-identifier hs-var">LoopEnd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-type">Loop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150542"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150543"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150542"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680149822"><span id="local-6989586621680149826"><span class="annot"><span class="annottext">LoopEnd v x -&gt; LoopEnd v x -&gt; Bool
(LoopEnd v x -&gt; LoopEnd v x -&gt; Bool)
-&gt; (LoopEnd v x -&gt; LoopEnd v x -&gt; Bool) -&gt; Eq (LoopEnd v x)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v x. (Eq x, Eq v) =&gt; LoopEnd v x -&gt; LoopEnd v x -&gt; Bool
/= :: LoopEnd v x -&gt; LoopEnd v x -&gt; Bool
$c/= :: forall v x. (Eq x, Eq v) =&gt; LoopEnd v x -&gt; LoopEnd v x -&gt; Bool
== :: LoopEnd v x -&gt; LoopEnd v x -&gt; Bool
$c== :: forall v x. (Eq x, Eq v) =&gt; LoopEnd v x -&gt; LoopEnd v x -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span id="local-6989586621680150540"><span id="local-6989586621680150541"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149817"><span id="local-6989586621680149820"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150541"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680150540"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopEnd"><span class="hs-identifier hs-type">LoopEnd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150541"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150540"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680149814"><span class="annot"><span class="annottext">show :: LoopEnd v x -&gt; String
</span><a href="#local-6989586621680149814"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LoopEnd v x -&gt; String
forall a. Label a =&gt; a -&gt; String
</span><a href="NITTA.Intermediate.Types.html#label"><span class="hs-keyword hs-var">label</span></a></span></span></span><span>
</span><span id="line-187"></span><span id="local-6989586621680150538"><span id="local-6989586621680150539"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150539"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopEnd"><span class="hs-identifier hs-type">LoopEnd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150539"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150538"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621680149805"><span class="annot"><span class="annottext">label :: LoopEnd v x -&gt; String
</span><a href="#local-6989586621680149805"><span class="hs-keyword hs-var hs-var hs-var hs-var">label</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopEnd"><span class="hs-identifier hs-type">LoopEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Loop"><span class="hs-identifier hs-type">Loop</span></a></span><span> </span><span class="annot"><span class="annottext">X x
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680149804"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149804"><span class="hs-identifier hs-var">os</span></a></span></span><span> </span><span class="annot"><span class="annottext">I v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680149803"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149803"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LoopEnd(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149803"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;) pair out: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">O v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149804"><span class="hs-identifier hs-var">os</span></a></span></span></span><span>
</span><span id="line-189"></span><span id="local-6989586621680150534"><span id="local-6989586621680150535"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149800"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150535"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopEnd"><span class="hs-identifier hs-type">LoopEnd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150535"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150534"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150535"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621680149797"><span class="annot"><span class="annottext">inputs :: LoopEnd v x -&gt; Set v
</span><a href="#local-6989586621680149797"><span class="hs-identifier hs-var hs-var hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopEnd"><span class="hs-identifier hs-type">LoopEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Loop v x
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680149796"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149796"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149796"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621680149795"><span class="annot"><span class="annottext">isInternalLockPossible :: LoopEnd v x -&gt; Bool
</span><a href="#local-6989586621680149795"><span class="hs-identifier hs-var hs-var hs-var hs-var">isInternalLockPossible</span></a></span></span><span> </span><span class="annot"><span class="annottext">LoopEnd v x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span></span></span><span>
</span><span id="line-192"></span><span id="local-6989586621680150530"><span id="local-6989586621680150531"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150531"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Patch"><span class="hs-identifier hs-type">Patch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopEnd"><span class="hs-identifier hs-type">LoopEnd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150531"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150530"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680150531"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680150531"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621680149787"><span class="annot"><span class="annottext">patch :: (v, v) -&gt; LoopEnd v x -&gt; LoopEnd v x
</span><a href="#local-6989586621680149787"><span class="hs-identifier hs-var hs-var hs-var hs-var">patch</span></a></span></span><span> </span><span id="local-6989586621680149786"><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149786"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopEnd"><span class="hs-identifier hs-type">LoopEnd</span></a></span><span> </span><span id="local-6989586621680149785"><span class="annot"><span class="annottext">Loop v x
</span><a href="#local-6989586621680149785"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621680149784"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149784"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loop v x -&gt; I v -&gt; LoopEnd v x
forall v x. Loop v x -&gt; I v -&gt; LoopEnd v x
</span><a href="NITTA.Intermediate.Functions.html#LoopEnd"><span class="hs-identifier hs-var">LoopEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; Loop v x -&gt; Loop v x
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149786"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">Loop v x
</span><a href="#local-6989586621680149785"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(I v -&gt; LoopEnd v x) -&gt; I v -&gt; LoopEnd v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(v, v) -&gt; I v -&gt; I v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149786"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149784"><span class="hs-identifier hs-var">a</span></a></span></span></span><span>
</span><span id="line-194"></span><span id="local-6989586621680150526"><span id="local-6989586621680150527"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150527"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Locks"><span class="hs-identifier hs-type">Locks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopEnd"><span class="hs-identifier hs-type">LoopEnd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150527"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150526"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150527"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680149777"><span class="annot"><span class="annottext">locks :: LoopEnd v x -&gt; [Lock v]
</span><a href="#local-6989586621680149777"><span class="hs-identifier hs-var hs-var hs-var hs-var">locks</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopEnd"><span class="hs-identifier hs-type">LoopEnd</span></a></span><span> </span><span id="local-6989586621680149776"><span class="annot"><span class="annottext">Loop v x
</span><a href="#local-6989586621680149776"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">I v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loop v x -&gt; [Lock v]
forall x v. Locks x v =&gt; x -&gt; [Lock v]
</span><a href="NITTA.Intermediate.Types.html#locks"><span class="hs-identifier hs-var">locks</span></a></span><span> </span><span class="annot"><span class="annottext">Loop v x
</span><a href="#local-6989586621680149776"><span class="hs-identifier hs-var">l</span></a></span></span></span><span>
</span><span id="line-195"></span><span id="local-6989586621680150522"><span id="local-6989586621680150523"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150523"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#FunctionSimulation"><span class="hs-identifier hs-type">FunctionSimulation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopEnd"><span class="hs-identifier hs-type">LoopEnd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150523"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150522"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150523"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150522"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>    </span><span id="local-6989586621680149771"><span class="annot"><span class="annottext">simulate :: CycleCntx v x -&gt; LoopEnd v x -&gt; [(v, x)]
</span><a href="#local-6989586621680149771"><span class="hs-identifier hs-var hs-var hs-var hs-var">simulate</span></a></span></span><span> </span><span id="local-6989586621680149770"><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149770"><span class="hs-identifier hs-var">cntx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#LoopEnd"><span class="hs-identifier hs-type">LoopEnd</span></a></span><span> </span><span id="local-6989586621680149769"><span class="annot"><span class="annottext">Loop v x
</span><a href="#local-6989586621680149769"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">I v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CycleCntx v x -&gt; Loop v x -&gt; [(v, x)]
forall f v x.
FunctionSimulation f v x =&gt;
CycleCntx v x -&gt; f -&gt; [(v, x)]
</span><a href="NITTA.Intermediate.Types.html#simulate"><span class="hs-identifier hs-var">simulate</span></a></span><span> </span><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149770"><span class="hs-identifier hs-var">cntx</span></a></span><span> </span><span class="annot"><span class="annottext">Loop v x
</span><a href="#local-6989586621680149769"><span class="hs-identifier hs-var">l</span></a></span></span></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-keyword">data</span><span> </span><span id="Buffer"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier hs-var">Buffer</span></a></span></span><span> </span><span id="local-6989586621680150521"><span class="annot"><a href="#local-6989586621680150521"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680150520"><span class="annot"><a href="#local-6989586621680150520"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Buffer"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier hs-var">Buffer</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150521"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150521"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680149762"><span id="local-6989586621680149766"><span class="annot"><span class="annottext">Buffer v x -&gt; Buffer v x -&gt; Bool
(Buffer v x -&gt; Buffer v x -&gt; Bool)
-&gt; (Buffer v x -&gt; Buffer v x -&gt; Bool) -&gt; Eq (Buffer v x)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v x. Eq v =&gt; Buffer v x -&gt; Buffer v x -&gt; Bool
/= :: Buffer v x -&gt; Buffer v x -&gt; Bool
$c/= :: forall v x. Eq v =&gt; Buffer v x -&gt; Buffer v x -&gt; Bool
== :: Buffer v x -&gt; Buffer v x -&gt; Bool
$c== :: forall v x. Eq v =&gt; Buffer v x -&gt; Buffer v x -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span id="local-6989586621680150516"><span id="local-6989586621680150517"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier hs-type">Buffer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150517"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150516"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680149759"><span class="annot"><span class="annottext">label :: Buffer v x -&gt; String
</span><a href="#local-6989586621680149759"><span class="hs-keyword hs-var hs-var hs-var hs-var">label</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier hs-type">Buffer</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;buf&quot;</span></span></span></span><span>
</span><span id="line-200"></span><span id="local-6989586621680150514"><span id="local-6989586621680150515"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149754"><span id="local-6989586621680149757"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150515"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier hs-type">Buffer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150515"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150514"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621680149747"><span class="annot"><span class="annottext">show :: Buffer v x -&gt; String
</span><a href="#local-6989586621680149747"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier hs-type">Buffer</span></a></span><span> </span><span id="local-6989586621680149746"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149746"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680149745"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149745"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;buffer(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149746"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">O v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149745"><span class="hs-identifier hs-var">os</span></a></span></span></span><span>
</span><span id="line-202"></span><span id="local-6989586621680150512"><span id="local-6989586621680150513"><span class="annot"><a href="NITTA.Intermediate.Functions.html#buffer"><span class="hs-identifier hs-type">buffer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150513"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Value.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150512"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680150513"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680150513"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150513"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150512"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-203"></span><span id="buffer"><span class="annot"><span class="annottext">buffer :: forall v x. (Var v, Val x) =&gt; v -&gt; [v] -&gt; F v x
</span><a href="NITTA.Intermediate.Functions.html#buffer"><span class="hs-identifier hs-var hs-var">buffer</span></a></span></span><span> </span><span id="local-6989586621680149724"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149724"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149723"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149723"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Buffer v x -&gt; F v x
forall {f} {v} {x}.
(Function f v, Patch f (v, v), Locks f v, Show f, Label f,
 FunctionSimulation f v x, Typeable f, Eq f) =&gt;
f -&gt; F v x
</span><a href="NITTA.Intermediate.Types.html#packF"><span class="hs-identifier hs-var">packF</span></a></span><span> </span><span class="annot"><span class="annottext">(Buffer v x -&gt; F v x) -&gt; Buffer v x -&gt; F v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; O v -&gt; Buffer v x
forall v x. I v -&gt; O v -&gt; Buffer v x
</span><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier hs-var">Buffer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; I v
forall v. v -&gt; I v
</span><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149724"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set v -&gt; O v
forall v. Set v -&gt; O v
</span><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-var">O</span></a></span><span> </span><span class="annot"><span class="annottext">(Set v -&gt; O v) -&gt; Set v -&gt; O v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[v] -&gt; Set v
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149723"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span id="local-6989586621680150502"><span id="local-6989586621680150503"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149719"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150503"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier hs-type">Buffer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150503"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150502"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150503"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-206"></span><span>    </span><span id="local-6989586621680149717"><span class="annot"><span class="annottext">inputs :: Buffer v x -&gt; Set v
</span><a href="#local-6989586621680149717"><span class="hs-identifier hs-var hs-var hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier hs-type">Buffer</span></a></span><span> </span><span id="local-6989586621680149716"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149716"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149715"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149715"><span class="hs-identifier hs-var">_b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149716"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621680149713"><span class="annot"><span class="annottext">outputs :: Buffer v x -&gt; Set v
</span><a href="#local-6989586621680149713"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier hs-type">Buffer</span></a></span><span> </span><span id="local-6989586621680149712"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149712"><span class="hs-identifier hs-var">_a</span></a></span></span><span> </span><span id="local-6989586621680149711"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149711"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149711"><span class="hs-identifier hs-var">b</span></a></span></span></span><span>
</span><span id="line-208"></span><span id="local-6989586621680150504"><span id="local-6989586621680150505"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150505"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Patch"><span class="hs-identifier hs-type">Patch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier hs-type">Buffer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150505"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150504"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680150505"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680150505"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-209"></span><span>    </span><span id="local-6989586621680149704"><span class="annot"><span class="annottext">patch :: (v, v) -&gt; Buffer v x -&gt; Buffer v x
</span><a href="#local-6989586621680149704"><span class="hs-identifier hs-var hs-var hs-var hs-var">patch</span></a></span></span><span> </span><span id="local-6989586621680149703"><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149703"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier hs-type">Buffer</span></a></span><span> </span><span id="local-6989586621680149702"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149702"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149701"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149701"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; O v -&gt; Buffer v x
forall v x. I v -&gt; O v -&gt; Buffer v x
</span><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier hs-var">Buffer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; I v -&gt; I v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149703"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149702"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; O v -&gt; O v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149703"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149701"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-210"></span><span id="local-6989586621680150506"><span id="local-6989586621680150507"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150507"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Locks"><span class="hs-identifier hs-type">Locks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier hs-type">Buffer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150507"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150506"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150507"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>    </span><span id="local-6989586621680149695"><span class="annot"><span class="annottext">locks :: Buffer v x -&gt; [Lock v]
</span><a href="#local-6989586621680149695"><span class="hs-identifier hs-var hs-var hs-var hs-var">locks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Buffer v x -&gt; [Lock v]
forall {f} {v}. Function f v =&gt; f -&gt; [Lock v]
</span><a href="NITTA.Intermediate.Types.html#inputsLockOutputs"><span class="hs-identifier hs-var">inputsLockOutputs</span></a></span></span></span><span>
</span><span id="line-212"></span><span id="local-6989586621680150508"><span id="local-6989586621680150509"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150509"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#FunctionSimulation"><span class="hs-identifier hs-type">FunctionSimulation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier hs-type">Buffer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150509"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150508"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150509"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150508"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621680149684"><span class="annot"><span class="annottext">simulate :: CycleCntx v x -&gt; Buffer v x -&gt; [(v, x)]
</span><a href="#local-6989586621680149684"><span class="hs-identifier hs-var hs-var hs-var hs-var">simulate</span></a></span></span><span> </span><span id="local-6989586621680149683"><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149683"><span class="hs-identifier hs-var">cntx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Buffer"><span class="hs-identifier hs-type">Buffer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621680149682"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149682"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span id="local-6989586621680149681"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149681"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-214"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149680"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149683"><span class="hs-identifier hs-var">cntx</span></a></span><span> </span><span class="annot"><span class="annottext">CycleCntx v x -&gt; v -&gt; x
forall {a} {v}.
(Eq a, Hashable a, ToString a) =&gt;
CycleCntx a v -&gt; a -&gt; v
</span><a href="NITTA.Intermediate.Types.html#getCntx"><span class="hs-operator hs-var">`getCntx`</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149682"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680149680"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149680"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; [v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149681"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-keyword">data</span><span> </span><span id="Add"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier hs-var">Add</span></a></span></span><span> </span><span id="local-6989586621680150491"><span class="annot"><a href="#local-6989586621680150491"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680150490"><span class="annot"><a href="#local-6989586621680150490"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Add"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier hs-var">Add</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150491"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150491"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150491"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680149671"><span id="local-6989586621680149676"><span class="annot"><span class="annottext">Add v x -&gt; Add v x -&gt; Bool
(Add v x -&gt; Add v x -&gt; Bool)
-&gt; (Add v x -&gt; Add v x -&gt; Bool) -&gt; Eq (Add v x)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v x. Eq v =&gt; Add v x -&gt; Add v x -&gt; Bool
/= :: Add v x -&gt; Add v x -&gt; Bool
$c/= :: forall v x. Eq v =&gt; Add v x -&gt; Add v x -&gt; Bool
== :: Add v x -&gt; Add v x -&gt; Bool
$c== :: forall v x. Eq v =&gt; Add v x -&gt; Add v x -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span id="local-6989586621680150486"><span id="local-6989586621680150487"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150487"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150486"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680149668"><span class="annot"><span class="annottext">label :: Add v x -&gt; String
</span><a href="#local-6989586621680149668"><span class="hs-keyword hs-var hs-var hs-var hs-var">label</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+&quot;</span></span></span></span><span>
</span><span id="line-218"></span><span id="local-6989586621680150484"><span id="local-6989586621680150485"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149663"><span id="local-6989586621680149666"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150485"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150485"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150484"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621680149655"><span class="annot"><span class="annottext">show :: Add v x -&gt; String
</span><a href="#local-6989586621680149655"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span id="local-6989586621680149654"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149654"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149653"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149653"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680149652"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149652"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-220"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680149651"><span class="annot"><span class="annottext">lexp :: String
</span><a href="#local-6989586621680149651"><span class="hs-identifier hs-var hs-var">lexp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149654"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; + &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149653"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-221"></span><span>            </span><span id="local-6989586621680149650"><span class="annot"><span class="annottext">rexp :: String
</span><a href="#local-6989586621680149650"><span class="hs-identifier hs-var hs-var">rexp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149652"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-222"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680149651"><span class="hs-identifier hs-var">lexp</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680149650"><span class="hs-identifier hs-var">rexp</span></a></span></span></span><span>
</span><span id="line-223"></span><span id="local-6989586621680150482"><span id="local-6989586621680150483"><span class="annot"><a href="NITTA.Intermediate.Functions.html#add"><span class="hs-identifier hs-type">add</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150483"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Value.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150482"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680150483"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680150483"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680150483"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150483"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150482"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-224"></span><span id="add"><span class="annot"><span class="annottext">add :: forall v x. (Var v, Val x) =&gt; v -&gt; v -&gt; [v] -&gt; F v x
</span><a href="NITTA.Intermediate.Functions.html#add"><span class="hs-identifier hs-var hs-var">add</span></a></span></span><span> </span><span id="local-6989586621680149625"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149625"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149624"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149624"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680149623"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149623"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Add v x -&gt; F v x
forall {f} {v} {x}.
(Function f v, Patch f (v, v), Locks f v, Show f, Label f,
 FunctionSimulation f v x, Typeable f, Eq f) =&gt;
f -&gt; F v x
</span><a href="NITTA.Intermediate.Types.html#packF"><span class="hs-identifier hs-var">packF</span></a></span><span> </span><span class="annot"><span class="annottext">(Add v x -&gt; F v x) -&gt; Add v x -&gt; F v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; I v -&gt; O v -&gt; Add v x
forall v x. I v -&gt; I v -&gt; O v -&gt; Add v x
</span><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; I v
forall v. v -&gt; I v
</span><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149625"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; I v
forall v. v -&gt; I v
</span><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149624"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(O v -&gt; Add v x) -&gt; O v -&gt; Add v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set v -&gt; O v
forall v. Set v -&gt; O v
</span><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-var">O</span></a></span><span> </span><span class="annot"><span class="annottext">(Set v -&gt; O v) -&gt; Set v -&gt; O v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[v] -&gt; Set v
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149623"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span id="local-6989586621680150472"><span id="local-6989586621680150473"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149619"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150473"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150473"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150472"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150473"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-227"></span><span>    </span><span id="local-6989586621680149615"><span class="annot"><span class="annottext">inputs :: Add v x -&gt; Set v
</span><a href="#local-6989586621680149615"><span class="hs-identifier hs-var hs-var hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span id="local-6989586621680149614"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149614"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149613"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149613"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680149612"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149612"><span class="hs-identifier hs-var">_c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149614"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Set v -&gt; Set v -&gt; Set v
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`union`</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149613"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621680149610"><span class="annot"><span class="annottext">outputs :: Add v x -&gt; Set v
</span><a href="#local-6989586621680149610"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span id="local-6989586621680149609"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149609"><span class="hs-identifier hs-var">_a</span></a></span></span><span> </span><span id="local-6989586621680149608"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149608"><span class="hs-identifier hs-var">_b</span></a></span></span><span> </span><span id="local-6989586621680149607"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149607"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149607"><span class="hs-identifier hs-var">c</span></a></span></span></span><span>
</span><span id="line-229"></span><span id="local-6989586621680150474"><span id="local-6989586621680150475"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150475"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Patch"><span class="hs-identifier hs-type">Patch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150475"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150474"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680150475"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680150475"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-230"></span><span>    </span><span id="local-6989586621680149599"><span class="annot"><span class="annottext">patch :: (v, v) -&gt; Add v x -&gt; Add v x
</span><a href="#local-6989586621680149599"><span class="hs-identifier hs-var hs-var hs-var hs-var">patch</span></a></span></span><span> </span><span id="local-6989586621680149598"><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149598"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span id="local-6989586621680149597"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149597"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149596"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149596"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680149595"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149595"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; I v -&gt; O v -&gt; Add v x
forall v x. I v -&gt; I v -&gt; O v -&gt; Add v x
</span><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; I v -&gt; I v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149598"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149597"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; I v -&gt; I v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149598"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149596"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; O v -&gt; O v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149598"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149595"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-231"></span><span id="local-6989586621680150476"><span id="local-6989586621680150477"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150477"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Locks"><span class="hs-identifier hs-type">Locks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150477"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150476"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150477"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-232"></span><span>    </span><span id="local-6989586621680149589"><span class="annot"><span class="annottext">locks :: Add v x -&gt; [Lock v]
</span><a href="#local-6989586621680149589"><span class="hs-identifier hs-var hs-var hs-var hs-var">locks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Add v x -&gt; [Lock v]
forall {f} {v}. Function f v =&gt; f -&gt; [Lock v]
</span><a href="NITTA.Intermediate.Types.html#inputsLockOutputs"><span class="hs-identifier hs-var">inputsLockOutputs</span></a></span></span></span><span>
</span><span id="line-233"></span><span id="local-6989586621680150478"><span id="local-6989586621680150479"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150479"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680150478"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#FunctionSimulation"><span class="hs-identifier hs-type">FunctionSimulation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150479"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150478"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150479"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150478"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621680149574"><span class="annot"><span class="annottext">simulate :: CycleCntx v x -&gt; Add v x -&gt; [(v, x)]
</span><a href="#local-6989586621680149574"><span class="hs-identifier hs-var hs-var hs-var hs-var">simulate</span></a></span></span><span> </span><span id="local-6989586621680149573"><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149573"><span class="hs-identifier hs-var">cntx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621680149572"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149572"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621680149571"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149571"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span id="local-6989586621680149570"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149570"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-235"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680149569"><span class="annot"><span class="annottext">x1 :: x
</span><a href="#local-6989586621680149569"><span class="hs-identifier hs-var hs-var">x1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149573"><span class="hs-identifier hs-var">cntx</span></a></span><span> </span><span class="annot"><span class="annottext">CycleCntx v x -&gt; v -&gt; x
forall {a} {v}.
(Eq a, Hashable a, ToString a) =&gt;
CycleCntx a v -&gt; a -&gt; v
</span><a href="NITTA.Intermediate.Types.html#getCntx"><span class="hs-operator hs-var">`getCntx`</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149572"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-236"></span><span>            </span><span id="local-6989586621680149568"><span class="annot"><span class="annottext">x2 :: x
</span><a href="#local-6989586621680149568"><span class="hs-identifier hs-var hs-var">x2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149573"><span class="hs-identifier hs-var">cntx</span></a></span><span> </span><span class="annot"><span class="annottext">CycleCntx v x -&gt; v -&gt; x
forall {a} {v}.
(Eq a, Hashable a, ToString a) =&gt;
CycleCntx a v -&gt; a -&gt; v
</span><a href="NITTA.Intermediate.Types.html#getCntx"><span class="hs-operator hs-var">`getCntx`</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149571"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-237"></span><span>            </span><span id="local-6989586621680149567"><span class="annot"><span class="annottext">y :: x
</span><a href="#local-6989586621680149567"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149569"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; x -&gt; x
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149568"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-238"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149565"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149567"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680149565"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149565"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; [v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149570"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-keyword">data</span><span> </span><span id="Sub"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier hs-var">Sub</span></a></span></span><span> </span><span id="local-6989586621680150463"><span class="annot"><a href="#local-6989586621680150463"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680150462"><span class="annot"><a href="#local-6989586621680150462"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Sub"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier hs-var">Sub</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150463"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150463"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150463"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680149557"><span id="local-6989586621680149562"><span class="annot"><span class="annottext">Sub v x -&gt; Sub v x -&gt; Bool
(Sub v x -&gt; Sub v x -&gt; Bool)
-&gt; (Sub v x -&gt; Sub v x -&gt; Bool) -&gt; Eq (Sub v x)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v x. Eq v =&gt; Sub v x -&gt; Sub v x -&gt; Bool
/= :: Sub v x -&gt; Sub v x -&gt; Bool
$c/= :: forall v x. Eq v =&gt; Sub v x -&gt; Sub v x -&gt; Bool
== :: Sub v x -&gt; Sub v x -&gt; Bool
$c== :: forall v x. Eq v =&gt; Sub v x -&gt; Sub v x -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span id="local-6989586621680150458"><span id="local-6989586621680150459"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150459"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150458"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680149554"><span class="annot"><span class="annottext">label :: Sub v x -&gt; String
</span><a href="#local-6989586621680149554"><span class="hs-keyword hs-var hs-var hs-var hs-var">label</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span></span></span><span>
</span><span id="line-242"></span><span id="local-6989586621680150456"><span id="local-6989586621680150457"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149549"><span id="local-6989586621680149552"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150457"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150457"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150456"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621680149541"><span class="annot"><span class="annottext">show :: Sub v x -&gt; String
</span><a href="#local-6989586621680149541"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span> </span><span id="local-6989586621680149540"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149540"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149539"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149539"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680149538"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149538"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-244"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680149537"><span class="annot"><span class="annottext">lexp :: String
</span><a href="#local-6989586621680149537"><span class="hs-identifier hs-var hs-var">lexp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149540"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; - &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149539"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-245"></span><span>            </span><span id="local-6989586621680149536"><span class="annot"><span class="annottext">rexp :: String
</span><a href="#local-6989586621680149536"><span class="hs-identifier hs-var hs-var">rexp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149538"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-246"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680149537"><span class="hs-identifier hs-var">lexp</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680149536"><span class="hs-identifier hs-var">rexp</span></a></span></span></span><span>
</span><span id="line-247"></span><span id="local-6989586621680149534"><span id="local-6989586621680149535"><span class="annot"><a href="NITTA.Intermediate.Functions.html#sub"><span class="hs-identifier hs-type">sub</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680149535"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Value.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680149534"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680149535"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680149535"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680149535"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680149535"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680149534"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-248"></span><span id="sub"><span class="annot"><span class="annottext">sub :: forall v x. (Var v, Val x) =&gt; v -&gt; v -&gt; [v] -&gt; F v x
</span><a href="NITTA.Intermediate.Functions.html#sub"><span class="hs-identifier hs-var hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621680149510"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149510"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149509"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149509"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680149508"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149508"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sub v x -&gt; F v x
forall {f} {v} {x}.
(Function f v, Patch f (v, v), Locks f v, Show f, Label f,
 FunctionSimulation f v x, Typeable f, Eq f) =&gt;
f -&gt; F v x
</span><a href="NITTA.Intermediate.Types.html#packF"><span class="hs-identifier hs-var">packF</span></a></span><span> </span><span class="annot"><span class="annottext">(Sub v x -&gt; F v x) -&gt; Sub v x -&gt; F v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; I v -&gt; O v -&gt; Sub v x
forall v x. I v -&gt; I v -&gt; O v -&gt; Sub v x
</span><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier hs-var">Sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; I v
forall v. v -&gt; I v
</span><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149510"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; I v
forall v. v -&gt; I v
</span><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149509"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(O v -&gt; Sub v x) -&gt; O v -&gt; Sub v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set v -&gt; O v
forall v. Set v -&gt; O v
</span><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-var">O</span></a></span><span> </span><span class="annot"><span class="annottext">(Set v -&gt; O v) -&gt; Set v -&gt; O v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[v] -&gt; Set v
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149508"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span id="local-6989586621680150446"><span id="local-6989586621680150447"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149504"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150447"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150447"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150446"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150447"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-251"></span><span>    </span><span id="local-6989586621680149500"><span class="annot"><span class="annottext">inputs :: Sub v x -&gt; Set v
</span><a href="#local-6989586621680149500"><span class="hs-identifier hs-var hs-var hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span> </span><span id="local-6989586621680149499"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149499"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149498"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149498"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680149497"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149497"><span class="hs-identifier hs-var">_c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149499"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Set v -&gt; Set v -&gt; Set v
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`union`</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149498"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621680149495"><span class="annot"><span class="annottext">outputs :: Sub v x -&gt; Set v
</span><a href="#local-6989586621680149495"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span> </span><span id="local-6989586621680149494"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149494"><span class="hs-identifier hs-var">_a</span></a></span></span><span> </span><span id="local-6989586621680149493"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149493"><span class="hs-identifier hs-var">_b</span></a></span></span><span> </span><span id="local-6989586621680149492"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149492"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149492"><span class="hs-identifier hs-var">c</span></a></span></span></span><span>
</span><span id="line-253"></span><span id="local-6989586621680150448"><span id="local-6989586621680150449"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150449"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Patch"><span class="hs-identifier hs-type">Patch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150449"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150448"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680150449"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680150449"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-254"></span><span>    </span><span id="local-6989586621680149484"><span class="annot"><span class="annottext">patch :: (v, v) -&gt; Sub v x -&gt; Sub v x
</span><a href="#local-6989586621680149484"><span class="hs-identifier hs-var hs-var hs-var hs-var">patch</span></a></span></span><span> </span><span id="local-6989586621680149483"><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149483"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span> </span><span id="local-6989586621680149482"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149482"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149481"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149481"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680149480"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149480"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; I v -&gt; O v -&gt; Sub v x
forall v x. I v -&gt; I v -&gt; O v -&gt; Sub v x
</span><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier hs-var">Sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; I v -&gt; I v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149483"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149482"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; I v -&gt; I v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149483"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149481"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; O v -&gt; O v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149483"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149480"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-255"></span><span id="local-6989586621680150450"><span id="local-6989586621680150451"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150451"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Locks"><span class="hs-identifier hs-type">Locks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150451"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150450"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150451"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-256"></span><span>    </span><span id="local-6989586621680149474"><span class="annot"><span class="annottext">locks :: Sub v x -&gt; [Lock v]
</span><a href="#local-6989586621680149474"><span class="hs-identifier hs-var hs-var hs-var hs-var">locks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sub v x -&gt; [Lock v]
forall {f} {v}. Function f v =&gt; f -&gt; [Lock v]
</span><a href="NITTA.Intermediate.Types.html#inputsLockOutputs"><span class="hs-identifier hs-var">inputsLockOutputs</span></a></span></span></span><span>
</span><span id="line-257"></span><span id="local-6989586621680150452"><span id="local-6989586621680150453"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150453"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680150452"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#FunctionSimulation"><span class="hs-identifier hs-type">FunctionSimulation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150453"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150452"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150453"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150452"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621680149459"><span class="annot"><span class="annottext">simulate :: CycleCntx v x -&gt; Sub v x -&gt; [(v, x)]
</span><a href="#local-6989586621680149459"><span class="hs-identifier hs-var hs-var hs-var hs-var">simulate</span></a></span></span><span> </span><span id="local-6989586621680149458"><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149458"><span class="hs-identifier hs-var">cntx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621680149457"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149457"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621680149456"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149456"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span id="local-6989586621680149455"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149455"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-259"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680149454"><span class="annot"><span class="annottext">x1 :: x
</span><a href="#local-6989586621680149454"><span class="hs-identifier hs-var hs-var">x1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149458"><span class="hs-identifier hs-var">cntx</span></a></span><span> </span><span class="annot"><span class="annottext">CycleCntx v x -&gt; v -&gt; x
forall {a} {v}.
(Eq a, Hashable a, ToString a) =&gt;
CycleCntx a v -&gt; a -&gt; v
</span><a href="NITTA.Intermediate.Types.html#getCntx"><span class="hs-operator hs-var">`getCntx`</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149457"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-260"></span><span>            </span><span id="local-6989586621680149453"><span class="annot"><span class="annottext">x2 :: x
</span><a href="#local-6989586621680149453"><span class="hs-identifier hs-var hs-var">x2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149458"><span class="hs-identifier hs-var">cntx</span></a></span><span> </span><span class="annot"><span class="annottext">CycleCntx v x -&gt; v -&gt; x
forall {a} {v}.
(Eq a, Hashable a, ToString a) =&gt;
CycleCntx a v -&gt; a -&gt; v
</span><a href="NITTA.Intermediate.Types.html#getCntx"><span class="hs-operator hs-var">`getCntx`</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149456"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-261"></span><span>            </span><span id="local-6989586621680149452"><span class="annot"><span class="annottext">y :: x
</span><a href="#local-6989586621680149452"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149454"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; x -&gt; x
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149453"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-262"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149451"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149452"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680149451"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149451"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; [v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149455"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-keyword">data</span><span> </span><span id="Multiply"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-var">Multiply</span></a></span></span><span> </span><span id="local-6989586621680150439"><span class="annot"><a href="#local-6989586621680150439"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680150438"><span class="annot"><a href="#local-6989586621680150438"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Multiply"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-var">Multiply</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150439"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150439"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150439"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680149443"><span id="local-6989586621680149448"><span class="annot"><span class="annottext">Multiply v x -&gt; Multiply v x -&gt; Bool
(Multiply v x -&gt; Multiply v x -&gt; Bool)
-&gt; (Multiply v x -&gt; Multiply v x -&gt; Bool) -&gt; Eq (Multiply v x)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v x. Eq v =&gt; Multiply v x -&gt; Multiply v x -&gt; Bool
/= :: Multiply v x -&gt; Multiply v x -&gt; Bool
$c/= :: forall v x. Eq v =&gt; Multiply v x -&gt; Multiply v x -&gt; Bool
== :: Multiply v x -&gt; Multiply v x -&gt; Bool
$c== :: forall v x. Eq v =&gt; Multiply v x -&gt; Multiply v x -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span id="local-6989586621680150434"><span id="local-6989586621680150435"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-type">Multiply</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150435"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150434"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680149440"><span class="annot"><span class="annottext">label :: Multiply v x -&gt; String
</span><a href="#local-6989586621680149440"><span class="hs-keyword hs-var hs-var hs-var hs-var">label</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-type">Multiply</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*&quot;</span></span></span></span><span>
</span><span id="line-266"></span><span id="local-6989586621680150432"><span id="local-6989586621680150433"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149435"><span id="local-6989586621680149438"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150433"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-type">Multiply</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150433"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150432"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-267"></span><span>    </span><span id="local-6989586621680149427"><span class="annot"><span class="annottext">show :: Multiply v x -&gt; String
</span><a href="#local-6989586621680149427"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-type">Multiply</span></a></span><span> </span><span id="local-6989586621680149426"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149426"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149425"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149425"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680149424"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149424"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-268"></span><span>        </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149426"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; * &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149425"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">O v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149424"><span class="hs-identifier hs-var">c</span></a></span></span></span><span>
</span><span id="line-269"></span><span id="local-6989586621680149422"><span id="local-6989586621680149423"><span class="annot"><a href="NITTA.Intermediate.Functions.html#multiply"><span class="hs-identifier hs-type">multiply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680149423"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Value.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680149422"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680149423"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680149423"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680149423"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680149423"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680149422"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-270"></span><span id="multiply"><span class="annot"><span class="annottext">multiply :: forall v x. (Var v, Val x) =&gt; v -&gt; v -&gt; [v] -&gt; F v x
</span><a href="NITTA.Intermediate.Functions.html#multiply"><span class="hs-identifier hs-var hs-var">multiply</span></a></span></span><span> </span><span id="local-6989586621680149398"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149398"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149397"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149397"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680149396"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149396"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Multiply v x -&gt; F v x
forall {f} {v} {x}.
(Function f v, Patch f (v, v), Locks f v, Show f, Label f,
 FunctionSimulation f v x, Typeable f, Eq f) =&gt;
f -&gt; F v x
</span><a href="NITTA.Intermediate.Types.html#packF"><span class="hs-identifier hs-var">packF</span></a></span><span> </span><span class="annot"><span class="annottext">(Multiply v x -&gt; F v x) -&gt; Multiply v x -&gt; F v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; I v -&gt; O v -&gt; Multiply v x
forall v x. I v -&gt; I v -&gt; O v -&gt; Multiply v x
</span><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-var">Multiply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; I v
forall v. v -&gt; I v
</span><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149398"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; I v
forall v. v -&gt; I v
</span><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149397"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(O v -&gt; Multiply v x) -&gt; O v -&gt; Multiply v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set v -&gt; O v
forall v. Set v -&gt; O v
</span><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-var">O</span></a></span><span> </span><span class="annot"><span class="annottext">(Set v -&gt; O v) -&gt; Set v -&gt; O v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[v] -&gt; Set v
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149396"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span id="local-6989586621680150422"><span id="local-6989586621680150423"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149392"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150423"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-type">Multiply</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150423"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150422"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150423"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621680149388"><span class="annot"><span class="annottext">inputs :: Multiply v x -&gt; Set v
</span><a href="#local-6989586621680149388"><span class="hs-identifier hs-var hs-var hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-type">Multiply</span></a></span><span> </span><span id="local-6989586621680149387"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149387"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149386"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149386"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680149385"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149385"><span class="hs-identifier hs-var">_c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149387"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Set v -&gt; Set v -&gt; Set v
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`union`</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149386"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621680149383"><span class="annot"><span class="annottext">outputs :: Multiply v x -&gt; Set v
</span><a href="#local-6989586621680149383"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-type">Multiply</span></a></span><span> </span><span id="local-6989586621680149382"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149382"><span class="hs-identifier hs-var">_a</span></a></span></span><span> </span><span id="local-6989586621680149381"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149381"><span class="hs-identifier hs-var">_b</span></a></span></span><span> </span><span id="local-6989586621680149380"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149380"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149380"><span class="hs-identifier hs-var">c</span></a></span></span></span><span>
</span><span id="line-275"></span><span id="local-6989586621680150424"><span id="local-6989586621680150425"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150425"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Patch"><span class="hs-identifier hs-type">Patch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-type">Multiply</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150425"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150424"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680150425"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680150425"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621680149372"><span class="annot"><span class="annottext">patch :: (v, v) -&gt; Multiply v x -&gt; Multiply v x
</span><a href="#local-6989586621680149372"><span class="hs-identifier hs-var hs-var hs-var hs-var">patch</span></a></span></span><span> </span><span id="local-6989586621680149371"><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149371"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-type">Multiply</span></a></span><span> </span><span id="local-6989586621680149370"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149370"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149369"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149369"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680149368"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149368"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; I v -&gt; O v -&gt; Multiply v x
forall v x. I v -&gt; I v -&gt; O v -&gt; Multiply v x
</span><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-var">Multiply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; I v -&gt; I v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149371"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149370"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; I v -&gt; I v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149371"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149369"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; O v -&gt; O v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149371"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149368"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-277"></span><span id="local-6989586621680150426"><span id="local-6989586621680150427"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150427"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Locks"><span class="hs-identifier hs-type">Locks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-type">Multiply</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150427"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150426"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150427"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-278"></span><span>    </span><span id="local-6989586621680149362"><span class="annot"><span class="annottext">locks :: Multiply v x -&gt; [Lock v]
</span><a href="#local-6989586621680149362"><span class="hs-identifier hs-var hs-var hs-var hs-var">locks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Multiply v x -&gt; [Lock v]
forall {f} {v}. Function f v =&gt; f -&gt; [Lock v]
</span><a href="NITTA.Intermediate.Types.html#inputsLockOutputs"><span class="hs-identifier hs-var">inputsLockOutputs</span></a></span></span></span><span>
</span><span id="line-279"></span><span id="local-6989586621680150428"><span id="local-6989586621680150429"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150429"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680150428"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#FunctionSimulation"><span class="hs-identifier hs-type">FunctionSimulation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-type">Multiply</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150429"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150428"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150429"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150428"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621680149347"><span class="annot"><span class="annottext">simulate :: CycleCntx v x -&gt; Multiply v x -&gt; [(v, x)]
</span><a href="#local-6989586621680149347"><span class="hs-identifier hs-var hs-var hs-var hs-var">simulate</span></a></span></span><span> </span><span id="local-6989586621680149346"><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149346"><span class="hs-identifier hs-var">cntx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Multiply"><span class="hs-identifier hs-type">Multiply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621680149345"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149345"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621680149344"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149344"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span id="local-6989586621680149343"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149343"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-281"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680149342"><span class="annot"><span class="annottext">x1 :: x
</span><a href="#local-6989586621680149342"><span class="hs-identifier hs-var hs-var">x1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149346"><span class="hs-identifier hs-var">cntx</span></a></span><span> </span><span class="annot"><span class="annottext">CycleCntx v x -&gt; v -&gt; x
forall {a} {v}.
(Eq a, Hashable a, ToString a) =&gt;
CycleCntx a v -&gt; a -&gt; v
</span><a href="NITTA.Intermediate.Types.html#getCntx"><span class="hs-operator hs-var">`getCntx`</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149345"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-282"></span><span>            </span><span id="local-6989586621680149341"><span class="annot"><span class="annottext">x2 :: x
</span><a href="#local-6989586621680149341"><span class="hs-identifier hs-var hs-var">x2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149346"><span class="hs-identifier hs-var">cntx</span></a></span><span> </span><span class="annot"><span class="annottext">CycleCntx v x -&gt; v -&gt; x
forall {a} {v}.
(Eq a, Hashable a, ToString a) =&gt;
CycleCntx a v -&gt; a -&gt; v
</span><a href="NITTA.Intermediate.Types.html#getCntx"><span class="hs-operator hs-var">`getCntx`</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149344"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-283"></span><span>            </span><span id="local-6989586621680149340"><span class="annot"><span class="annottext">y :: x
</span><a href="#local-6989586621680149340"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149342"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; x -&gt; x
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149341"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-284"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149338"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149340"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680149338"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149338"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; [v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149343"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-keyword">data</span><span> </span><span id="Division"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier hs-var">Division</span></a></span></span><span> </span><span id="local-6989586621680150415"><span class="annot"><a href="#local-6989586621680150415"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680150414"><span class="annot"><a href="#local-6989586621680150414"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Division"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier hs-var">Division</span></a></span></span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Adenom%3ADivision"><span class="annot"><span class="annottext">forall v x. Division v x -&gt; I v
</span><a href="NITTA.Intermediate.Functions.html#%24sel%3Adenom%3ADivision"><span class="hs-identifier hs-var hs-var">denom</span></a></span></span><span class="hs-special">,</span><span> </span><span id="%24sel%3Anumer%3ADivision"><span class="annot"><span class="annottext">forall v x. Division v x -&gt; I v
</span><a href="NITTA.Intermediate.Functions.html#%24sel%3Anumer%3ADivision"><span class="hs-identifier hs-var hs-var">numer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150415"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aquotient%3ADivision"><span class="annot"><span class="annottext">forall v x. Division v x -&gt; O v
</span><a href="NITTA.Intermediate.Functions.html#%24sel%3Aquotient%3ADivision"><span class="hs-identifier hs-var hs-var">quotient</span></a></span></span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aremain%3ADivision"><span class="annot"><span class="annottext">forall v x. Division v x -&gt; O v
</span><a href="NITTA.Intermediate.Functions.html#%24sel%3Aremain%3ADivision"><span class="hs-identifier hs-var hs-var">remain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150415"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680149325"><span id="local-6989586621680149331"><span class="annot"><span class="annottext">Division v x -&gt; Division v x -&gt; Bool
(Division v x -&gt; Division v x -&gt; Bool)
-&gt; (Division v x -&gt; Division v x -&gt; Bool) -&gt; Eq (Division v x)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v x. Eq v =&gt; Division v x -&gt; Division v x -&gt; Bool
/= :: Division v x -&gt; Division v x -&gt; Bool
$c/= :: forall v x. Eq v =&gt; Division v x -&gt; Division v x -&gt; Bool
== :: Division v x -&gt; Division v x -&gt; Bool
$c== :: forall v x. Eq v =&gt; Division v x -&gt; Division v x -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span id="local-6989586621680150402"><span id="local-6989586621680150403"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier hs-type">Division</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150403"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150402"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680149322"><span class="annot"><span class="annottext">label :: Division v x -&gt; String
</span><a href="#local-6989586621680149322"><span class="hs-keyword hs-var hs-var hs-var hs-var">label</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier hs-type">Division</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span></span></span><span>
</span><span id="line-292"></span><span id="local-6989586621680150400"><span id="local-6989586621680150401"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149317"><span id="local-6989586621680149320"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150401"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier hs-type">Division</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150401"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150400"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621680149300"><span class="annot"><span class="annottext">show :: Division v x -&gt; String
</span><a href="#local-6989586621680149300"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier hs-type">Division</span></a></span><span class="hs-special">{</span><span id="local-6989586621680149299"><span class="annot"><span class="annottext">I v
denom :: I v
$sel:denom:Division :: forall v x. Division v x -&gt; I v
</span><a href="#local-6989586621680149299"><span class="hs-identifier hs-var hs-var">denom</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680149298"><span class="annot"><span class="annottext">I v
numer :: I v
$sel:numer:Division :: forall v x. Division v x -&gt; I v
</span><a href="#local-6989586621680149298"><span class="hs-identifier hs-var hs-var">numer</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680149297"><span class="annot"><span class="annottext">O v
quotient :: O v
$sel:quotient:Division :: forall v x. Division v x -&gt; O v
</span><a href="#local-6989586621680149297"><span class="hs-identifier hs-var hs-var">quotient</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680149296"><span class="annot"><span class="annottext">O v
remain :: O v
$sel:remain:Division :: forall v x. Division v x -&gt; O v
</span><a href="#local-6989586621680149296"><span class="hs-identifier hs-var hs-var">remain</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-294"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680149295"><span class="annot"><span class="annottext">q :: String
</span><a href="#local-6989586621680149295"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149298"><span class="hs-identifier hs-var">numer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; / &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149299"><span class="hs-identifier hs-var">denom</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">O v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149297"><span class="hs-identifier hs-var">quotient</span></a></span><span>
</span><span id="line-295"></span><span>            </span><span id="local-6989586621680149294"><span class="annot"><span class="annottext">r :: String
</span><a href="#local-6989586621680149294"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149298"><span class="hs-identifier hs-var">numer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; mod &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149299"><span class="hs-identifier hs-var">denom</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">O v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149296"><span class="hs-identifier hs-var">remain</span></a></span><span>
</span><span id="line-296"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680149295"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680149294"><span class="hs-identifier hs-var">r</span></a></span></span></span><span>
</span><span id="line-297"></span><span id="local-6989586621680150398"><span id="local-6989586621680150399"><span class="annot"><a href="NITTA.Intermediate.Functions.html#division"><span class="hs-identifier hs-type">division</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150399"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Value.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150398"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680150399"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680150399"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680150399"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680150399"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150399"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150398"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-298"></span><span id="division"><span class="annot"><span class="annottext">division :: forall v x. (Var v, Val x) =&gt; v -&gt; v -&gt; [v] -&gt; [v] -&gt; F v x
</span><a href="NITTA.Intermediate.Functions.html#division"><span class="hs-identifier hs-var hs-var">division</span></a></span></span><span> </span><span id="local-6989586621680149271"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149271"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680149270"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149270"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680149269"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149269"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621680149268"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149268"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><span class="annottext">Division v x -&gt; F v x
forall {f} {v} {x}.
(Function f v, Patch f (v, v), Locks f v, Show f, Label f,
 FunctionSimulation f v x, Typeable f, Eq f) =&gt;
f -&gt; F v x
</span><a href="NITTA.Intermediate.Types.html#packF"><span class="hs-identifier hs-var">packF</span></a></span><span> </span><span class="annot"><span class="annottext">(Division v x -&gt; F v x) -&gt; Division v x -&gt; F v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-300"></span><span>        </span><span class="annot"><span class="annottext">Division :: forall v x. I v -&gt; I v -&gt; O v -&gt; O v -&gt; Division v x
</span><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier hs-type">Division</span></a></span><span>
</span><span id="line-301"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:denom:Division :: I v
</span><a href="NITTA.Intermediate.Functions.html#%24sel%3Adenom%3ADivision"><span class="hs-identifier hs-var">denom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; I v
forall v. v -&gt; I v
</span><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149271"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-302"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:numer:Division :: I v
</span><a href="NITTA.Intermediate.Functions.html#%24sel%3Anumer%3ADivision"><span class="hs-identifier hs-var">numer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; I v
forall v. v -&gt; I v
</span><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149270"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-303"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:quotient:Division :: O v
</span><a href="NITTA.Intermediate.Functions.html#%24sel%3Aquotient%3ADivision"><span class="hs-identifier hs-var">quotient</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; O v
forall v. Set v -&gt; O v
</span><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-var">O</span></a></span><span> </span><span class="annot"><span class="annottext">(Set v -&gt; O v) -&gt; Set v -&gt; O v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[v] -&gt; Set v
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149269"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-304"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:remain:Division :: O v
</span><a href="NITTA.Intermediate.Functions.html#%24sel%3Aremain%3ADivision"><span class="hs-identifier hs-var">remain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; O v
forall v. Set v -&gt; O v
</span><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-var">O</span></a></span><span> </span><span class="annot"><span class="annottext">(Set v -&gt; O v) -&gt; Set v -&gt; O v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[v] -&gt; Set v
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149268"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-305"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span id="local-6989586621680150388"><span id="local-6989586621680150389"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149264"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150389"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier hs-type">Division</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150389"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150388"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150389"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-308"></span><span>    </span><span id="local-6989586621680149260"><span class="annot"><span class="annottext">inputs :: Division v x -&gt; Set v
</span><a href="#local-6989586621680149260"><span class="hs-identifier hs-var hs-var hs-var hs-var">inputs</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier hs-type">Division</span></a></span><span class="hs-special">{</span><span id="local-6989586621680149259"><span class="annot"><span class="annottext">I v
denom :: I v
$sel:denom:Division :: forall v x. Division v x -&gt; I v
</span><a href="#local-6989586621680149259"><span class="hs-identifier hs-var hs-var">denom</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680149258"><span class="annot"><span class="annottext">I v
numer :: I v
$sel:numer:Division :: forall v x. Division v x -&gt; I v
</span><a href="#local-6989586621680149258"><span class="hs-identifier hs-var hs-var">numer</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149259"><span class="hs-identifier hs-var">denom</span></a></span><span> </span><span class="annot"><span class="annottext">Set v -&gt; Set v -&gt; Set v
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`union`</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149258"><span class="hs-identifier hs-var">numer</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621680149254"><span class="annot"><span class="annottext">outputs :: Division v x -&gt; Set v
</span><a href="#local-6989586621680149254"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputs</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier hs-type">Division</span></a></span><span class="hs-special">{</span><span id="local-6989586621680149253"><span class="annot"><span class="annottext">O v
quotient :: O v
$sel:quotient:Division :: forall v x. Division v x -&gt; O v
</span><a href="#local-6989586621680149253"><span class="hs-identifier hs-var hs-var">quotient</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680149252"><span class="annot"><span class="annottext">O v
remain :: O v
$sel:remain:Division :: forall v x. Division v x -&gt; O v
</span><a href="#local-6989586621680149252"><span class="hs-identifier hs-var hs-var">remain</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149253"><span class="hs-identifier hs-var">quotient</span></a></span><span> </span><span class="annot"><span class="annottext">Set v -&gt; Set v -&gt; Set v
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`union`</span></span><span> </span><span class="annot"><span class="annottext">O v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149252"><span class="hs-identifier hs-var">remain</span></a></span></span></span><span>
</span><span id="line-310"></span><span id="local-6989586621680150390"><span id="local-6989586621680150391"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150391"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Patch"><span class="hs-identifier hs-type">Patch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier hs-type">Division</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150391"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150390"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680150391"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680150391"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-311"></span><span>    </span><span id="local-6989586621680149243"><span class="annot"><span class="annottext">patch :: (v, v) -&gt; Division v x -&gt; Division v x
</span><a href="#local-6989586621680149243"><span class="hs-identifier hs-var hs-var hs-var hs-var">patch</span></a></span></span><span> </span><span id="local-6989586621680149242"><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149242"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier hs-type">Division</span></a></span><span> </span><span id="local-6989586621680149241"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149241"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680149240"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149240"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680149239"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149239"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621680149238"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149238"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; I v -&gt; O v -&gt; O v -&gt; Division v x
forall v x. I v -&gt; I v -&gt; O v -&gt; O v -&gt; Division v x
</span><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier hs-var">Division</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; I v -&gt; I v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149242"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149241"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; I v -&gt; I v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149242"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149240"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; O v -&gt; O v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149242"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149239"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; O v -&gt; O v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149242"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149238"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-312"></span><span id="local-6989586621680150392"><span id="local-6989586621680150393"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150393"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Locks"><span class="hs-identifier hs-type">Locks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier hs-type">Division</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150393"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150392"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150393"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>    </span><span id="local-6989586621680149232"><span class="annot"><span class="annottext">locks :: Division v x -&gt; [Lock v]
</span><a href="#local-6989586621680149232"><span class="hs-identifier hs-var hs-var hs-var hs-var">locks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Division v x -&gt; [Lock v]
forall {f} {v}. Function f v =&gt; f -&gt; [Lock v]
</span><a href="NITTA.Intermediate.Types.html#inputsLockOutputs"><span class="hs-identifier hs-var">inputsLockOutputs</span></a></span></span></span><span>
</span><span id="line-314"></span><span id="local-6989586621680150394"><span id="local-6989586621680150395"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150395"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621680150394"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#FunctionSimulation"><span class="hs-identifier hs-type">FunctionSimulation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier hs-type">Division</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150395"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150394"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150395"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150394"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-315"></span><span>    </span><span id="local-6989586621680149217"><span class="annot"><span class="annottext">simulate :: CycleCntx v x -&gt; Division v x -&gt; [(v, x)]
</span><a href="#local-6989586621680149217"><span class="hs-identifier hs-var hs-var hs-var hs-var">simulate</span></a></span></span><span> </span><span id="local-6989586621680149216"><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149216"><span class="hs-identifier hs-var">cntx</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Division"><span class="hs-identifier hs-type">Division</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:denom:Division :: forall v x. Division v x -&gt; I v
</span><a href="NITTA.Intermediate.Functions.html#%24sel%3Adenom%3ADivision"><span class="hs-identifier hs-var">denom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621680149215"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149215"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:numer:Division :: forall v x. Division v x -&gt; I v
</span><a href="NITTA.Intermediate.Functions.html#%24sel%3Anumer%3ADivision"><span class="hs-identifier hs-var">numer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621680149214"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149214"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:quotient:Division :: forall v x. Division v x -&gt; O v
</span><a href="NITTA.Intermediate.Functions.html#%24sel%3Aquotient%3ADivision"><span class="hs-identifier hs-var">quotient</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span id="local-6989586621680149213"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149213"><span class="hs-identifier hs-var">qs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:remain:Division :: forall v x. Division v x -&gt; O v
</span><a href="NITTA.Intermediate.Functions.html#%24sel%3Aremain%3ADivision"><span class="hs-identifier hs-var">remain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span id="local-6989586621680149212"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149212"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-316"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680149211"><span class="annot"><span class="annottext">dx :: x
</span><a href="#local-6989586621680149211"><span class="hs-identifier hs-var hs-var">dx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149216"><span class="hs-identifier hs-var">cntx</span></a></span><span> </span><span class="annot"><span class="annottext">CycleCntx v x -&gt; v -&gt; x
forall {a} {v}.
(Eq a, Hashable a, ToString a) =&gt;
CycleCntx a v -&gt; a -&gt; v
</span><a href="NITTA.Intermediate.Types.html#getCntx"><span class="hs-operator hs-var">`getCntx`</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149215"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-317"></span><span>            </span><span id="local-6989586621680149210"><span class="annot"><span class="annottext">nx :: x
</span><a href="#local-6989586621680149210"><span class="hs-identifier hs-var hs-var">nx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149216"><span class="hs-identifier hs-var">cntx</span></a></span><span> </span><span class="annot"><span class="annottext">CycleCntx v x -&gt; v -&gt; x
forall {a} {v}.
(Eq a, Hashable a, ToString a) =&gt;
CycleCntx a v -&gt; a -&gt; v
</span><a href="NITTA.Intermediate.Types.html#getCntx"><span class="hs-operator hs-var">`getCntx`</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149214"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-318"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621680149209"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149209"><span class="hs-identifier hs-var">qx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680149208"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149208"><span class="hs-identifier hs-var">rx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149211"><span class="hs-identifier hs-var">dx</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; x -&gt; (x, x)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`quotRem`</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149210"><span class="hs-identifier hs-var">nx</span></a></span><span>
</span><span id="line-319"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149206"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149209"><span class="hs-identifier hs-var">qx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680149206"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149206"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; [v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149213"><span class="hs-identifier hs-var">qs</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(v, x)] -&gt; [(v, x)] -&gt; [(v, x)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149205"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149208"><span class="hs-identifier hs-var">rx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680149205"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149205"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; [v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149212"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="hs-keyword">data</span><span> </span><span id="Neg"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span></span><span> </span><span id="local-6989586621680150380"><span class="annot"><a href="#local-6989586621680150380"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680150379"><span class="annot"><a href="#local-6989586621680150379"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Neg"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150380"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150380"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680149198"><span id="local-6989586621680149202"><span class="annot"><span class="annottext">Neg v x -&gt; Neg v x -&gt; Bool
(Neg v x -&gt; Neg v x -&gt; Bool)
-&gt; (Neg v x -&gt; Neg v x -&gt; Bool) -&gt; Eq (Neg v x)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v x. Eq v =&gt; Neg v x -&gt; Neg v x -&gt; Bool
/= :: Neg v x -&gt; Neg v x -&gt; Bool
$c/= :: forall v x. Eq v =&gt; Neg v x -&gt; Neg v x -&gt; Bool
== :: Neg v x -&gt; Neg v x -&gt; Bool
$c== :: forall v x. Eq v =&gt; Neg v x -&gt; Neg v x -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span id="local-6989586621680150375"><span id="local-6989586621680150376"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150376"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150375"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680149195"><span class="annot"><span class="annottext">label :: Neg v x -&gt; String
</span><a href="#local-6989586621680149195"><span class="hs-keyword hs-var hs-var hs-var hs-var">label</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;neg&quot;</span></span></span></span><span>
</span><span id="line-323"></span><span id="local-6989586621680150373"><span id="local-6989586621680150374"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149190"><span id="local-6989586621680149193"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150374"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150374"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150373"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621680149184"><span class="annot"><span class="annottext">show :: Neg v x -&gt; String
</span><a href="#local-6989586621680149184"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span> </span><span id="local-6989586621680149183"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149183"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680149182"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149182"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149183"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">O v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149182"><span class="hs-identifier hs-var">o</span></a></span></span></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span id="local-6989586621680149180"><span id="local-6989586621680149181"><span class="annot"><a href="NITTA.Intermediate.Functions.html#neg"><span class="hs-identifier hs-type">neg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680149181"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Value.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680149180"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680149181"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680149181"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680149181"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680149180"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-327"></span><span id="neg"><span class="annot"><span class="annottext">neg :: forall v x. (Var v, Val x) =&gt; v -&gt; [v] -&gt; F v x
</span><a href="NITTA.Intermediate.Functions.html#neg"><span class="hs-identifier hs-var hs-var">neg</span></a></span></span><span> </span><span id="local-6989586621680149156"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149156"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680149155"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149155"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Neg v x -&gt; F v x
forall {f} {v} {x}.
(Function f v, Patch f (v, v), Locks f v, Show f, Label f,
 FunctionSimulation f v x, Typeable f, Eq f) =&gt;
f -&gt; F v x
</span><a href="NITTA.Intermediate.Types.html#packF"><span class="hs-identifier hs-var">packF</span></a></span><span> </span><span class="annot"><span class="annottext">(Neg v x -&gt; F v x) -&gt; Neg v x -&gt; F v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; O v -&gt; Neg v x
forall v x. I v -&gt; O v -&gt; Neg v x
</span><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; I v
forall v. v -&gt; I v
</span><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149156"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(O v -&gt; Neg v x) -&gt; O v -&gt; Neg v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set v -&gt; O v
forall v. Set v -&gt; O v
</span><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-var">O</span></a></span><span> </span><span class="annot"><span class="annottext">(Set v -&gt; O v) -&gt; Set v -&gt; O v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[v] -&gt; Set v
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149155"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span id="local-6989586621680150363"><span id="local-6989586621680150364"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149151"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680150364"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150364"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150363"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150364"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-330"></span><span>    </span><span id="local-6989586621680149149"><span class="annot"><span class="annottext">inputs :: Neg v x -&gt; Set v
</span><a href="#local-6989586621680149149"><span class="hs-identifier hs-var hs-var hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span> </span><span id="local-6989586621680149148"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149148"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">O v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149148"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-331"></span><span>    </span><span id="local-6989586621680149146"><span class="annot"><span class="annottext">outputs :: Neg v x -&gt; Set v
</span><a href="#local-6989586621680149146"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680149145"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149145"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149145"><span class="hs-identifier hs-var">o</span></a></span></span></span><span>
</span><span id="line-332"></span><span id="local-6989586621680150365"><span id="local-6989586621680150366"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680150366"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Patch"><span class="hs-identifier hs-type">Patch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150366"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150365"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680150366"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680150366"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-333"></span><span>    </span><span id="local-6989586621680149139"><span class="annot"><span class="annottext">patch :: (v, v) -&gt; Neg v x -&gt; Neg v x
</span><a href="#local-6989586621680149139"><span class="hs-identifier hs-var hs-var hs-var hs-var">patch</span></a></span></span><span> </span><span id="local-6989586621680149138"><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149138"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span> </span><span id="local-6989586621680149137"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149137"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680149136"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149136"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; O v -&gt; Neg v x
forall v x. I v -&gt; O v -&gt; Neg v x
</span><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; I v -&gt; I v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149138"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680149137"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; O v -&gt; O v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149138"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149136"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-334"></span><span id="local-6989586621680150367"><span id="local-6989586621680150368"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150368"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Locks"><span class="hs-identifier hs-type">Locks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150368"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150367"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150368"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-335"></span><span>    </span><span id="local-6989586621680149129"><span class="annot"><span class="annottext">locks :: Neg v x -&gt; [Lock v]
</span><a href="#local-6989586621680149129"><span class="hs-identifier hs-var hs-var hs-var hs-var">locks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Neg v x -&gt; [Lock v]
forall {f} {v}. Function f v =&gt; f -&gt; [Lock v]
</span><a href="NITTA.Intermediate.Types.html#inputsLockOutputs"><span class="hs-identifier hs-var">inputsLockOutputs</span></a></span></span></span><span>
</span><span id="line-336"></span><span id="local-6989586621680150369"><span id="local-6989586621680150370"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150370"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680150369"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#FunctionSimulation"><span class="hs-identifier hs-type">FunctionSimulation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150370"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150369"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150370"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150369"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-337"></span><span>    </span><span id="local-6989586621680149117"><span class="annot"><span class="annottext">simulate :: CycleCntx v x -&gt; Neg v x -&gt; [(v, x)]
</span><a href="#local-6989586621680149117"><span class="hs-identifier hs-var hs-var hs-var hs-var">simulate</span></a></span></span><span> </span><span id="local-6989586621680149116"><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149116"><span class="hs-identifier hs-var">cntx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621680149115"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149115"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span id="local-6989586621680149114"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149114"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-338"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680149113"><span class="annot"><span class="annottext">x1 :: x
</span><a href="#local-6989586621680149113"><span class="hs-identifier hs-var hs-var">x1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149116"><span class="hs-identifier hs-var">cntx</span></a></span><span> </span><span class="annot"><span class="annottext">CycleCntx v x -&gt; v -&gt; x
forall {a} {v}.
(Eq a, Hashable a, ToString a) =&gt;
CycleCntx a v -&gt; a -&gt; v
</span><a href="NITTA.Intermediate.Types.html#getCntx"><span class="hs-operator hs-var">`getCntx`</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149115"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-339"></span><span>            </span><span id="local-6989586621680149112"><span class="annot"><span class="annottext">y :: x
</span><a href="#local-6989586621680149112"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149113"><span class="hs-identifier hs-var">x1</span></a></span><span>
</span><span id="line-340"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149111"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149112"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680149111"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149111"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; [v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149114"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-keyword">data</span><span> </span><span id="Constant"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier hs-var">Constant</span></a></span></span><span> </span><span id="local-6989586621680150355"><span class="annot"><a href="#local-6989586621680150355"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680150356"><span class="annot"><a href="#local-6989586621680150356"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Constant"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier hs-var">Constant</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150356"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150355"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680149104"><span id="local-6989586621680149108"><span class="annot"><span class="annottext">Constant v x -&gt; Constant v x -&gt; Bool
(Constant v x -&gt; Constant v x -&gt; Bool)
-&gt; (Constant v x -&gt; Constant v x -&gt; Bool) -&gt; Eq (Constant v x)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v x. (Eq x, Eq v) =&gt; Constant v x -&gt; Constant v x -&gt; Bool
/= :: Constant v x -&gt; Constant v x -&gt; Bool
$c/= :: forall v x. (Eq x, Eq v) =&gt; Constant v x -&gt; Constant v x -&gt; Bool
== :: Constant v x -&gt; Constant v x -&gt; Bool
$c== :: forall v x. (Eq x, Eq v) =&gt; Constant v x -&gt; Constant v x -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span id="local-6989586621680150351"><span id="local-6989586621680150352"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680150352"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150351"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150352"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680149099"><span class="annot"><span class="annottext">label :: Constant v x -&gt; String
</span><a href="#local-6989586621680149099"><span class="hs-keyword hs-var hs-var hs-var hs-var">label</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span id="local-6989586621680149098"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149098"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">O v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149098"><span class="hs-identifier hs-var">x</span></a></span></span></span><span>
</span><span id="line-344"></span><span id="local-6989586621680150349"><span id="local-6989586621680150350"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149093"><span id="local-6989586621680149096"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150350"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680150349"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150350"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150349"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-345"></span><span>    </span><span id="local-6989586621680149087"><span class="annot"><span class="annottext">show :: Constant v x -&gt; String
</span><a href="#local-6989586621680149087"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span id="local-6989586621680149086"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149086"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680149085"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149085"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;const(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">x -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149086"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;) = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">O v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149085"><span class="hs-identifier hs-var">os</span></a></span></span></span><span>
</span><span id="line-346"></span><span id="local-6989586621680150347"><span id="local-6989586621680150348"><span class="annot"><a href="NITTA.Intermediate.Functions.html#constant"><span class="hs-identifier hs-type">constant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150348"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Value.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150347"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680150347"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680150348"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150348"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150347"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-347"></span><span id="constant"><span class="annot"><span class="annottext">constant :: forall v x. (Var v, Val x) =&gt; x -&gt; [v] -&gt; F v x
</span><a href="NITTA.Intermediate.Functions.html#constant"><span class="hs-identifier hs-var hs-var">constant</span></a></span></span><span> </span><span id="local-6989586621680149059"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149059"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621680149058"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149058"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Constant v x -&gt; F v x
forall {f} {v} {x}.
(Function f v, Patch f (v, v), Locks f v, Show f, Label f,
 FunctionSimulation f v x, Typeable f, Eq f) =&gt;
f -&gt; F v x
</span><a href="NITTA.Intermediate.Types.html#packF"><span class="hs-identifier hs-var">packF</span></a></span><span> </span><span class="annot"><span class="annottext">(Constant v x -&gt; F v x) -&gt; Constant v x -&gt; F v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">X x -&gt; O v -&gt; Constant v x
forall v x. X x -&gt; O v -&gt; Constant v x
</span><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier hs-var">Constant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; X x
forall x. x -&gt; X x
</span><a href="NITTA.Intermediate.Types.html#X"><span class="hs-identifier hs-var">X</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149059"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(O v -&gt; Constant v x) -&gt; O v -&gt; Constant v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set v -&gt; O v
forall v. Set v -&gt; O v
</span><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-var">O</span></a></span><span> </span><span class="annot"><span class="annottext">(Set v -&gt; O v) -&gt; Set v -&gt; O v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[v] -&gt; Set v
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680149058"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-348"></span><span id="isConst"><span class="annot"><span class="annottext">isConst :: F v x -&gt; Bool
</span><a href="NITTA.Intermediate.Functions.html#isConst"><span class="hs-identifier hs-var hs-var">isConst</span></a></span></span><span> </span><span id="local-6989586621680149052"><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680149052"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">F v x -&gt; Maybe (Constant v x)
forall (f :: * -&gt; * -&gt; *) v x.
(Typeable f, Typeable v, Typeable x) =&gt;
F v x -&gt; Maybe (f v x)
</span><a href="NITTA.Intermediate.Types.html#castF"><span class="hs-identifier hs-var">castF</span></a></span><span> </span><span class="annot"><span class="annottext">F v x
</span><a href="#local-6989586621680149052"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span id="local-6989586621680150337"><span id="local-6989586621680150338"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149047"><span id="local-6989586621680149050"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680150338"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621680150338"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621680150338"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150337"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150338"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150337"><span class="hs-identifier hs-type">v</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-353"></span><span>    </span><span id="local-6989586621680149045"><span class="annot"><span class="annottext">outputs :: Constant v x -&gt; Set v
</span><a href="#local-6989586621680149045"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="annot"><span class="annottext">X x
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680149044"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149044"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149044"><span class="hs-identifier hs-var">o</span></a></span></span></span><span>
</span><span id="line-354"></span><span id="local-6989586621680150339"><span id="local-6989586621680150340"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150340"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Patch"><span class="hs-identifier hs-type">Patch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150340"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150339"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680150340"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680150340"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>    </span><span id="local-6989586621680149039"><span class="annot"><span class="annottext">patch :: (v, v) -&gt; Constant v x -&gt; Constant v x
</span><a href="#local-6989586621680149039"><span class="hs-identifier hs-var hs-var hs-var hs-var">patch</span></a></span></span><span> </span><span id="local-6989586621680149038"><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149038"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span id="local-6989586621680149037"><span class="annot"><span class="annottext">X x
</span><a href="#local-6989586621680149037"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621680149036"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149036"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X x -&gt; O v -&gt; Constant v x
forall v x. X x -&gt; O v -&gt; Constant v x
</span><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier hs-var">Constant</span></a></span><span> </span><span class="annot"><span class="annottext">X x
</span><a href="#local-6989586621680149037"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; O v -&gt; O v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680149038"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680149036"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-356"></span><span id="local-6989586621680150341"><span id="local-6989586621680150342"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150342"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Locks"><span class="hs-identifier hs-type">Locks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150342"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150341"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150342"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680149031"><span class="annot"><span class="annottext">locks :: Constant v x -&gt; [Lock v]
</span><a href="#local-6989586621680149031"><span class="hs-identifier hs-var hs-var hs-var hs-var">locks</span></a></span></span><span> </span><span class="annot"><span class="annottext">Constant v x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-357"></span><span id="local-6989586621680150343"><span id="local-6989586621680150344"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#FunctionSimulation"><span class="hs-identifier hs-type">FunctionSimulation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150344"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150343"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150344"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150343"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-358"></span><span>    </span><span id="local-6989586621680149029"><span class="annot"><span class="annottext">simulate :: CycleCntx v x -&gt; Constant v x -&gt; [(v, x)]
</span><a href="#local-6989586621680149029"><span class="hs-identifier hs-var hs-var hs-var hs-var">simulate</span></a></span></span><span> </span><span id="local-6989586621680149028"><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680149028"><span class="hs-identifier hs-var">_cntx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span id="local-6989586621680149027"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149027"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span id="local-6989586621680149026"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149026"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149025"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680149027"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680149025"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680149025"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; [v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680149026"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-comment">-- TODO: separete into two different functions</span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-comment">-- | Functional unit that implements logic shift operations</span><span>
</span><span id="line-363"></span><span class="hs-keyword">data</span><span> </span><span id="ShiftLR"><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftLR"><span class="hs-identifier hs-var">ShiftLR</span></a></span></span><span> </span><span id="local-6989586621680150328"><span class="annot"><a href="#local-6989586621680150328"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680150327"><span class="annot"><a href="#local-6989586621680150327"><span class="hs-identifier hs-type">x</span></a></span></span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="ShiftL"><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftL"><span class="hs-identifier hs-var">ShiftL</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150328"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150328"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ShiftR"><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftR"><span class="hs-identifier hs-var">ShiftR</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150328"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150328"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680149012"><span id="local-6989586621680149021"><span class="annot"><span class="annottext">ShiftLR v x -&gt; ShiftLR v x -&gt; Bool
(ShiftLR v x -&gt; ShiftLR v x -&gt; Bool)
-&gt; (ShiftLR v x -&gt; ShiftLR v x -&gt; Bool) -&gt; Eq (ShiftLR v x)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v x. Eq v =&gt; ShiftLR v x -&gt; ShiftLR v x -&gt; Bool
/= :: ShiftLR v x -&gt; ShiftLR v x -&gt; Bool
$c/= :: forall v x. Eq v =&gt; ShiftLR v x -&gt; ShiftLR v x -&gt; Bool
== :: ShiftLR v x -&gt; ShiftLR v x -&gt; Bool
$c== :: forall v x. Eq v =&gt; ShiftLR v x -&gt; ShiftLR v x -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span id="local-6989586621680150325"><span id="local-6989586621680150326"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680149007"><span id="local-6989586621680149010"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150326"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftLR"><span class="hs-identifier hs-type">ShiftLR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150326"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150325"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-369"></span><span>    </span><span id="local-6989586621680148991"><span class="annot"><span class="annottext">show :: ShiftLR v x -&gt; String
</span><a href="#local-6989586621680148991"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftL"><span class="hs-identifier hs-type">ShiftL</span></a></span><span> </span><span id="local-6989586621680148990"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680148990"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680148989"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148989"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680148988"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148988"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148989"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &lt;&lt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680148990"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">O v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148988"><span class="hs-identifier hs-var">os</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftR"><span class="hs-identifier hs-type">ShiftR</span></a></span><span> </span><span id="local-6989586621680148987"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680148987"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680148986"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148986"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680148985"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148985"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148986"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &gt;&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680148987"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">O v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148985"><span class="hs-identifier hs-var">os</span></a></span></span></span><span>
</span><span id="line-371"></span><span id="local-6989586621680150321"><span id="local-6989586621680150322"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150322"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftLR"><span class="hs-identifier hs-type">ShiftLR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150322"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150321"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680148980"><span class="annot"><span class="annottext">label :: ShiftLR v x -&gt; String
</span><a href="#local-6989586621680148980"><span class="hs-keyword hs-var hs-var hs-var hs-var">label</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShiftLR v x -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span></span></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span id="local-6989586621680150319"><span id="local-6989586621680150320"><span class="annot"><a href="NITTA.Intermediate.Functions.html#shiftL"><span class="hs-identifier hs-type">shiftL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150320"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Value.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150319"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680150320"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680150320"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150320"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150319"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-374"></span><span id="shiftL"><span class="annot"><span class="annottext">shiftL :: forall v x. (Var v, Val x) =&gt; Int -&gt; v -&gt; [v] -&gt; F v x
</span><a href="NITTA.Intermediate.Functions.html#shiftL"><span class="hs-identifier hs-var hs-var">shiftL</span></a></span></span><span> </span><span id="local-6989586621680148957"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680148957"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680148956"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148956"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680148955"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680148955"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShiftLR v x -&gt; F v x
forall {f} {v} {x}.
(Function f v, Patch f (v, v), Locks f v, Show f, Label f,
 FunctionSimulation f v x, Typeable f, Eq f) =&gt;
f -&gt; F v x
</span><a href="NITTA.Intermediate.Types.html#packF"><span class="hs-identifier hs-var">packF</span></a></span><span> </span><span class="annot"><span class="annottext">(ShiftLR v x -&gt; F v x) -&gt; ShiftLR v x -&gt; F v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; I v -&gt; O v -&gt; ShiftLR v x
forall v x. Int -&gt; I v -&gt; O v -&gt; ShiftLR v x
</span><a href="NITTA.Intermediate.Functions.html#ShiftL"><span class="hs-identifier hs-var">ShiftL</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680148957"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; I v
forall v. v -&gt; I v
</span><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148956"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(O v -&gt; ShiftLR v x) -&gt; O v -&gt; ShiftLR v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set v -&gt; O v
forall v. Set v -&gt; O v
</span><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-var">O</span></a></span><span> </span><span class="annot"><span class="annottext">(Set v -&gt; O v) -&gt; Set v -&gt; O v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[v] -&gt; Set v
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680148955"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-375"></span><span id="local-6989586621680148953"><span id="local-6989586621680148954"><span class="annot"><a href="NITTA.Intermediate.Functions.html#shiftR"><span class="hs-identifier hs-type">shiftR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680148954"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Value.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680148953"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680148954"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680148954"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680148954"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680148953"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-376"></span><span id="shiftR"><span class="annot"><span class="annottext">shiftR :: forall v x. (Var v, Val x) =&gt; Int -&gt; v -&gt; [v] -&gt; F v x
</span><a href="NITTA.Intermediate.Functions.html#shiftR"><span class="hs-identifier hs-var hs-var">shiftR</span></a></span></span><span> </span><span id="local-6989586621680148934"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680148934"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680148933"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148933"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680148932"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680148932"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShiftLR v x -&gt; F v x
forall {f} {v} {x}.
(Function f v, Patch f (v, v), Locks f v, Show f, Label f,
 FunctionSimulation f v x, Typeable f, Eq f) =&gt;
f -&gt; F v x
</span><a href="NITTA.Intermediate.Types.html#packF"><span class="hs-identifier hs-var">packF</span></a></span><span> </span><span class="annot"><span class="annottext">(ShiftLR v x -&gt; F v x) -&gt; ShiftLR v x -&gt; F v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; I v -&gt; O v -&gt; ShiftLR v x
forall v x. Int -&gt; I v -&gt; O v -&gt; ShiftLR v x
</span><a href="NITTA.Intermediate.Functions.html#ShiftR"><span class="hs-identifier hs-var">ShiftR</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680148934"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; I v
forall v. v -&gt; I v
</span><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148933"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(O v -&gt; ShiftLR v x) -&gt; O v -&gt; ShiftLR v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set v -&gt; O v
forall v. Set v -&gt; O v
</span><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-var">O</span></a></span><span> </span><span class="annot"><span class="annottext">(Set v -&gt; O v) -&gt; Set v -&gt; O v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[v] -&gt; Set v
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680148932"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span id="local-6989586621680150308"><span id="local-6989586621680150309"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680148928"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150309"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftLR"><span class="hs-identifier hs-type">ShiftLR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150309"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150308"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150309"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-379"></span><span>    </span><span id="local-6989586621680148925"><span class="annot"><span class="annottext">inputs :: ShiftLR v x -&gt; Set v
</span><a href="#local-6989586621680148925"><span class="hs-identifier hs-var hs-var hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftL"><span class="hs-identifier hs-type">ShiftL</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680148924"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148924"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">O v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148924"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-380"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Types.html#inputs"><span class="hs-identifier hs-var">inputs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftR"><span class="hs-identifier hs-type">ShiftR</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680148923"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148923"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">O v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148923"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-381"></span><span>    </span><span id="local-6989586621680148920"><span class="annot"><span class="annottext">outputs :: ShiftLR v x -&gt; Set v
</span><a href="#local-6989586621680148920"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftL"><span class="hs-identifier hs-type">ShiftL</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680148919"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148919"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148919"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-382"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Types.html#outputs"><span class="hs-identifier hs-var">outputs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftR"><span class="hs-identifier hs-type">ShiftR</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680148918"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148918"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148918"><span class="hs-identifier hs-var">o</span></a></span></span></span><span>
</span><span id="line-383"></span><span id="local-6989586621680150310"><span id="local-6989586621680150311"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150311"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Patch"><span class="hs-identifier hs-type">Patch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftLR"><span class="hs-identifier hs-type">ShiftLR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150311"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150310"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680150311"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680150311"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-384"></span><span>    </span><span id="local-6989586621680148909"><span class="annot"><span class="annottext">patch :: (v, v) -&gt; ShiftLR v x -&gt; ShiftLR v x
</span><a href="#local-6989586621680148909"><span class="hs-identifier hs-var hs-var hs-var hs-var">patch</span></a></span></span><span> </span><span id="local-6989586621680148908"><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680148908"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftL"><span class="hs-identifier hs-type">ShiftL</span></a></span><span> </span><span id="local-6989586621680148907"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680148907"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680148906"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148906"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680148905"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148905"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; I v -&gt; O v -&gt; ShiftLR v x
forall v x. Int -&gt; I v -&gt; O v -&gt; ShiftLR v x
</span><a href="NITTA.Intermediate.Functions.html#ShiftL"><span class="hs-identifier hs-var">ShiftL</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680148907"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; I v -&gt; I v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680148908"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148906"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; O v -&gt; O v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680148908"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148905"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span id="local-6989586621680148904"><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680148904"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftR"><span class="hs-identifier hs-type">ShiftR</span></a></span><span> </span><span id="local-6989586621680148903"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680148903"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680148902"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148902"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680148901"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148901"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; I v -&gt; O v -&gt; ShiftLR v x
forall v x. Int -&gt; I v -&gt; O v -&gt; ShiftLR v x
</span><a href="NITTA.Intermediate.Functions.html#ShiftR"><span class="hs-identifier hs-var">ShiftR</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680148903"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; I v -&gt; I v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680148904"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148902"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; O v -&gt; O v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680148904"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148901"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-386"></span><span id="local-6989586621680150312"><span id="local-6989586621680150313"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150313"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Locks"><span class="hs-identifier hs-type">Locks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftLR"><span class="hs-identifier hs-type">ShiftLR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150313"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150312"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150313"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-387"></span><span>    </span><span id="local-6989586621680148895"><span class="annot"><span class="annottext">locks :: ShiftLR v x -&gt; [Lock v]
</span><a href="#local-6989586621680148895"><span class="hs-identifier hs-var hs-var hs-var hs-var">locks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShiftLR v x -&gt; [Lock v]
forall {f} {v}. Function f v =&gt; f -&gt; [Lock v]
</span><a href="NITTA.Intermediate.Types.html#inputsLockOutputs"><span class="hs-identifier hs-var">inputsLockOutputs</span></a></span></span></span><span>
</span><span id="line-388"></span><span id="local-6989586621680150314"><span id="local-6989586621680150315"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150315"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621680150314"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#FunctionSimulation"><span class="hs-identifier hs-type">FunctionSimulation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftLR"><span class="hs-identifier hs-type">ShiftLR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150315"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150314"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150315"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150314"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-389"></span><span>    </span><span id="local-6989586621680148879"><span class="annot"><span class="annottext">simulate :: CycleCntx v x -&gt; ShiftLR v x -&gt; [(v, x)]
</span><a href="#local-6989586621680148879"><span class="hs-identifier hs-var hs-var hs-var hs-var">simulate</span></a></span></span><span> </span><span id="local-6989586621680148878"><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680148878"><span class="hs-identifier hs-var">cntx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftL"><span class="hs-identifier hs-type">ShiftL</span></a></span><span> </span><span id="local-6989586621680148877"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680148877"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621680148876"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148876"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span id="local-6989586621680148875"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680148875"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-390"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148874"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CycleCntx v x -&gt; v -&gt; x
forall {a} {v}.
(Eq a, Hashable a, ToString a) =&gt;
CycleCntx a v -&gt; a -&gt; v
</span><a href="NITTA.Intermediate.Types.html#getCntx"><span class="hs-identifier hs-var">getCntx</span></a></span><span> </span><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680148878"><span class="hs-identifier hs-var">cntx</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148876"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; Int -&gt; x
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`B.shiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680148877"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680148874"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148874"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; [v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680148875"><span class="hs-identifier hs-var">os</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><a href="NITTA.Intermediate.Types.html#simulate"><span class="hs-identifier hs-var">simulate</span></a></span><span> </span><span id="local-6989586621680148872"><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680148872"><span class="hs-identifier hs-var">cntx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#ShiftR"><span class="hs-identifier hs-type">ShiftR</span></a></span><span> </span><span id="local-6989586621680148871"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680148871"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621680148870"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148870"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span id="local-6989586621680148869"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680148869"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-392"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148868"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CycleCntx v x -&gt; v -&gt; x
forall {a} {v}.
(Eq a, Hashable a, ToString a) =&gt;
CycleCntx a v -&gt; a -&gt; v
</span><a href="NITTA.Intermediate.Types.html#getCntx"><span class="hs-identifier hs-var">getCntx</span></a></span><span> </span><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680148872"><span class="hs-identifier hs-var">cntx</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148870"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; Int -&gt; x
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`B.shiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680148871"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680148868"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148868"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; [v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680148869"><span class="hs-identifier hs-var">os</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="hs-keyword">newtype</span><span> </span><span id="Send"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Send"><span class="hs-identifier hs-var">Send</span></a></span></span><span> </span><span id="local-6989586621680150296"><span class="annot"><a href="#local-6989586621680150296"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680150295"><span class="annot"><a href="#local-6989586621680150295"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Send"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Send"><span class="hs-identifier hs-var">Send</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150296"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680148859"><span id="local-6989586621680148863"><span class="annot"><span class="annottext">Send v x -&gt; Send v x -&gt; Bool
(Send v x -&gt; Send v x -&gt; Bool)
-&gt; (Send v x -&gt; Send v x -&gt; Bool) -&gt; Eq (Send v x)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v x. Eq v =&gt; Send v x -&gt; Send v x -&gt; Bool
/= :: Send v x -&gt; Send v x -&gt; Bool
$c/= :: forall v x. Eq v =&gt; Send v x -&gt; Send v x -&gt; Bool
== :: Send v x -&gt; Send v x -&gt; Bool
$c== :: forall v x. Eq v =&gt; Send v x -&gt; Send v x -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span id="local-6989586621680150293"><span id="local-6989586621680150294"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680148851"><span id="local-6989586621680148854"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150294"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Send"><span class="hs-identifier hs-type">Send</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150294"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150293"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-396"></span><span>    </span><span id="local-6989586621680148847"><span class="annot"><span class="annottext">show :: Send v x -&gt; String
</span><a href="#local-6989586621680148847"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Send"><span class="hs-identifier hs-type">Send</span></a></span><span> </span><span id="local-6989586621680148846"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148846"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;send(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148846"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span></span></span><span>
</span><span id="line-397"></span><span id="local-6989586621680150289"><span id="local-6989586621680150290"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Send"><span class="hs-identifier hs-type">Send</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150290"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150289"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680148843"><span class="annot"><span class="annottext">label :: Send v x -&gt; String
</span><a href="#local-6989586621680148843"><span class="hs-keyword hs-var hs-var hs-var hs-var">label</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Send"><span class="hs-identifier hs-type">Send</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;send&quot;</span></span></span></span><span>
</span><span id="line-398"></span><span id="local-6989586621680150287"><span id="local-6989586621680150288"><span class="annot"><a href="NITTA.Intermediate.Functions.html#send"><span class="hs-identifier hs-type">send</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150288"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Value.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150287"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680150288"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150288"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150287"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-399"></span><span id="send"><span class="annot"><span class="annottext">send :: forall v x. (Var v, Val x) =&gt; v -&gt; F v x
</span><a href="NITTA.Intermediate.Functions.html#send"><span class="hs-identifier hs-var hs-var">send</span></a></span></span><span> </span><span id="local-6989586621680148823"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148823"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Send v x -&gt; F v x
forall {f} {v} {x}.
(Function f v, Patch f (v, v), Locks f v, Show f, Label f,
 FunctionSimulation f v x, Typeable f, Eq f) =&gt;
f -&gt; F v x
</span><a href="NITTA.Intermediate.Types.html#packF"><span class="hs-identifier hs-var">packF</span></a></span><span> </span><span class="annot"><span class="annottext">(Send v x -&gt; F v x) -&gt; Send v x -&gt; F v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; Send v x
forall v x. I v -&gt; Send v x
</span><a href="NITTA.Intermediate.Functions.html#Send"><span class="hs-identifier hs-var">Send</span></a></span><span> </span><span class="annot"><span class="annottext">(I v -&gt; Send v x) -&gt; I v -&gt; Send v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; I v
forall v. v -&gt; I v
</span><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148823"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-400"></span><span id="local-6989586621680150277"><span id="local-6989586621680150278"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680148818"><span id="local-6989586621680148820"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150278"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Send"><span class="hs-identifier hs-type">Send</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150278"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150277"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150278"><span class="hs-identifier hs-type">v</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-401"></span><span>    </span><span id="local-6989586621680148816"><span class="annot"><span class="annottext">inputs :: Send v x -&gt; Set v
</span><a href="#local-6989586621680148816"><span class="hs-identifier hs-var hs-var hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Send"><span class="hs-identifier hs-type">Send</span></a></span><span> </span><span id="local-6989586621680148815"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148815"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148815"><span class="hs-identifier hs-var">i</span></a></span></span></span><span>
</span><span id="line-402"></span><span id="local-6989586621680150279"><span id="local-6989586621680150280"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150280"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Patch"><span class="hs-identifier hs-type">Patch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Send"><span class="hs-identifier hs-type">Send</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150280"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150279"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680150280"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680150280"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-403"></span><span>    </span><span id="local-6989586621680148809"><span class="annot"><span class="annottext">patch :: (v, v) -&gt; Send v x -&gt; Send v x
</span><a href="#local-6989586621680148809"><span class="hs-identifier hs-var hs-var hs-var hs-var">patch</span></a></span></span><span> </span><span id="local-6989586621680148808"><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680148808"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Send"><span class="hs-identifier hs-type">Send</span></a></span><span> </span><span id="local-6989586621680148807"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148807"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; Send v x
forall v x. I v -&gt; Send v x
</span><a href="NITTA.Intermediate.Functions.html#Send"><span class="hs-identifier hs-var">Send</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; I v -&gt; I v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680148808"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148807"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-404"></span><span id="local-6989586621680150281"><span id="local-6989586621680150282"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150282"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Locks"><span class="hs-identifier hs-type">Locks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Send"><span class="hs-identifier hs-type">Send</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150282"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150281"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150282"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680148802"><span class="annot"><span class="annottext">locks :: Send v x -&gt; [Lock v]
</span><a href="#local-6989586621680148802"><span class="hs-identifier hs-var hs-var hs-var hs-var">locks</span></a></span></span><span> </span><span class="annot"><span class="annottext">Send v x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-405"></span><span id="local-6989586621680150283"><span id="local-6989586621680150284"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#FunctionSimulation"><span class="hs-identifier hs-type">FunctionSimulation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Send"><span class="hs-identifier hs-type">Send</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150284"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150283"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150284"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150283"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-406"></span><span>    </span><span id="local-6989586621680148800"><span class="annot"><span class="annottext">simulate :: CycleCntx v x -&gt; Send v x -&gt; [(v, x)]
</span><a href="#local-6989586621680148800"><span class="hs-identifier hs-var hs-var hs-var hs-var">simulate</span></a></span></span><span> </span><span id="local-6989586621680148799"><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680148799"><span class="hs-identifier hs-var">_cntx</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Send"><span class="hs-identifier hs-type">Send</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-keyword">newtype</span><span> </span><span id="Receive"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Receive"><span class="hs-identifier hs-var">Receive</span></a></span></span><span> </span><span id="local-6989586621680150268"><span class="annot"><a href="#local-6989586621680150268"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680150267"><span class="annot"><a href="#local-6989586621680150267"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Receive"><span class="annot"><a href="NITTA.Intermediate.Functions.html#Receive"><span class="hs-identifier hs-var">Receive</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150268"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680148791"><span id="local-6989586621680148795"><span class="annot"><span class="annottext">Receive v x -&gt; Receive v x -&gt; Bool
(Receive v x -&gt; Receive v x -&gt; Bool)
-&gt; (Receive v x -&gt; Receive v x -&gt; Bool) -&gt; Eq (Receive v x)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v x. Eq v =&gt; Receive v x -&gt; Receive v x -&gt; Bool
/= :: Receive v x -&gt; Receive v x -&gt; Bool
$c/= :: forall v x. Eq v =&gt; Receive v x -&gt; Receive v x -&gt; Bool
== :: Receive v x -&gt; Receive v x -&gt; Bool
$c== :: forall v x. Eq v =&gt; Receive v x -&gt; Receive v x -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span id="local-6989586621680150265"><span id="local-6989586621680150266"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680148783"><span id="local-6989586621680148786"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150266"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Receive"><span class="hs-identifier hs-type">Receive</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150266"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150265"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-410"></span><span>    </span><span id="local-6989586621680148780"><span class="annot"><span class="annottext">show :: Receive v x -&gt; String
</span><a href="#local-6989586621680148780"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Receive"><span class="hs-identifier hs-type">Receive</span></a></span><span> </span><span id="local-6989586621680148779"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148779"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;receive() = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">O v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148779"><span class="hs-identifier hs-var">os</span></a></span></span></span><span>
</span><span id="line-411"></span><span id="local-6989586621680150261"><span id="local-6989586621680150262"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Receive"><span class="hs-identifier hs-type">Receive</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150262"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150261"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680148776"><span class="annot"><span class="annottext">label :: Receive v x -&gt; String
</span><a href="#local-6989586621680148776"><span class="hs-keyword hs-var hs-var hs-var hs-var">label</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Receive"><span class="hs-identifier hs-type">Receive</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;receive&quot;</span></span></span></span><span>
</span><span id="line-412"></span><span id="local-6989586621680150259"><span id="local-6989586621680150260"><span class="annot"><a href="NITTA.Intermediate.Functions.html#receive"><span class="hs-identifier hs-type">receive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150260"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Value.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150259"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680150260"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150260"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150259"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-413"></span><span id="receive"><span class="annot"><span class="annottext">receive :: forall v x. (Var v, Val x) =&gt; [v] -&gt; F v x
</span><a href="NITTA.Intermediate.Functions.html#receive"><span class="hs-identifier hs-var hs-var">receive</span></a></span></span><span> </span><span id="local-6989586621680148755"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680148755"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Receive v x -&gt; F v x
forall {f} {v} {x}.
(Function f v, Patch f (v, v), Locks f v, Show f, Label f,
 FunctionSimulation f v x, Typeable f, Eq f) =&gt;
f -&gt; F v x
</span><a href="NITTA.Intermediate.Types.html#packF"><span class="hs-identifier hs-var">packF</span></a></span><span> </span><span class="annot"><span class="annottext">(Receive v x -&gt; F v x) -&gt; Receive v x -&gt; F v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">O v -&gt; Receive v x
forall v x. O v -&gt; Receive v x
</span><a href="NITTA.Intermediate.Functions.html#Receive"><span class="hs-identifier hs-var">Receive</span></a></span><span> </span><span class="annot"><span class="annottext">(O v -&gt; Receive v x) -&gt; O v -&gt; Receive v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set v -&gt; O v
forall v. Set v -&gt; O v
</span><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-var">O</span></a></span><span> </span><span class="annot"><span class="annottext">(Set v -&gt; O v) -&gt; Set v -&gt; O v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[v] -&gt; Set v
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680148755"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-414"></span><span id="local-6989586621680150249"><span id="local-6989586621680150250"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680148750"><span id="local-6989586621680148753"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150250"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Receive"><span class="hs-identifier hs-type">Receive</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150250"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150249"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150250"><span class="hs-identifier hs-type">v</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-415"></span><span>    </span><span id="local-6989586621680148748"><span class="annot"><span class="annottext">outputs :: Receive v x -&gt; Set v
</span><a href="#local-6989586621680148748"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Receive"><span class="hs-identifier hs-type">Receive</span></a></span><span> </span><span id="local-6989586621680148747"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148747"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148747"><span class="hs-identifier hs-var">o</span></a></span></span></span><span>
</span><span id="line-416"></span><span id="local-6989586621680150251"><span id="local-6989586621680150252"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150252"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Patch"><span class="hs-identifier hs-type">Patch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Receive"><span class="hs-identifier hs-type">Receive</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150252"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150251"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680150252"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680150252"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-417"></span><span>    </span><span id="local-6989586621680148742"><span class="annot"><span class="annottext">patch :: (v, v) -&gt; Receive v x -&gt; Receive v x
</span><a href="#local-6989586621680148742"><span class="hs-identifier hs-var hs-var hs-var hs-var">patch</span></a></span></span><span> </span><span id="local-6989586621680148741"><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680148741"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Receive"><span class="hs-identifier hs-type">Receive</span></a></span><span> </span><span id="local-6989586621680148740"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148740"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O v -&gt; Receive v x
forall v x. O v -&gt; Receive v x
</span><a href="NITTA.Intermediate.Functions.html#Receive"><span class="hs-identifier hs-var">Receive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; O v -&gt; O v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680148741"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148740"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-418"></span><span id="local-6989586621680150253"><span id="local-6989586621680150254"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150254"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Locks"><span class="hs-identifier hs-type">Locks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Receive"><span class="hs-identifier hs-type">Receive</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150254"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150253"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150254"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680148735"><span class="annot"><span class="annottext">locks :: Receive v x -&gt; [Lock v]
</span><a href="#local-6989586621680148735"><span class="hs-identifier hs-var hs-var hs-var hs-var">locks</span></a></span></span><span> </span><span class="annot"><span class="annottext">Receive v x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-419"></span><span id="local-6989586621680150255"><span id="local-6989586621680150256"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150256"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Value.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150255"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#FunctionSimulation"><span class="hs-identifier hs-type">FunctionSimulation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Receive"><span class="hs-identifier hs-type">Receive</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150256"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150255"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150256"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150255"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-420"></span><span>    </span><span id="local-6989586621680148723"><span class="annot"><span class="annottext">simulate :: CycleCntx v x -&gt; Receive v x -&gt; [(v, x)]
</span><a href="#local-6989586621680148723"><span class="hs-identifier hs-var hs-var hs-var hs-var">simulate</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#CycleCntx"><span class="hs-identifier hs-type">CycleCntx</span></a></span><span class="hs-special">{</span><span id="local-6989586621680148722"><span class="annot"><span class="annottext">HashMap v x
cycleCntx :: HashMap v x
cycleCntx :: forall v x. CycleCntx v x -&gt; HashMap v x
</span><a href="#local-6989586621680148722"><span class="hs-identifier hs-var hs-var">cycleCntx</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#Receive"><span class="hs-identifier hs-type">Receive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span id="local-6989586621680148721"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680148721"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-421"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; v
forall {c}. Set c -&gt; c
</span><a href="NITTA.Utils.Base.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680148721"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; HashMap v x -&gt; Maybe x
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-operator hs-var">`HM.lookup`</span></span><span> </span><span class="annot"><span class="annottext">HashMap v x
</span><a href="#local-6989586621680148722"><span class="hs-identifier hs-var">cycleCntx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-422"></span><span>            </span><span class="hs-comment">-- if output variables are defined - nothing to do (values thrown on upper level)</span><span>
</span><span id="line-423"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-424"></span><span>            </span><span class="hs-comment">-- if output variables are not defined - set initial value</span><span>
</span><span id="line-425"></span><span>            </span><span class="annot"><span class="annottext">Maybe x
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148720"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">x
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680148720"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148720"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; [v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680148721"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="hs-comment">-- | Special function for negative tests only.</span><span>
</span><span id="line-428"></span><span class="hs-keyword">data</span><span> </span><span id="BrokenBuffer"><span class="annot"><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier hs-var">BrokenBuffer</span></a></span></span><span> </span><span id="local-6989586621680150240"><span class="annot"><a href="#local-6989586621680150240"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680150239"><span class="annot"><a href="#local-6989586621680150239"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BrokenBuffer"><span class="annot"><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier hs-var">BrokenBuffer</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150240"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150240"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680148712"><span id="local-6989586621680148716"><span class="annot"><span class="annottext">BrokenBuffer v x -&gt; BrokenBuffer v x -&gt; Bool
(BrokenBuffer v x -&gt; BrokenBuffer v x -&gt; Bool)
-&gt; (BrokenBuffer v x -&gt; BrokenBuffer v x -&gt; Bool)
-&gt; Eq (BrokenBuffer v x)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v x. Eq v =&gt; BrokenBuffer v x -&gt; BrokenBuffer v x -&gt; Bool
/= :: BrokenBuffer v x -&gt; BrokenBuffer v x -&gt; Bool
$c/= :: forall v x. Eq v =&gt; BrokenBuffer v x -&gt; BrokenBuffer v x -&gt; Bool
== :: BrokenBuffer v x -&gt; BrokenBuffer v x -&gt; Bool
$c== :: forall v x. Eq v =&gt; BrokenBuffer v x -&gt; BrokenBuffer v x -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span id="local-6989586621680150235"><span id="local-6989586621680150236"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier hs-type">BrokenBuffer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150236"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150235"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680148709"><span class="annot"><span class="annottext">label :: BrokenBuffer v x -&gt; String
</span><a href="#local-6989586621680148709"><span class="hs-keyword hs-var hs-var hs-var hs-var">label</span></a></span></span><span> </span><span class="annot"><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier hs-type">BrokenBuffer</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;broken&quot;</span></span></span></span><span>
</span><span id="line-431"></span><span id="local-6989586621680150233"><span id="local-6989586621680150234"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680148704"><span id="local-6989586621680148707"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150234"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier hs-type">BrokenBuffer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150234"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150233"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-432"></span><span>    </span><span id="local-6989586621680148697"><span class="annot"><span class="annottext">show :: BrokenBuffer v x -&gt; String
</span><a href="#local-6989586621680148697"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier hs-type">BrokenBuffer</span></a></span><span> </span><span id="local-6989586621680148696"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148696"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680148695"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148695"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;brokenBuffer(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148696"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">O v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148695"><span class="hs-identifier hs-var">os</span></a></span></span></span><span>
</span><span id="line-433"></span><span id="local-6989586621680148693"><span id="local-6989586621680148694"><span class="annot"><a href="NITTA.Intermediate.Functions.html#brokenBuffer"><span class="hs-identifier hs-type">brokenBuffer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680148694"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Value.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680148693"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680148694"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680148694"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680148694"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680148693"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-434"></span><span id="brokenBuffer"><span class="annot"><span class="annottext">brokenBuffer :: forall v x. (Var v, Val x) =&gt; v -&gt; [v] -&gt; F v x
</span><a href="NITTA.Intermediate.Functions.html#brokenBuffer"><span class="hs-identifier hs-var hs-var">brokenBuffer</span></a></span></span><span> </span><span id="local-6989586621680148672"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148672"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680148671"><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680148671"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BrokenBuffer v x -&gt; F v x
forall {f} {v} {x}.
(Function f v, Patch f (v, v), Locks f v, Show f, Label f,
 FunctionSimulation f v x, Typeable f, Eq f) =&gt;
f -&gt; F v x
</span><a href="NITTA.Intermediate.Types.html#packF"><span class="hs-identifier hs-var">packF</span></a></span><span> </span><span class="annot"><span class="annottext">(BrokenBuffer v x -&gt; F v x) -&gt; BrokenBuffer v x -&gt; F v x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">I v -&gt; O v -&gt; BrokenBuffer v x
forall v x. I v -&gt; O v -&gt; BrokenBuffer v x
</span><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier hs-var">BrokenBuffer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; I v
forall v. v -&gt; I v
</span><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148672"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set v -&gt; O v
forall v. Set v -&gt; O v
</span><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-var">O</span></a></span><span> </span><span class="annot"><span class="annottext">(Set v -&gt; O v) -&gt; Set v -&gt; O v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[v] -&gt; Set v
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">[v]
</span><a href="#local-6989586621680148671"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span id="local-6989586621680150223"><span id="local-6989586621680150224"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680148667"><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150224"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier hs-type">BrokenBuffer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150224"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150223"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150224"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-437"></span><span>    </span><span id="local-6989586621680148665"><span class="annot"><span class="annottext">inputs :: BrokenBuffer v x -&gt; Set v
</span><a href="#local-6989586621680148665"><span class="hs-identifier hs-var hs-var hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier hs-type">BrokenBuffer</span></a></span><span> </span><span id="local-6989586621680148664"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148664"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680148663"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148663"><span class="hs-identifier hs-var">_b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148664"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-438"></span><span>    </span><span id="local-6989586621680148661"><span class="annot"><span class="annottext">outputs :: BrokenBuffer v x -&gt; Set v
</span><a href="#local-6989586621680148661"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier hs-type">BrokenBuffer</span></a></span><span> </span><span id="local-6989586621680148660"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148660"><span class="hs-identifier hs-var">_a</span></a></span></span><span> </span><span id="local-6989586621680148659"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148659"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">O v -&gt; Set v
forall a v. Variables a v =&gt; a -&gt; Set v
</span><a href="NITTA.Intermediate.Variable.html#variables"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148659"><span class="hs-identifier hs-var">b</span></a></span></span></span><span>
</span><span id="line-439"></span><span id="local-6989586621680150225"><span id="local-6989586621680150226"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150226"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Patch"><span class="hs-identifier hs-type">Patch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier hs-type">BrokenBuffer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150226"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150225"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680150226"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680150226"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-440"></span><span>    </span><span id="local-6989586621680148652"><span class="annot"><span class="annottext">patch :: (v, v) -&gt; BrokenBuffer v x -&gt; BrokenBuffer v x
</span><a href="#local-6989586621680148652"><span class="hs-identifier hs-var hs-var hs-var hs-var">patch</span></a></span></span><span> </span><span id="local-6989586621680148651"><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680148651"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier hs-type">BrokenBuffer</span></a></span><span> </span><span id="local-6989586621680148650"><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148650"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680148649"><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148649"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">I v -&gt; O v -&gt; BrokenBuffer v x
forall v x. I v -&gt; O v -&gt; BrokenBuffer v x
</span><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier hs-var">BrokenBuffer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; I v -&gt; I v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680148651"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">I v
</span><a href="#local-6989586621680148650"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v, v) -&gt; O v -&gt; O v
forall f diff. Patch f diff =&gt; diff -&gt; f -&gt; f
</span><a href="NITTA.Intermediate.Types.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">(v, v)
</span><a href="#local-6989586621680148651"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">O v
</span><a href="#local-6989586621680148649"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-441"></span><span id="local-6989586621680150227"><span id="local-6989586621680150228"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150228"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#Locks"><span class="hs-identifier hs-type">Locks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier hs-type">BrokenBuffer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150228"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150227"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150228"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-442"></span><span>    </span><span id="local-6989586621680148643"><span class="annot"><span class="annottext">locks :: BrokenBuffer v x -&gt; [Lock v]
</span><a href="#local-6989586621680148643"><span class="hs-identifier hs-var hs-var hs-var hs-var">locks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BrokenBuffer v x -&gt; [Lock v]
forall {f} {v}. Function f v =&gt; f -&gt; [Lock v]
</span><a href="NITTA.Intermediate.Types.html#inputsLockOutputs"><span class="hs-identifier hs-var">inputsLockOutputs</span></a></span></span></span><span>
</span><span id="line-443"></span><span id="local-6989586621680150229"><span id="local-6989586621680150230"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Variable.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150230"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="NITTA.Intermediate.Types.html#FunctionSimulation"><span class="hs-identifier hs-type">FunctionSimulation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier hs-type">BrokenBuffer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150230"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150229"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680150230"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680150229"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-444"></span><span>    </span><span id="local-6989586621680148633"><span class="annot"><span class="annottext">simulate :: CycleCntx v x -&gt; BrokenBuffer v x -&gt; [(v, x)]
</span><a href="#local-6989586621680148633"><span class="hs-identifier hs-var hs-var hs-var hs-var">simulate</span></a></span></span><span> </span><span id="local-6989586621680148632"><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680148632"><span class="hs-identifier hs-var">cntx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Functions.html#BrokenBuffer"><span class="hs-identifier hs-type">BrokenBuffer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621680148631"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148631"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="NITTA.Intermediate.Types.html#O"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span id="local-6989586621680148630"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680148630"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148629"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CycleCntx v x
</span><a href="#local-6989586621680148632"><span class="hs-identifier hs-var">cntx</span></a></span><span> </span><span class="annot"><span class="annottext">CycleCntx v x -&gt; v -&gt; x
forall {a} {v}.
(Eq a, Hashable a, ToString a) =&gt;
CycleCntx a v -&gt; a -&gt; v
</span><a href="NITTA.Intermediate.Types.html#getCntx"><span class="hs-operator hs-var">`getCntx`</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148631"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680148629"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680148629"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set v -&gt; [v]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621680148630"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-445"></span></pre></body></html>